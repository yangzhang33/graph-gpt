In Base24 setting!
--data_dir='./data/OGB' --output_dir='./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1' --pretrain_cpt='' --dataset_name='PCQM4Mv2' --task_type='pretrain-mlm' --tokenizer_class='StackedGSTTokenizer' --tokenization_config='./examples/graph_lvl/pcqm4m-v2_tokenization_config.json' --stack_method='short' --batch_size=1024 --pack_tokens=0 --num_workers=12 --max_position_embeddings=1024 --tie_word_embeddings=0 --lr=3e-4 --weight_decay=0.1 --eps=1e-8 --max_grad_norm=5 --total_tokens=4e9 --warmup_tokens=1e8 --model_config='' --num_hidden_layers=24 --hidden_size=768 --intermediate_size=0 --num_attention_heads=0 --hidden_act='gelu' --stacked_feat_agg_method=gated --samples_per_saving=1000000 --deepspeed_config='./examples/ds_config2_pt.json' --attention_dropout=0.1 --embed_dropout=0 --path_dropout=0 --mlp_dropout=0 --layer_scale_init_value=0 --use_ema=0
[2024-11-14 15:02:10,764] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:02:11,732] [WARNING] [runner.py:212:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-11-14 15:02:11,732] [INFO] [runner.py:585:main] cmd = /home/yang/miniconda3/envs/gpt/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None ./examples/train_pretrain.py --data_dir='./data/OGB' --output_dir='./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1' --pretrain_cpt='' --dataset_name='PCQM4Mv2' --task_type='pretrain-mlm' --tokenizer_class='StackedGSTTokenizer' --tokenization_config='./examples/graph_lvl/pcqm4m-v2_tokenization_config.json' --stack_method='short' --batch_size=1024 --pack_tokens=0 --num_workers=12 --max_position_embeddings=1024 --tie_word_embeddings=0 --lr=3e-4 --weight_decay=0.1 --eps=1e-8 --max_grad_norm=5 --total_tokens=4e9 --warmup_tokens=1e8 --model_config='' --num_hidden_layers=24 --hidden_size=768 --intermediate_size=0 --num_attention_heads=0 --hidden_act='gelu' --stacked_feat_agg_method=gated --samples_per_saving=1000000 --deepspeed_config='./examples/ds_config2_pt.json' --attention_dropout=0.1 --embed_dropout=0 --path_dropout=0 --mlp_dropout=0 --layer_scale_init_value=0 --use_ema=0
[2024-11-14 15:02:13,038] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:02:14,038] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2024-11-14 15:02:14,038] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2024-11-14 15:02:14,038] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2024-11-14 15:02:14,038] [INFO] [launch.py:164:main] dist_world_size=1
[2024-11-14 15:02:14,038] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2024-11-14 15:02:14,047] [INFO] [launch.py:256:main] process 12226 spawned with command: ['/home/yang/miniconda3/envs/gpt/bin/python', '-u', './examples/train_pretrain.py', '--local_rank=0', "--data_dir='./data/OGB'", "--output_dir='./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1'", "--pretrain_cpt=''", "--dataset_name='PCQM4Mv2'", "--task_type='pretrain-mlm'", "--tokenizer_class='StackedGSTTokenizer'", "--tokenization_config='./examples/graph_lvl/pcqm4m-v2_tokenization_config.json'", "--stack_method='short'", '--batch_size=1024', '--pack_tokens=0', '--num_workers=12', '--max_position_embeddings=1024', '--tie_word_embeddings=0', '--lr=3e-4', '--weight_decay=0.1', '--eps=1e-8', '--max_grad_norm=5', '--total_tokens=4e9', '--warmup_tokens=1e8', "--model_config=''", '--num_hidden_layers=24', '--hidden_size=768', '--intermediate_size=0', '--num_attention_heads=0', "--hidden_act='gelu'", '--stacked_feat_agg_method=gated', '--samples_per_saving=1000000', "--deepspeed_config='./examples/ds_config2_pt.json'", '--attention_dropout=0.1', '--embed_dropout=0', '--path_dropout=0', '--mlp_dropout=0', '--layer_scale_init_value=0', '--use_ema=0']
[2024-11-14 15:02:15,340] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)

world size: 1, rank: 0, local rank: 0
seed random with 1171634136409952035

steps_per_saving: 976
Training Graph-GPT model with params:
output_dir: ./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1
raw_pretrain_cpt: None
pretrain_cpt: 
data_dir: ./data/OGB
dataset_name: PCQM4Mv2
odps_table: 
with_prob: 0
tokenization_config: ./examples/graph_lvl/pcqm4m-v2_tokenization_config.json
deepspeed_config: ./examples/ds_config2_pt.json
optimization_config: 
world_size: 1
attr_assignment: first
attr_shuffle: 
attr_mask_ratio: 
ignored_off: 
add_eos: False
total_tokens: 4000000000.0
warmup_tokens: 100000000.0
epochs: None
warmup_epochs: None
batch_size: 1024
pad_to_multiple_of: 8
pack_tokens: 0
lr: 0.0003
min_lr: 2.9999999999999997e-05
betas: (0.9, 0.95)
eps: 1e-08
weight_decay: 0.1
max_grad_norm: 5
logging_steps: 100
freeze: 0
samples_per_eval: None
eval_steps: None
k_samplers: None
use_deepspeed: True
gradient_accumulation_steps: 1
model_type: graphgpt
model_config: 
vocab_size: None
hidden_size: 768
intermediate_size: 3072
num_attention_heads: 12
num_hidden_layers: 24
hidden_act: gelu
max_position_embeddings: 1024
initializer_range: 0.02
tie_word_embeddings: 0
add_cls_token: False
problem_type: None
causal_attention: 0
loss_type: None
ntp_ratio: None
task_ratio: None
uni_loss_ratio: None
bi_loss_ratio: None
num_labels: None
mlp: None
dropout: 0
task_level: None
pretrain_wgt: None
tables: 
outputs: 
samples_per_saving: 1000000
steps_per_saving: 976
do_valid: None
do_test: None
eval_only: None
seed: None
gpu: NVIDIA GeForce RTX 4090

{'attr_world_identifier': 'molecule',
 'data_dir': './data/OGB',
 'dataset': 'PCQM4Mv2',
 'ensemble_datasets': [],
 'label_tokens_to_pad': ['<icl>'],
 'name_or_path': './data/OGB/pcqm4m-v2',
 'pretrain_mlm': {'info': 'name->polynomial|cosine|fixed,power->3/2/1/0.5',
                  'name': 'polynomial',
                  'params': {'fixed_ratio': 0.7,
                             'mtp': [0.8, 0, 0.2],
                             'power': 1}},
 'sampling': None,
 'semantics': {'attr_assignment': 'first',
               'attr_shuffle': False,
               'common': {'numbers': ['<e>',
                                      '<.>',
                                      '<->',
                                      '<0>',
                                      '<1>',
                                      '<2>',
                                      '<3>',
                                      '<4>',
                                      '<5>',
                                      '<6>',
                                      '<7>',
                                      '<8>',
                                      '<9>'],
                          'reserved_token': ['semantics_0',
                                             'semantics_1',
                                             'semantics_2',
                                             'semantics_3',
                                             'semantics_4',
                                             'semantics_5',
                                             'semantics_6',
                                             'semantics_7',
                                             'semantics_8',
                                             'semantics_9']},
               'edge': {'continuous': None,
                        'dim': 3,
                        'discrete': 'edge_attr',
                        'ignored_val': None},
               'graph': {'continuous': None,
                         'discrete': None,
                         'ignored_val': None},
               'instructions': {'enable': False,
                                'func': [{'mask_ratio': 0,
                                          'name': 'homo_lumo',
                                          'valid': 1},
                                         {'name': 'cepdb_prop_all',
                                          'valid': 0}],
                                'name': 'molecule'},
               'node': {'continuous': None,
                        'dim': 9,
                        'discrete': 'x',
                        'ignored_val': None}},
 'structure': {'common': {'icl_token': '<icl>',
                          'mask_token': '<mask>',
                          'reserved_token': ['structure_0',
                                             'structure_1',
                                             'structure_2',
                                             'structure_3',
                                             'structure_4',
                                             'structure_5',
                                             'structure_6',
                                             'structure_7',
                                             'structure_8',
                                             'structure_9'],
                          'sep_token': '<sep>'},
               'edge': {'bi_token': '<edge_bi>',
                        'in_token': '<edge_in>',
                        'jump_token': '<edge_jump>',
                        'out_token': '<edge_out>',
                        'remove_edge_type_token': True},
               'graph': {'summary_token': '<gsum>'},
               'node': {'bos_token': '<bos>',
                        'cyclic': 1,
                        'eos_token': '<eos>',
                        'new_node_token': '<new>',
                        'node_scope': 512,
                        'scope_base': 512},
               'nx': {'enable': False,
                      'func': [{'name': 'degree', 'valid': 0},
                               {'name': 'triangles', 'valid': 0},
                               {'name': 'shortest_path', 'valid': 0},
                               {'name': 'shortest_path_length', 'valid': 0},
                               {'name': 'eulerian_path', 'valid': 1}]}},
 'task_type': 'pretrain-mlm',
 'tokenizer_class': 'StackedGSTTokenizer',
 'vocab_file': 'vocab512_stacked'}
stacked_feat: 13, next_n_token: 13, embed_dim: 0

Loading dataset PCQM4Mv2 ...

dataset._data -> Data(edge_index=[2, 109093626], edge_attr=[109093626, 3], x=[52970652, 9], y=[3746620])
In pre-train mode, set all valid data's y to nan!
Before setting, y has 294469 NANs
After setting, y has 368014 NANs
load idx from data/OGB/pcqm4m-v2/dedup_idx_train_valid ...
load idx from data/OGB/pcqm4m-v2/dedup_idx_train_valid with 1st 10 idx:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Using dedup_idx with 3323391 molecules instead of original 3746620 molecules!

Raw indices: 3323391, Removed indices: 294469, New indices: 3323391
[Warning] permute_nodes enabled! edge_attr remains the same; edge_index and node-attrs will be affected!
[Warning] permute_nodes enabled! edge_attr remains the same; edge_index and node-attrs will be affected!
[Warning] permute_nodes enabled! edge_attr remains the same; edge_index and node-attrs will be affected!
[Warning] permute_nodes enabled! edge_attr remains the same; edge_index and node-attrs will be affected!
[Warning] permute_nodes enabled! edge_attr remains the same; edge_index and node-attrs will be affected!

[2024-11-14 15:02:24.987659] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch None!
idx_tuple: None
(0, Data(edge_index=[2, 40], edge_attr=[40, 3], x=[18, 9], y=[1, 1], num_nodes=18, idx=0, idx_of_ds=0))
[2024-11-14 15:02:24.991072] Vocab is already built and saved in ./data/OGB/pcqm4m-v2/vocab512_stacked!
[2024-11-14 15:02:24.991113] Loading vocab from ./data/OGB/pcqm4m-v2/vocab512_stacked ...
[2024-11-14 15:02:25.006411]
{   '0': 22,
    '1': 23,
    '10': 32,
    '100': 122,
    '101': 123,
    '102': 124,
    '103': 125,
    '104': 126,
    '105': 127,
    '106': 128,
    '107': 129,
    '108': 130,
    '109': 131,
    '11': 33,
    '110': 132,
    '111': 133,
    '112': 134,
    '113': 135,
    '114': 136,
    '115': 137,
    '116': 138,
    '117': 139,
    '118': 140,
    '119': 141,
    '12': 34,
    '120': 142,
    '121': 143,
    '122': 144,
    '123': 145,
    '124': 146,
    '125': 147,
    '126': 148,
    '127': 149,
    '128': 150,
    '129': 151,
    '13': 35,
    '130': 152,
    '131': 153,
    '132': 154,
    '133': 155,
    '134': 156,
    '135': 157,
    '136': 158,
    '137': 159,
    '138': 160,
    '139': 161,
    '14': 36,
    '140': 162,
    '141': 163,
    '142': 164,
    '143': 165,
    '144': 166,
    '145': 167,
    '146': 168,
    '147': 169,
    '148': 170,
    '149': 171,
    '15': 37,
    '150': 172,
    '151': 173,
    '152': 174,
    '153': 175,
    '154': 176,
    '155': 177,
    '156': 178,
    '157': 179,
    '158': 180,
    '159': 181,
    '16': 38,
    '160': 182,
    '161': 183,
    '162': 184,
    '163': 185,
    '164': 186,
    '165': 187,
    '166': 188,
    '167': 189,
    '168': 190,
    '169': 191,
    '17': 39,
    '170': 192,
    '171': 193,
    '172': 194,
    '173': 195,
    '174': 196,
    '175': 197,
    '176': 198,
    '177': 199,
    '178': 200,
    '179': 201,
    '18': 40,
    '180': 202,
    '181': 203,
    '182': 204,
    '183': 205,
    '184': 206,
    '185': 207,
    '186': 208,
    '187': 209,
    '188': 210,
    '189': 211,
    '19': 41,
    '190': 212,
    '191': 213,
    '192': 214,
    '193': 215,
    '194': 216,
    '195': 217,
    '196': 218,
    '197': 219,
    '198': 220,
    '199': 221,
    '2': 24,
    '20': 42,
    '200': 222,
    '201': 223,
    '202': 224,
    '203': 225,
    '204': 226,
    '205': 227,
    '206': 228,
    '207': 229,
    '208': 230,
    '209': 231,
    '21': 43,
    '210': 232,
    '211': 233,
    '212': 234,
    '213': 235,
    '214': 236,
    '215': 237,
    '216': 238,
    '217': 239,
    '218': 240,
    '219': 241,
    '22': 44,
    '220': 242,
    '221': 243,
    '222': 244,
    '223': 245,
    '224': 246,
    '225': 247,
    '226': 248,
    '227': 249,
    '228': 250,
    '229': 251,
    '23': 45,
    '230': 252,
    '231': 253,
    '232': 254,
    '233': 255,
    '234': 256,
    '235': 257,
    '236': 258,
    '237': 259,
    '238': 260,
    '239': 261,
    '24': 46,
    '240': 262,
    '241': 263,
    '242': 264,
    '243': 265,
    '244': 266,
    '245': 267,
    '246': 268,
    '247': 269,
    '248': 270,
    '249': 271,
    '25': 47,
    '250': 272,
    '251': 273,
    '252': 274,
    '253': 275,
    '254': 276,
    '255': 277,
    '256': 278,
    '257': 279,
    '258': 280,
    '259': 281,
    '26': 48,
    '260': 282,
    '261': 283,
    '262': 284,
    '263': 285,
    '264': 286,
    '265': 287,
    '266': 288,
    '267': 289,
    '268': 290,
    '269': 291,
    '27': 49,
    '270': 292,
    '271': 293,
    '272': 294,
    '273': 295,
    '274': 296,
    '275': 297,
    '276': 298,
    '277': 299,
    '278': 300,
    '279': 301,
    '28': 50,
    '280': 302,
    '281': 303,
    '282': 304,
    '283': 305,
    '284': 306,
    '285': 307,
    '286': 308,
    '287': 309,
    '288': 310,
    '289': 311,
    '29': 51,
    '290': 312,
    '291': 313,
    '292': 314,
    '293': 315,
    '294': 316,
    '295': 317,
    '296': 318,
    '297': 319,
    '298': 320,
    '299': 321,
    '3': 25,
    '30': 52,
    '300': 322,
    '301': 323,
    '302': 324,
    '303': 325,
    '304': 326,
    '305': 327,
    '306': 328,
    '307': 329,
    '308': 330,
    '309': 331,
    '31': 53,
    '310': 332,
    '311': 333,
    '312': 334,
    '313': 335,
    '314': 336,
    '315': 337,
    '316': 338,
    '317': 339,
    '318': 340,
    '319': 341,
    '32': 54,
    '320': 342,
    '321': 343,
    '322': 344,
    '323': 345,
    '324': 346,
    '325': 347,
    '326': 348,
    '327': 349,
    '328': 350,
    '329': 351,
    '33': 55,
    '330': 352,
    '331': 353,
    '332': 354,
    '333': 355,
    '334': 356,
    '335': 357,
    '336': 358,
    '337': 359,
    '338': 360,
    '339': 361,
    '34': 56,
    '340': 362,
    '341': 363,
    '342': 364,
    '343': 365,
    '344': 366,
    '345': 367,
    '346': 368,
    '347': 369,
    '348': 370,
    '349': 371,
    '35': 57,
    '350': 372,
    '351': 373,
    '352': 374,
    '353': 375,
    '354': 376,
    '355': 377,
    '356': 378,
    '357': 379,
    '358': 380,
    '359': 381,
    '36': 58,
    '360': 382,
    '361': 383,
    '362': 384,
    '363': 385,
    '364': 386,
    '365': 387,
    '366': 388,
    '367': 389,
    '368': 390,
    '369': 391,
    '37': 59,
    '370': 392,
    '371': 393,
    '372': 394,
    '373': 395,
    '374': 396,
    '375': 397,
    '376': 398,
    '377': 399,
    '378': 400,
    '379': 401,
    '38': 60,
    '380': 402,
    '381': 403,
    '382': 404,
    '383': 405,
    '384': 406,
    '385': 407,
    '386': 408,
    '387': 409,
    '388': 410,
    '389': 411,
    '39': 61,
    '390': 412,
    '391': 413,
    '392': 414,
    '393': 415,
    '394': 416,
    '395': 417,
    '396': 418,
    '397': 419,
    '398': 420,
    '399': 421,
    '4': 26,
    '40': 62,
    '400': 422,
    '401': 423,
    '402': 424,
    '403': 425,
    '404': 426,
    '405': 427,
    '406': 428,
    '407': 429,
    '408': 430,
    '409': 431,
    '41': 63,
    '410': 432,
    '411': 433,
    '412': 434,
    '413': 435,
    '414': 436,
    '415': 437,
    '416': 438,
    '417': 439,
    '418': 440,
    '419': 441,
    '42': 64,
    '420': 442,
    '421': 443,
    '422': 444,
    '423': 445,
    '424': 446,
    '425': 447,
    '426': 448,
    '427': 449,
    '428': 450,
    '429': 451,
    '43': 65,
    '430': 452,
    '431': 453,
    '432': 454,
    '433': 455,
    '434': 456,
    '435': 457,
    '436': 458,
    '437': 459,
    '438': 460,
    '439': 461,
    '44': 66,
    '440': 462,
    '441': 463,
    '442': 464,
    '443': 465,
    '444': 466,
    '445': 467,
    '446': 468,
    '447': 469,
    '448': 470,
    '449': 471,
    '45': 67,
    '450': 472,
    '451': 473,
    '452': 474,
    '453': 475,
    '454': 476,
    '455': 477,
    '456': 478,
    '457': 479,
    '458': 480,
    '459': 481,
    '46': 68,
    '460': 482,
    '461': 483,
    '462': 484,
    '463': 485,
    '464': 486,
    '465': 487,
    '466': 488,
    '467': 489,
    '468': 490,
    '469': 491,
    '47': 69,
    '470': 492,
    '471': 493,
    '472': 494,
    '473': 495,
    '474': 496,
    '475': 497,
    '476': 498,
    '477': 499,
    '478': 500,
    '479': 501,
    '48': 70,
    '480': 502,
    '481': 503,
    '482': 504,
    '483': 505,
    '484': 506,
    '485': 507,
    '486': 508,
    '487': 509,
    '488': 510,
    '489': 511,
    '49': 71,
    '490': 512,
    '491': 513,
    '492': 514,
    '493': 515,
    '494': 516,
    '495': 517,
    '496': 518,
    '497': 519,
    '498': 520,
    '499': 521,
    '5': 27,
    '50': 72,
    '500': 522,
    '501': 523,
    '502': 524,
    '503': 525,
    '504': 526,
    '505': 527,
    '506': 528,
    '507': 529,
    '508': 530,
    '509': 531,
    '51': 73,
    '510': 532,
    '511': 533,
    '52': 74,
    '53': 75,
    '54': 76,
    '55': 77,
    '56': 78,
    '57': 79,
    '58': 80,
    '59': 81,
    '6': 28,
    '60': 82,
    '61': 83,
    '62': 84,
    '63': 85,
    '64': 86,
    '65': 87,
    '66': 88,
    '67': 89,
    '68': 90,
    '69': 91,
    '7': 29,
    '70': 92,
    '71': 93,
    '72': 94,
    '73': 95,
    '74': 96,
    '75': 97,
    '76': 98,
    '77': 99,
    '78': 100,
    '79': 101,
    '8': 30,
    '80': 102,
    '81': 103,
    '82': 104,
    '83': 105,
    '84': 106,
    '85': 107,
    '86': 108,
    '87': 109,
    '88': 110,
    '89': 111,
    '9': 31,
    '90': 112,
    '91': 113,
    '92': 114,
    '93': 115,
    '94': 116,
    '95': 117,
    '96': 118,
    '97': 119,
    '98': 120,
    '99': 121,
    '<->': 546,
    '<.>': 545,
    '<0>': 547,
    '<1>': 548,
    '<2>': 549,
    '<3>': 550,
    '<4>': 551,
    '<5>': 552,
    '<6>': 553,
    '<7>': 554,
    '<8>': 555,
    '<9>': 556,
    '<bos>': 20,
    '<e>': 544,
    '<edge_bi>': 17,
    '<edge_in>': 15,
    '<edge_jump>': 18,
    '<edge_out>': 16,
    '<eos>': 19,
    '<gsum>': 14,
    '<icl>': 2,
    '<label_pad>': -100,
    '<mask>': 1,
    '<new>': 21,
    '<sep>': 3,
    'molecule#edge#0': 740,
    'molecule#edge#0#0': 743,
    'molecule#edge#0#1': 744,
    'molecule#edge#0#2': 745,
    'molecule#edge#0#3': 746,
    'molecule#edge#0#4': 747,
    'molecule#edge#1': 741,
    'molecule#edge#1#0': 748,
    'molecule#edge#1#1': 749,
    'molecule#edge#1#2': 750,
    'molecule#edge#1#3': 751,
    'molecule#edge#1#4': 752,
    'molecule#edge#1#5': 753,
    'molecule#edge#2': 742,
    'molecule#edge#2#0': 754,
    'molecule#edge#2#1': 755,
    'molecule#node#0': 557,
    'molecule#node#0#0': 566,
    'molecule#node#0#1': 567,
    'molecule#node#0#10': 568,
    'molecule#node#0#100': 569,
    'molecule#node#0#101': 570,
    'molecule#node#0#102': 571,
    'molecule#node#0#103': 572,
    'molecule#node#0#104': 573,
    'molecule#node#0#105': 574,
    'molecule#node#0#106': 575,
    'molecule#node#0#107': 576,
    'molecule#node#0#108': 577,
    'molecule#node#0#109': 578,
    'molecule#node#0#11': 579,
    'molecule#node#0#110': 580,
    'molecule#node#0#111': 581,
    'molecule#node#0#112': 582,
    'molecule#node#0#113': 583,
    'molecule#node#0#114': 584,
    'molecule#node#0#115': 585,
    'molecule#node#0#116': 586,
    'molecule#node#0#117': 587,
    'molecule#node#0#118': 588,
    'molecule#node#0#12': 589,
    'molecule#node#0#13': 590,
    'molecule#node#0#14': 591,
    'molecule#node#0#15': 592,
    'molecule#node#0#16': 593,
    'molecule#node#0#17': 594,
    'molecule#node#0#18': 595,
    'molecule#node#0#19': 596,
    'molecule#node#0#2': 597,
    'molecule#node#0#20': 598,
    'molecule#nod ......
label token id to be converted to -100 is set()

  0%|          | 0/10000 [00:00<?, ?it/s]
  1%|          | 51/10000 [00:00<00:19, 507.18it/s]
  1%|          | 103/10000 [00:00<00:19, 510.90it/s]
  2%|▏         | 158/10000 [00:00<00:18, 527.25it/s]
  2%|▏         | 212/10000 [00:00<00:18, 530.10it/s]
  3%|▎         | 266/10000 [00:00<00:18, 517.24it/s]
  3%|▎         | 319/10000 [00:00<00:18, 520.10it/s]
  4%|▎         | 372/10000 [00:00<00:18, 520.94it/s]
  4%|▍         | 425/10000 [00:00<00:18, 522.19it/s]
  5%|▍         | 478/10000 [00:00<00:18, 520.66it/s]
  5%|▌         | 531/10000 [00:01<00:18, 513.99it/s]
  6%|▌         | 585/10000 [00:01<00:18, 520.24it/s]
  6%|▋         | 638/10000 [00:01<00:18, 511.54it/s]
  7%|▋         | 690/10000 [00:01<00:18, 512.04it/s]
  7%|▋         | 742/10000 [00:01<00:18, 508.22it/s]
  8%|▊         | 795/10000 [00:01<00:17, 512.56it/s]
  8%|▊         | 847/10000 [00:01<00:17, 512.93it/s]
  9%|▉         | 900/10000 [00:01<00:17, 515.31it/s]
 10%|▉         | 952/10000 [00:01<00:17, 515.48it/s]
 10%|█         | 1004/10000 [00:01<00:17, 516.59it/s]
 11%|█         | 1056/10000 [00:02<00:17, 506.34it/s]
 11%|█         | 1107/10000 [00:02<00:17, 506.42it/s]
 12%|█▏        | 1160/10000 [00:02<00:17, 512.67it/s]
 12%|█▏        | 1212/10000 [00:02<00:17, 510.31it/s]
 13%|█▎        | 1264/10000 [00:02<00:17, 508.78it/s]
 13%|█▎        | 1317/10000 [00:02<00:16, 513.15it/s]
 14%|█▎        | 1369/10000 [00:02<00:17, 501.43it/s]
 14%|█▍        | 1422/10000 [00:02<00:16, 508.36it/s]
 15%|█▍        | 1473/10000 [00:02<00:16, 501.79it/s]
 15%|█▌        | 1525/10000 [00:02<00:16, 504.41it/s]
 16%|█▌        | 1577/10000 [00:03<00:16, 508.49it/s]
 16%|█▋        | 1628/10000 [00:03<00:16, 493.25it/s]
 17%|█▋        | 1678/10000 [00:03<00:17, 487.62it/s]
 17%|█▋        | 1727/10000 [00:03<00:17, 486.61it/s]
 18%|█▊        | 1777/10000 [00:03<00:16, 490.44it/s]
 18%|█▊        | 1828/10000 [00:03<00:16, 495.03it/s]
 19%|█▉        | 1878/10000 [00:03<00:16, 492.27it/s]
 19%|█▉        | 1928/10000 [00:03<00:16, 489.91it/s]
 20%|█▉        | 1978/10000 [00:03<00:16, 489.29it/s]
 20%|██        | 2029/10000 [00:04<00:16, 492.80it/s]
 21%|██        | 2079/10000 [00:04<00:16, 493.52it/s]
 21%|██▏       | 2130/10000 [00:04<00:15, 497.89it/s]
 22%|██▏       | 2184/10000 [00:04<00:15, 508.35it/s]
 22%|██▏       | 2236/10000 [00:04<00:15, 508.98it/s]
 23%|██▎       | 2287/10000 [00:04<00:15, 505.81it/s]
 23%|██▎       | 2338/10000 [00:04<00:15, 501.73it/s]
 24%|██▍       | 2389/10000 [00:04<00:15, 496.41it/s]
 24%|██▍       | 2440/10000 [00:04<00:15, 497.04it/s]
 25%|██▍       | 2490/10000 [00:04<00:15, 492.08it/s]
 25%|██▌       | 2540/10000 [00:05<00:15, 491.57it/s]
 26%|██▌       | 2591/10000 [00:05<00:14, 495.67it/s]
 26%|██▋       | 2641/10000 [00:05<00:14, 494.43it/s]
 27%|██▋       | 2691/10000 [00:05<00:14, 492.62it/s]
 27%|██▋       | 2742/10000 [00:05<00:14, 495.12it/s]
 28%|██▊       | 2793/10000 [00:05<00:14, 498.55it/s]
 28%|██▊       | 2845/10000 [00:05<00:14, 504.12it/s]
 29%|██▉       | 2896/10000 [00:05<00:14, 503.03it/s]
 29%|██▉       | 2947/10000 [00:05<00:14, 497.81it/s]
 30%|██▉       | 2997/10000 [00:05<00:14, 490.03it/s]
 30%|███       | 3047/10000 [00:06<00:14, 485.64it/s]
 31%|███       | 3096/10000 [00:06<00:14, 482.76it/s]
 31%|███▏      | 3146/10000 [00:06<00:14, 487.40it/s]
 32%|███▏      | 3195/10000 [00:06<00:14, 483.50it/s]
 32%|███▏      | 3246/10000 [00:06<00:13, 488.17it/s]
 33%|███▎      | 3295/10000 [00:06<00:13, 481.54it/s]
 33%|███▎      | 3347/10000 [00:06<00:13, 491.83it/s]
 34%|███▍      | 3397/10000 [00:06<00:13, 491.75it/s]
 34%|███▍      | 3447/10000 [00:06<00:13, 489.55it/s]
 35%|███▍      | 3497/10000 [00:06<00:13, 489.52it/s]
 35%|███▌      | 3547/10000 [00:07<00:13, 490.26it/s]
 36%|███▌      | 3597/10000 [00:07<00:13, 488.90it/s]
 36%|███▋      | 3647/10000 [00:07<00:12, 490.50it/s]
 37%|███▋      | 3697/10000 [00:07<00:12, 492.04it/s]
 37%|███▋      | 3747/10000 [00:07<00:12, 489.66it/s]
 38%|███▊      | 3797/10000 [00:07<00:12, 490.68it/s]
 38%|███▊      | 3849/10000 [00:07<00:12, 498.12it/s]
 39%|███▉      | 3899/10000 [00:07<00:12, 494.94it/s]
 39%|███▉      | 3949/10000 [00:07<00:12, 492.32it/s]
 40%|███▉      | 3999/10000 [00:07<00:12, 488.78it/s]
 40%|████      | 4049/10000 [00:08<00:12, 490.77it/s]
 41%|████      | 4099/10000 [00:08<00:11, 492.15it/s]
 42%|████▏     | 4150/10000 [00:08<00:11, 496.74it/s]
 42%|████▏     | 4203/10000 [00:08<00:11, 503.59it/s]
 43%|████▎     | 4254/10000 [00:08<00:11, 492.33it/s]
 43%|████▎     | 4307/10000 [00:08<00:11, 502.23it/s]
 44%|████▎     | 4358/10000 [00:08<00:11, 500.66it/s]
 44%|████▍     | 4409/10000 [00:08<00:11, 500.92it/s]
 45%|████▍     | 4460/10000 [00:08<00:11, 500.98it/s]
 45%|████▌     | 4511/10000 [00:09<00:10, 500.66it/s]
 46%|████▌     | 4562/10000 [00:09<00:10, 498.78it/s]
 46%|████▌     | 4612/10000 [00:09<00:10, 495.06it/s]
 47%|████▋     | 4662/10000 [00:09<00:10, 495.73it/s]
 47%|████▋     | 4712/10000 [00:09<00:10, 495.28it/s]
 48%|████▊     | 4762/10000 [00:09<00:10, 490.23it/s]
 48%|████▊     | 4812/10000 [00:09<00:10, 492.23it/s]
 49%|████▊     | 4862/10000 [00:09<00:10, 493.48it/s]
 49%|████▉     | 4912/10000 [00:09<00:10, 488.56it/s]
 50%|████▉     | 4962/10000 [00:09<00:10, 488.56it/s]
 50%|█████     | 5012/10000 [00:10<00:10, 489.62it/s]
 51%|█████     | 5064/10000 [00:10<00:09, 497.08it/s]
 51%|█████     | 5115/10000 [00:10<00:09, 497.09it/s]
 52%|█████▏    | 5167/10000 [00:10<00:09, 503.58it/s]
 52%|█████▏    | 5218/10000 [00:10<00:09, 502.42it/s]
 53%|█████▎    | 5270/10000 [00:10<00:09, 505.42it/s]
 53%|█████▎    | 5323/10000 [00:10<00:09, 510.36it/s]
 54%|█████▍    | 5375/10000 [00:10<00:09, 512.28it/s]
 54%|█████▍    | 5427/10000 [00:10<00:08, 514.44it/s]
 55%|█████▍    | 5480/10000 [00:10<00:08, 517.48it/s]
 55%|█████▌    | 5533/10000 [00:11<00:08, 520.53it/s]
 56%|█████▌    | 5586/10000 [00:11<00:08, 514.39it/s]
 56%|█████▋    | 5638/10000 [00:11<00:08, 514.24it/s]
 57%|█████▋    | 5690/10000 [00:11<00:08, 513.94it/s]
 57%|█████▋    | 5742/10000 [00:11<00:08, 512.91it/s]
 58%|█████▊    | 5795/10000 [00:11<00:08, 515.24it/s]
 58%|█████▊    | 5847/10000 [00:11<00:08, 510.56it/s]
 59%|█████▉    | 5899/10000 [00:11<00:08, 504.13it/s]
 60%|█████▉    | 5950/10000 [00:11<00:08, 504.70it/s]
 60%|██████    | 6001/10000 [00:11<00:07, 501.26it/s]
 61%|██████    | 6053/10000 [00:12<00:07, 504.76it/s]
 61%|██████    | 6104/10000 [00:12<00:07, 504.20it/s]
 62%|██████▏   | 6157/10000 [00:12<00:07, 510.30it/s]
 62%|██████▏   | 6209/10000 [00:12<00:07, 509.31it/s]
 63%|██████▎   | 6260/10000 [00:12<00:07, 509.01it/s]
 63%|██████▎   | 6312/10000 [00:12<00:07, 510.69it/s]
 64%|██████▎   | 6364/10000 [00:12<00:07, 507.99it/s]
 64%|██████▍   | 6415/10000 [00:12<00:07, 507.20it/s]
 65%|██████▍   | 6468/10000 [00:12<00:06, 511.13it/s]
 65%|██████▌   | 6521/10000 [00:12<00:06, 514.50it/s]
 66%|██████▌   | 6575/10000 [00:13<00:06, 519.68it/s]
 66%|██████▋   | 6627/10000 [00:13<00:06, 515.11it/s]
 67%|██████▋   | 6679/10000 [00:13<00:06, 511.64it/s]
 67%|██████▋   | 6732/10000 [00:13<00:06, 516.08it/s]
 68%|██████▊   | 6787/10000 [00:13<00:06, 524.74it/s]
 68%|██████▊   | 6840/10000 [00:13<00:06, 519.23it/s]
 69%|██████▉   | 6893/10000 [00:13<00:05, 519.97it/s]
 69%|██████▉   | 6946/10000 [00:13<00:05, 519.00it/s]
 70%|██████▉   | 6998/10000 [00:13<00:05, 517.29it/s]
 70%|███████   | 7050/10000 [00:14<00:05, 514.78it/s]
 71%|███████   | 7103/10000 [00:14<00:05, 516.53it/s]
 72%|███████▏  | 7155/10000 [00:14<00:05, 516.20it/s]
 72%|███████▏  | 7207/10000 [00:14<00:05, 513.73it/s]
 73%|███████▎  | 7259/10000 [00:14<00:05, 506.51it/s]
 73%|███████▎  | 7310/10000 [00:14<00:05, 502.81it/s]
 74%|███████▎  | 7362/10000 [00:14<00:05, 506.73it/s]
 74%|███████▍  | 7418/10000 [00:14<00:04, 518.52it/s]
 75%|███████▍  | 7470/10000 [00:14<00:04, 516.86it/s]
 75%|███████▌  | 7522/10000 [00:14<00:04, 510.68it/s]
 76%|███████▌  | 7574/10000 [00:15<00:04, 512.75it/s]
 76%|███████▋  | 7626/10000 [00:15<00:04, 513.12it/s]
 77%|███████▋  | 7678/10000 [00:15<00:04, 510.42it/s]
 77%|███████▋  | 7730/10000 [00:15<00:04, 510.20it/s]
 78%|███████▊  | 7784/10000 [00:15<00:04, 517.15it/s]
 78%|███████▊  | 7836/10000 [00:15<00:04, 509.65it/s]
 79%|███████▉  | 7887/10000 [00:15<00:04, 507.98it/s]
 79%|███████▉  | 7940/10000 [00:15<00:04, 512.45it/s]
 80%|███████▉  | 7995/10000 [00:15<00:03, 523.29it/s]
 80%|████████  | 8049/10000 [00:15<00:03, 525.19it/s]
 81%|████████  | 8102/10000 [00:16<00:03, 522.45it/s]
 82%|████████▏ | 8155/10000 [00:16<00:03, 523.38it/s]
 82%|████████▏ | 8209/10000 [00:16<00:03, 525.28it/s]
 83%|████████▎ | 8262/10000 [00:16<00:03, 525.27it/s]
 83%|████████▎ | 8316/10000 [00:16<00:03, 528.53it/s]
 84%|████████▎ | 8369/10000 [00:16<00:03, 519.90it/s]
 84%|████████▍ | 8422/10000 [00:16<00:03, 520.06it/s]
 85%|████████▍ | 8475/10000 [00:16<00:02, 516.13it/s]
 85%|████████▌ | 8527/10000 [00:16<00:02, 507.96it/s]
 86%|████████▌ | 8578/10000 [00:16<00:02, 505.43it/s]
 86%|████████▋ | 8630/10000 [00:17<00:02, 509.34it/s]
 87%|████████▋ | 8683/10000 [00:17<00:02, 513.85it/s]
 87%|████████▋ | 8735/10000 [00:17<00:02, 505.48it/s]
 88%|████████▊ | 8786/10000 [00:17<00:02, 503.15it/s]
 88%|████████▊ | 8837/10000 [00:17<00:02, 504.64it/s]
 89%|████████▉ | 8888/10000 [00:17<00:02, 505.67it/s]
 89%|████████▉ | 8939/10000 [00:17<00:02, 505.67it/s]
 90%|████████▉ | 8991/10000 [00:17<00:01, 508.18it/s]
 90%|█████████ | 9043/10000 [00:17<00:01, 510.03it/s]
 91%|█████████ | 9098/10000 [00:18<00:01, 520.59it/s]
 92%|█████████▏| 9153/10000 [00:18<00:01, 526.75it/s]
 92%|█████████▏| 9206/10000 [00:18<00:01, 523.96it/s]
 93%|█████████▎| 9259/10000 [00:18<00:01, 517.54it/s]
 93%|█████████▎| 9311/10000 [00:18<00:01, 510.67it/s]
 94%|█████████▎| 9364/10000 [00:18<00:01, 513.66it/s]
 94%|█████████▍| 9416/10000 [00:18<00:01, 508.72it/s]
 95%|█████████▍| 9469/10000 [00:18<00:01, 514.69it/s]
 95%|█████████▌| 9521/10000 [00:19<00:01, 318.35it/s]
 96%|█████████▌| 9573/10000 [00:19<00:01, 358.68it/s]
 96%|█████████▋| 9626/10000 [00:19<00:00, 396.06it/s]
 97%|█████████▋| 9679/10000 [00:19<00:00, 427.61it/s]
 97%|█████████▋| 9731/10000 [00:19<00:00, 451.25it/s]
 98%|█████████▊| 9781/10000 [00:19<00:00, 462.71it/s]
 98%|█████████▊| 9833/10000 [00:19<00:00, 478.06it/s]
 99%|█████████▉| 9886/10000 [00:19<00:00, 489.57it/s]
 99%|█████████▉| 9939/10000 [00:19<00:00, 500.38it/s]
100%|█████████▉| 9991/10000 [00:19<00:00, 503.68it/s]
100%|██████████| 10000/10000 [00:19<00:00, 500.98it/s]
Estimated tokens per sample 20.0 with std 4.0 using 10000 samples and mpe 1024

[2024-11-14 15:02:46.149481] tokens_per_sample: 20.0

Inspecting graph of index 2691681
Inspecting tokenization results!
Tokenize graph:
Data(edge_index=[2, 26], edge_attr=[26, 3], x=[13, 9], y=[1, 1], num_nodes=13, idx=2691681, idx_of_ds=0)

Tokens:
[['112', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0', 'molecule#edge#1', 'molecule#edge#2'],
 ['113', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['114', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#4', 'molecule#node#3#5', 'molecule#node#4#2', 'molecule#node#5#0', 'molecule#node#6#2', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['115', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#4', 'molecule#node#3#5', 'molecule#node#4#3', 'molecule#node#5#0', 'molecule#node#6#2', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['114', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#4', 'molecule#node#3#5', 'molecule#node#4#2', 'molecule#node#5#0', 'molecule#node#6#2', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['113', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['116', 'molecule#node#0#7', 'molecule#node#1#0', 'molecule#node#2#1', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#1', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['113', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#1', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['112', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['117', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#1', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#3', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['118', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#3', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['119', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#4', 'molecule#node#3#5', 'molecule#node#4#3', 'molecule#node#5#0', 'molecule#node#6#2', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['118', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['120', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#3', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['121', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#4', 'molecule#node#3#5', 'molecule#node#4#3', 'molecule#node#5#0', 'molecule#node#6#2', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['120', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['122', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#1', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#3', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['123', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#3', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['124', 'molecule#node#0#6', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#2', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['123', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['112', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#3', 'molecule#edge#1#0', 'molecule#edge#2#1']]
Labels:
[['113', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['114', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#4', 'molecule#node#3#5', 'molecule#node#4#2', 'molecule#node#5#0', 'molecule#node#6#2', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['115', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#4', 'molecule#node#3#5', 'molecule#node#4#3', 'molecule#node#5#0', 'molecule#node#6#2', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['114', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#4', 'molecule#node#3#5', 'molecule#node#4#2', 'molecule#node#5#0', 'molecule#node#6#2', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['113', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['116', 'molecule#node#0#7', 'molecule#node#1#0', 'molecule#node#2#1', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#1', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['113', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#1', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['112', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['117', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#1', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#3', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['118', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#3', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['119', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#4', 'molecule#node#3#5', 'molecule#node#4#3', 'molecule#node#5#0', 'molecule#node#6#2', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['118', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['120', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#3', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['121', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#4', 'molecule#node#3#5', 'molecule#node#4#3', 'molecule#node#5#0', 'molecule#node#6#2', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['120', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#0'],
 ['122', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#1', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#3', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['123', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#3', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['124', 'molecule#node#0#6', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#2', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#0', 'molecule#node#8#0', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['123', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#0', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['112', 'molecule#node#0#5', 'molecule#node#1#0', 'molecule#node#2#3', 'molecule#node#3#5', 'molecule#node#4#0', 'molecule#node#5#0', 'molecule#node#6#1', 'molecule#node#7#1', 'molecule#node#8#1', 'molecule#edge#0#3', 'molecule#edge#1#0', 'molecule#edge#2#1'],
 ['<eos>', '<eos>', '<eos>', '<eos>', '<eos>', '<eos>', '<eos>', '<eos>', '<eos>', '<eos>', '<eos>', '<eos>', '<eos>']]
embed:[]

Tokenized results:
{'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
 'embed': array([], shape=(21, 0), dtype=float64),
 'input_ids': [[134, 630, 685, 695, 709, 714, 724, 731, 737, 739, 740, 741, 742],
               [135, 630, 685, 695, 709, 714, 724, 731, 736, 738, 743, 748, 755],
               [136, 630, 685, 696, 709, 716, 724, 732, 736, 738, 743, 748, 754],
               [137, 630, 685, 696, 709, 717, 724, 732, 736, 738, 743, 748, 754],
               [136, 630, 685, 696, 709, 716, 724, 732, 736, 738, 743, 748, 754],
               [135, 630, 685, 695, 709, 714, 724, 731, 736, 738, 743, 748, 754],
               [138, 652, 685, 691, 709, 714, 724, 731, 736, 738, 744, 748, 755],
               [135, 630, 685, 695, 709, 714, 724, 731, 736, 738, 744, 748, 755],
               [134, 630, 685, 695, 709, 714, 724, 731, 737, 739, 743, 748, 755],
               [139, 630, 685, 695, 709, 715, 724, 731, 737, 739, 746, 748, 755],
               [140, 630, 685, 695, 709, 714, 724, 731, 737, 739, 746, 748, 755],
               [141, 630, 685, 696, 709, 717, 724, 732, 736, 738, 743, 748, 754],
               [140, 630, 685, 695, 709, 714, 724, 731, 737, 739, 743, 748, 754],
               [142, 630, 685, 695, 709, 714, 724, 731, 737, 739, 746, 748, 755],
               [143, 630, 685, 696, 709, 717, 724, 732, 736, 738, 743, 748, 754],
               [142, 630, 685, 695, 709, 714, 724, 731, 737, 739, 743, 748, 754],
               [144, 630, 685, 695, 709, 715, 724, 731, 737, 739, 746, 748, 755],
               [145, 630, 685, 695, 709, 714, 724, 731, 737, 739, 746, 748, 755],
               [146, 641, 685, 695, 709, 716, 724, 731, 736, 738, 743, 748, 755],
               [145, 630, 685, 695, 709, 714, 724, 731, 737, 739, 743, 748, 755],
               [134, 630, 685, 695, 709, 714, 724, 731, 737, 739, 746, 748, 755]],
 'labels': [[135, 630, 685, 695, 709, 714, 724, 731, 736, 738, 743, 748, 755],
            [136, 630, 685, 696, 709, 716, 724, 732, 736, 738, 743, 748, 754],
            [137, 630, 685, 696, 709, 717, 724, 732, 736, 738, 743, 748, 754],
            [136, 630, 685, 696, 709, 716, 724, 732, 736, 738, 743, 748, 754],
            [135, 630, 685, 695, 709, 714, 724, 731, 736, 738, 743, 748, 754],
            [138, 652, 685, 691, 709, 714, 724, 731, 736, 738, 744, 748, 755],
            [135, 630, 685, 695, 709, 714, 724, 731, 736, 738, 744, 748, 755],
            [134, 630, 685, 695, 709, 714, 724, 731, 737, 739, 743, 748, 755],
            [139, 630, 685, 695, 709, 715, 724, 731, 737, 739, 746, 748, 755],
            [140, 630, 685, 695, 709, 714, 724, 731, 737, 739, 746, 748, 755],
            [141, 630, 685, 696, 709, 717, 724, 732, 736, 738, 743, 748, 754],
            [140, 630, 685, 695, 709, 714, 724, 731, 737, 739, 743, 748, 754],
            [142, 630, 685, 695, 709, 714, 724, 731, 737, 739, 746, 748, 755],
            [143, 630, 685, 696, 709, 717, 724, 732, 736, 738, 743, 748, 754],
            [142, 630, 685, 695, 709, 714, 724, 731, 737, 739, 743, 748, 754],
            [144, 630, 685, 695, 709, 715, 724, 731, 737, 739, 746, 748, 755],
            [145, 630, 685, 695, 709, 714, 724, 731, 737, 739, 746, 748, 755],
            [146, 641, 685, 695, 709, 716, 724, 731, 736, 738, 743, 748, 755],
            [145, 630, 685, 695, 709, 714, 724, 731, 737, 739, 743, 748, 755],
            [134, 630, 685, 695, 709, 714, 724, 731, 737, 739, 746, 748, 755],
            [19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19]],
 'position_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]}

Inputs for model:
{'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
 'embed': array([], shape=(22, 0), dtype=float64),
 'input_ids': [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
               [135, 630, 685, 695, 709, 714, 724, 731, 736, 738, 743, 748, 755],
               [1, 1, 1, 1, 1, 1, 1, 732, 1, 738, 1, 748, 1],
               [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
               [1, 630, 1, 1, 1, 1, 1, 1, 736, 1, 1, 1, 1],
               [135, 630, 685, 695, 709, 714, 724, 731, 736, 738, 743, 748, 754],
               [138, 1, 1, 1, 1, 714, 1, 1, 1, 1, 744, 1, 755],
               [135, 630, 685, 695, 709, 714, 724, 731, 736, 738, 744, 748, 755],
               [1, 1, 1, 1, 1, 1, 1, 1, 1, 739, 1, 1, 1],
               [139, 630, 685, 695, 709, 715, 724, 731, 737, 739, 746, 748, 755],
               [140, 1, 1, 1, 1, 1, 1, 1, 1, 1, 746, 1, 755],
               [1, 1, 1, 1, 1, 1, 1, 1, 1, 738, 1, 748, 1],
               [1, 1, 1, 1, 1, 1, 1, 731, 1, 1, 1, 748, 1],
               [1, 1, 1, 1, 1, 1, 1, 1, 737, 1, 1, 748, 1],
               [1, 1, 685, 1, 1, 1, 724, 1, 1, 1, 1, 1, 754],
               [1, 1, 1, 1, 1, 1, 1, 731, 1, 739, 1, 1, 1],
               [1, 630, 1, 1, 1, 715, 1, 1, 1, 1, 746, 1, 755],
               [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 748, 1],
               [1, 1, 1, 1, 1, 1, 724, 1, 1, 1, 1, 1, 1],
               [1, 1, 1, 695, 709, 714, 1, 1, 1, 739, 1, 1, 1],
               [134, 1, 1, 1, 1, 1, 1, 1, 737, 1, 1, 1, 1],
               [19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19]],
 'labels': [[134, 630, 685, 695, 709, 714, 724, 731, 737, 739, 740, 741, 742],
            [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
            [136, 630, 685, 696, 709, 716, 724, 732, 736, 738, 743, 748, 754],
            [137, 630, 685, 696, 709, 717, 724, 732, 736, 738, 743, 748, 754],
            [136, 630, 685, 696, 709, 716, 724, 732, 736, 738, 743, 748, 754],
            [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
            [138, 652, 685, 691, 709, 714, 724, 731, 736, 738, 744, 748, 755],
            [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
            [134, 630, 685, 695, 709, 714, 724, 731, 737, 739, 743, 748, 755],
            [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
            [140, 630, 685, 695, 709, 714, 724, 731, 737, 739, 746, 748, 755],
            [141, 630, 685, 696, 709, 717, 724, 732, 736, 738, 743, 748, 754],
            [140, 630, 685, 695, 709, 714, 724, 731, 737, 739, 743, 748, 754],
            [142, 630, 685, 695, 709, 714, 724, 731, 737, 739, 746, 748, 755],
            [143, 630, 685, 696, 709, 717, 724, 732, 736, 738, 743, 748, 754],
            [142, 630, 685, 695, 709, 714, 724, 731, 737, 739, 743, 748, 754],
            [144, 630, 685, 695, 709, 715, 724, 731, 737, 739, 746, 748, 755],
            [145, 630, 685, 695, 709, 714, 724, 731, 737, 739, 746, 748, 755],
            [146, 641, 685, 695, 709, 716, 724, 731, 736, 738, 743, 748, 755],
            [145, 630, 685, 695, 709, 714, 724, 731, 737, 739, 743, 748, 755],
            [134, 630, 685, 695, 709, 714, 724, 731, 737, 739, 746, 748, 755],
            [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100]],
 'position_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]}

[Warning] Set eos_idx to 100000000 for task pretrain-mlm!

[2024-11-14 15:02:46.154169] total_num_steps: 195313
warmup_num_steps: 4883
epochs per worker: 61

GraphGPTConfig {
  "attention_bias": false,
  "attention_dropout": 0.1,
  "bos_token_id": 20,
  "causal_attention": false,
  "cls_token_id": null,
  "dropout": 0,
  "embed_dim": 0,
  "embed_pdrop": 0,
  "eos_token_id": 19,
  "hidden_act": "gelu",
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_scale_init_value": 0,
  "loss_type": null,
  "max_position_embeddings": 1024,
  "mlp": [],
  "mlp_pdrop": 0,
  "model_type": "graphgpt",
  "next_n_token": 13,
  "num_attention_heads": 12,
  "num_hidden_layers": 24,
  "num_key_value_heads": 12,
  "num_neg": null,
  "pad_token_id": 0,
  "path_pdrop": 0,
  "pooling_method": "last",
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-06,
  "rope_scaling": null,
  "rope_theta": 10000,
  "stack_method": "short",
  "stacked_feat": 13,
  "stacked_feat_agg_method": "gated",
  "tie_word_embeddings": false,
  "transformers_version": "4.38.2",
  "use_cache": true,
  "vocab_size": 756
}

[2024-11-14 15:02:46,154] [INFO] [comm.py:652:init_distributed] cdb=None
NOT Applying dropout in backbone transformer

Monkey Patch LlamaModel's method `_update_causal_mask`!

Next-token-prediction changed to next/masked-13-tokens-prediction!
trainable params: 235368960 || all params: 235368960 || trainable%: 100.0
GraphGPTCausal(
  (model): LlamaModel(
    (embed_tokens): Embedding(756, 768, padding_idx=0)
    (layers): ModuleList(
      (0-23): 24 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=768, out_features=768, bias=False)
          (k_proj): Linear(in_features=768, out_features=768, bias=False)
          (v_proj): Linear(in_features=768, out_features=768, bias=False)
          (o_proj): Linear(in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=768, out_features=756, bias=False)
  (stacked_feat_agg): StackedFeatAggregation(stacked_feat=13, hidden_size=768)
  (next_n_token_head): Linear(in_features=768, out_features=9984, bias=False)
)

[2024-11-14 15:02:49.375059] ds_config:
{'activation_checkpointing': {'contiguous_memory_optimization': True,
                              'cpu_checkpointing': False,
                              'partition_activations': True},
 'flops_profiler': {'detailed': True,
                    'enabled': True,
                    'module_depth': -1,
                    'output_file': None,
                    'profile_step': 1,
                    'top_modules': 1},
 'fp16': {'enabled': True,
          'hysteresis': 2,
          'initial_scale_power': 16,
          'loss_scale': 0,
          'loss_scale_window': 1000,
          'min_loss_scale': 1},
 'gradient_accumulation_steps': 1,
 'gradient_clipping': 5,
 'optimizer': {'params': {'betas': (0.9, 0.95),
                          'bias_correction': True,
                          'eps': 1e-08,
                          'lr': 0.0003,
                          'weight_decay': 0.1},
               'type': 'Adam'},
 'scheduler': {'params': {'last_batch_iteration': -1,
                          'total_num_steps': 195313,
                          'warmup_max_lr': 0.0003,
                          'warmup_min_lr': 2.9999999999999997e-05,
                          'warmup_num_steps': 4883},
               'type': 'WarmupDecayLR'},
 'train_batch_size': 1024,
 'train_micro_batch_size_per_gpu': 1024,
 'wall_clock_breakdown': False,
 'zero_optimization': {'overlap_comm': True, 'stage': 2}}
[2024-11-14 15:02:49,375] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.15.1, git-hash=unknown, git-branch=unknown
[2024-11-14 15:02:49,375] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 1
[2024-11-14 15:02:49,502] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: True
Using /home/yang/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/yang/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.6879775524139404 seconds
[2024-11-14 15:02:50,192] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2024-11-14 15:02:50,192] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-11-14 15:02:50,196] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-11-14 15:02:50,196] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2024-11-14 15:02:50,197] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2024-11-14 15:02:50,197] [INFO] [stage_1_and_2.py:148:__init__] Reduce bucket size 500000000
[2024-11-14 15:02:50,197] [INFO] [stage_1_and_2.py:149:__init__] Allgather bucket size 500000000
[2024-11-14 15:02:50,197] [INFO] [stage_1_and_2.py:150:__init__] CPU Offload: False
[2024-11-14 15:02:50,197] [INFO] [stage_1_and_2.py:151:__init__] Round robin gradient partitioning: False
[2024-11-14 15:02:50,576] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2024-11-14 15:02:50,577] [INFO] [utils.py:782:see_memory_usage] MA 1.32 GB         Max_MA 1.76 GB         CA 1.76 GB         Max_CA 2 GB 
[2024-11-14 15:02:50,579] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 12.7 GB, percent = 40.9%
[2024-11-14 15:02:50,763] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2024-11-14 15:02:50,764] [INFO] [utils.py:782:see_memory_usage] MA 1.32 GB         Max_MA 2.2 GB         CA 2.64 GB         Max_CA 3 GB 
[2024-11-14 15:02:50,764] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 12.7 GB, percent = 40.9%
[2024-11-14 15:02:50,764] [INFO] [stage_1_and_2.py:543:__init__] optimizer state initialized
[2024-11-14 15:02:50,946] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2024-11-14 15:02:50,947] [INFO] [utils.py:782:see_memory_usage] MA 1.32 GB         Max_MA 1.32 GB         CA 2.64 GB         Max_CA 3 GB 
[2024-11-14 15:02:50,947] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 12.7 GB, percent = 40.9%
[2024-11-14 15:02:50,950] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2024-11-14 15:02:50,950] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = WarmupDecayLR
[2024-11-14 15:02:50,950] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupDecayLR object at 0x726bb79d38e0>
[2024-11-14 15:02:50,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0003], mom=[(0.9, 0.95)]
[2024-11-14 15:02:50,951] [INFO] [config.py:999:print] DeepSpeedEngine configuration:
[2024-11-14 15:02:50,951] [INFO] [config.py:1003:print]   activation_checkpointing_config  {
    "partition_activations": true, 
    "contiguous_memory_optimization": true, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-11-14 15:02:50,951] [INFO] [config.py:1003:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   amp_enabled .................. False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   amp_params ................... False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   bfloat16_enabled ............. False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   bfloat16_immediate_grad_update  False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   checkpoint_parallel_write_pipeline  False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   checkpoint_tag_validation_enabled  True
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   checkpoint_tag_validation_fail  False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x726bb79d35e0>
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   communication_data_type ...... None
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   curriculum_enabled_legacy .... False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   curriculum_params_legacy ..... False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   data_efficiency_enabled ...... False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   dataloader_drop_last ......... False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   disable_allgather ............ False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   dump_state ................... False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   eigenvalue_enabled ........... False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   eigenvalue_layer_num ......... 0
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   eigenvalue_max_iter .......... 100
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   eigenvalue_stability ......... 1e-06
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   eigenvalue_tol ............... 0.01
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   eigenvalue_verbose ........... False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   elasticity_enabled ........... False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   flops_profiler_config ........ {
    "enabled": true, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   fp16_auto_cast ............... False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   fp16_enabled ................. True
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   fp16_master_weights_and_gradients  False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   global_rank .................. 0
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   grad_accum_dtype ............. None
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   gradient_accumulation_steps .. 1
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   gradient_clipping ............ 5
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   gradient_predivide_factor .... 1.0
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   graph_harvesting ............. False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   initial_dynamic_scale ........ 65536
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   load_universal_checkpoint .... False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   loss_scale ................... 0
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   memory_breakdown ............. False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   mics_hierarchial_params_gather  False
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   mics_shard_size .............. -1
[2024-11-14 15:02:50,952] [INFO] [config.py:1003:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   optimizer_legacy_fusion ...... False
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   optimizer_name ............... adam
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   optimizer_params ............. {'lr': 0.0003, 'weight_decay': 0.1, 'bias_correction': True, 'eps': 1e-08, 'betas': (0.9, 0.95)}
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   pld_enabled .................. False
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   pld_params ................... False
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   prescale_gradients ........... False
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   scheduler_name ............... WarmupDecayLR
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   scheduler_params ............. {'warmup_min_lr': 2.9999999999999997e-05, 'warmup_max_lr': 0.0003, 'warmup_num_steps': 4883, 'total_num_steps': 195313, 'last_batch_iteration': -1}
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   sparse_attention ............. None
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   sparse_gradients_enabled ..... False
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   steps_per_print .............. 10
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   timers_config ................ enabled=True synchronized=True
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   train_batch_size ............. 1024
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   train_micro_batch_size_per_gpu  1024
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   use_data_before_expert_parallel_  False
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   use_node_local_storage ....... False
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   wall_clock_breakdown ......... True
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   weight_quantization_config ... None
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   world_size ................... 1
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   zero_allow_untested_optimizer  False
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   zero_enabled ................. True
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-14 15:02:50,953] [INFO] [config.py:1003:print]   zero_optimization_stage ...... 2
[2024-11-14 15:02:50,953] [INFO] [config.py:989:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 1.024000e+03, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000, 
        "initial_scale_power": 16, 
        "hysteresis": 2, 
        "min_loss_scale": 1
    }, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.0003, 
            "weight_decay": 0.1, 
            "bias_correction": true, 
            "eps": 1e-08, 
            "betas": [0.9, 0.95]
        }
    }, 
    "scheduler": {
        "type": "WarmupDecayLR", 
        "params": {
            "warmup_min_lr": 2.9999999999999997e-05, 
            "warmup_max_lr": 0.0003, 
            "warmup_num_steps": 4.883000e+03, 
            "total_num_steps": 1.953130e+05, 
            "last_batch_iteration": -1
        }
    }, 
    "zero_optimization": {
        "stage": 2, 
        "overlap_comm": true
    }, 
    "flops_profiler": {
        "enabled": true, 
        "profile_step": 1, 
        "module_depth": -1, 
        "top_modules": 1, 
        "detailed": true, 
        "output_file": null
    }, 
    "activation_checkpointing": {
        "partition_activations": true, 
        "contiguous_memory_optimization": true, 
        "cpu_checkpointing": false
    }, 
    "wall_clock_breakdown": false, 
    "gradient_accumulation_steps": 1, 
    "train_batch_size": 1.024000e+03, 
    "gradient_clipping": 5
}
[2024-11-14 15:02:50.954411] Finish -> Dump model config to `./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1/config.json`
[2024-11-14 15:02:50.954425] Finish -> 2. set optimizer
[2024-11-14 15:02:50.954446] Finish -> 3.1 init collator
[2024-11-14 15:02:50.954704] Finish -> Dump to `tokenization_config.json`
[2024-11-14 15:02:50.954743] Finish -> Dump to `params.txt`
[2024-11-14 15:02:50.954830] Finish -> Dump to `ds_config.json`
[2024-11-14 15:02:51.794310] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 0!
[2024-11-14 15:02:51.830764] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 1!
[2024-11-14 15:02:51.869413] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 2!
[2024-11-14 15:02:51.906248] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 3!
[2024-11-14 15:02:51.943052] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 4!
[2024-11-14 15:02:51.979632] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 5!
[2024-11-14 15:02:52.016530] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 6!
[2024-11-14 15:02:52.053201] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 7!
[2024-11-14 15:02:52.089952] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 8!
[2024-11-14 15:02:52.126453] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 9!
[2024-11-14 15:02:52.163225] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 10!
[2024-11-14 15:02:52.199882] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 11!
[2024-11-14 15:02:52.236458] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 12!
[2024-11-14 15:02:52.273111] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 13!
[2024-11-14 15:02:52.309880] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 14!
[2024-11-14 15:02:52.346715] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 15!
[2024-11-14 15:02:52.384979] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 16!
[2024-11-14 15:02:52.425272] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 17!
[2024-11-14 15:02:52.465127] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 18!
[2024-11-14 15:02:52.508517] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 19!
[2024-11-14 15:02:52.556045] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 20!
[2024-11-14 15:02:52.603524] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 21!
[2024-11-14 15:02:52.650951] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 22!
[2024-11-14 15:02:52.698448] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 23!
[2024-11-14 15:02:52.746178] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 24!
[2024-11-14 15:02:52.997614] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 25!
[2024-11-14 15:02:53.039884] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 26!
[2024-11-14 15:02:53.081913] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 27!
[2024-11-14 15:02:53.123706] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 28!
[2024-11-14 15:02:53.165606] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 29!
[2024-11-14 15:02:53.207529] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 30!
[2024-11-14 15:02:53.249529] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 31!
[2024-11-14 15:02:53.291547] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 32!
[2024-11-14 15:02:53.333495] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 33!
[2024-11-14 15:02:53.375408] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 34!
[2024-11-14 15:02:53.417472] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 35!
[2024-11-14 15:02:53.459645] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 36!
[2024-11-14 15:02:53.501644] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 37!
[2024-11-14 15:02:53.543533] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 38!
[2024-11-14 15:02:53.585396] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 39!
[2024-11-14 15:02:53.627254] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 40!
[2024-11-14 15:02:53.669044] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 41!
[2024-11-14 15:02:53.711066] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 42!
[2024-11-14 15:02:53.752899] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 43!
[2024-11-14 15:02:53.794712] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 44!
[2024-11-14 15:02:53.836648] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 45!
[2024-11-14 15:02:53.878772] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 46!
[2024-11-14 15:02:53.920804] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 47!
[2024-11-14 15:02:53.962866] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 48!
[2024-11-14 15:02:54.004907] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 49!
[2024-11-14 15:02:54.046753] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 50!
[2024-11-14 15:02:54.088688] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 51!
[2024-11-14 15:02:54.130546] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 52!
[2024-11-14 15:02:54.172407] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 53!
[2024-11-14 15:02:54.214349] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 54!
[2024-11-14 15:02:54.256346] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 55!
[2024-11-14 15:02:54.298305] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 56!
[2024-11-14 15:02:54.340172] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 57!
[2024-11-14 15:02:54.382151] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 58!
[2024-11-14 15:02:54.424208] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 59!
[2024-11-14 15:02:54.466291] NOT RESET samples of GraphsMapDataset of 3323391 graphs for epoch 60!
train_sampler for 61 epochs increase: 3323391 -> 202726851
[2024-11-14 15:04:14.054328] Training start ...
[2024-11-14 15:04:20,035] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:04:23,741] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:04:27,397] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:04:30,943] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:04:34,462] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:04:37,971] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:04:41,486] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:04:44,959] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:04:48,422] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:04:51,911] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:04:55,374] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:04:58,850] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-14 15:05:05,698] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-11-14 15:05:05,699] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 771.91 | bwd_microstep: 986.29 | bwd_inner_microstep: 977.82 | bwd_allreduce_microstep: 8.39 | step_microstep: 41.97
[2024-11-14 15:05:05,699] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 771.88 | bwd: 986.31 | bwd_inner: 977.84 | bwd_allreduce: 8.39 | step: 41.98
[2024-11-14 15:05:05.699653][epoch 0][local 0: 0][global 0] train_loss: 6.7493811, 0.0 samples / 0 tokens per sec
[2024-11-14 15:05:05,699] [WARNING] [lr_schedules.py:681:get_lr] Attempting to get learning rate from scheduler before it has started
[2024-11-14 15:05:06,827] [INFO] [profiler.py:80:start_profile] Flops profiler started
[2024-11-14 15:05:13,291] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768

-------------------------- DeepSpeed Flops Profiler --------------------------
Profile Summary at step 2:
Notations:
data parallel size (dp_size), model parallel size(mp_size),
number of parameters (params), number of multiply-accumulate operations(MACs),
number of floating-point operations (flops), floating-point operations per second (FLOPS),
fwd latency (forward propagation latency), bwd latency (backward propagation latency),
step (weights update latency), iter latency (sum of fwd, bwd and step latency)

world size:                                                             1       
data parallel size:                                                     1       
model parallel size:                                                    1       
batch size per GPU:                                                     1024    
params per GPU:                                                         235.37 M
params of model = params per GPU * mp_size:                             235.37 M
fwd MACs per GPU:                                                       9.51 TMACs
fwd flops per GPU:                                                      19.02 T 
fwd flops of model = fwd flops per GPU * mp_size:                       19.02 T 
fwd latency:                                                            380.06 ms
fwd FLOPS per GPU = fwd flops per GPU / fwd latency:                    50.06 TFLOPS
bwd latency:                                                            921.8 ms
bwd FLOPS per GPU = 2 * fwd flops per GPU / bwd latency:                41.28 TFLOPS
fwd+bwd FLOPS per GPU = 3 * fwd flops per GPU / (fwd+bwd latency):      43.84 TFLOPS
step latency:                                                           17.79 ms
iter latency:                                                           1.32 s  
FLOPS per GPU = 3 * fwd flops per GPU / iter latency:                   43.25 TFLOPS
samples/second:                                                         775.97  

----------------------------- Aggregated Profile per GPU -----------------------------
Top 1 modules in terms of params, MACs or fwd latency at different model depths:
depth 0:
    params      - {'GraphGPTCausal': '235.37 M'}
    MACs        - {'GraphGPTCausal': '9.51 TMACs'}
    fwd latency - {'GraphGPTCausal': '379.89 ms'}
depth 1:
    params      - {'LlamaModel': '227.11 M'}
    MACs        - {'LlamaModel': '9.34 TMACs'}
    fwd latency - {'LlamaModel': '350.97 ms'}
depth 2:
    params      - {'ModuleList': '226.53 M'}
    MACs        - {'ModuleList': '9.34 TMACs'}
    fwd latency - {'ModuleList': '342.93 ms'}
depth 3:
    params      - {'LlamaDecoderLayer': '226.53 M'}
    MACs        - {'LlamaDecoderLayer': '9.34 TMACs'}
    fwd latency - {'LlamaDecoderLayer': '342.93 ms'}
depth 4:
    params      - {'LlamaMLP': '169.87 M'}
    MACs        - {'LlamaMLP': '6.96 TMACs'}
    fwd latency - {'LlamaMLP': '127.47 ms'}

------------------------------ Detailed Profile per GPU ------------------------------
Each module profile is listed after its name in the following order: 
params, percentage of total params, MACs, percentage of total MACs, fwd latency, percentage of total fwd latency, fwd FLOPS

Note: 1. A module can have torch.nn.module or torch.nn.functional to compute logits (e.g. CrossEntropyLoss). They are not counted as submodules, thus not to be printed out. However they make up the difference between a parent's MACs (or latency) and the sum of its submodules'.
2. Number of floating-point operations is a theoretical estimation, thus FLOPS computed using that could be larger than the maximum system throughput.
3. The fwd latency listed in the top module's profile is directly captured at the module forward function in PyTorch, thus it's less than the fwd latency shown above which is captured in DeepSpeed.

GraphGPTCausal(
  235.37 M = 100% Params, 9.51 TMACs = 100% MACs, 379.89 ms = 100% latency, 50.08 TFLOPS
  (model): LlamaModel(
    227.11 M = 96.49% Params, 9.34 TMACs = 98.17% MACs, 350.97 ms = 92.39% latency, 53.21 TFLOPS
    (embed_tokens): Embedding(580.61 K = 0.25% Params, 0 MACs = 0% MACs, 2.03 ms = 0.53% latency, 0 FLOPS, 756, 768, padding_idx=0)
    (layers): ModuleList(
      (0): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 14.1 ms = 3.71% latency, 55.18 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 5.12 ms = 1.35% latency, 38.77 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 395.54 us = 0.1% latency, 122.16 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 345.47 us = 0.09% latency, 139.86 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 344.28 us = 0.09% latency, 140.35 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 360.01 us = 0.09% latency, 134.21 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 506.64 us = 0.13% latency, 5.05 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.43 ms = 1.43% latency, 106.82 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.28 ms = 0.34% latency, 150.68 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.27 ms = 0.33% latency, 151.98 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.35 ms = 0.36% latency, 142.72 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 567.44 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
      )
      (1): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.93 ms = 3.67% latency, 55.85 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 5.04 ms = 1.33% latency, 39.37 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 367.64 us = 0.1% latency, 131.43 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 346.42 us = 0.09% latency, 139.48 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 344.28 us = 0.09% latency, 140.35 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 372.65 us = 0.1% latency, 129.66 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 422.72 us = 0.11% latency, 6.06 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.38 ms = 1.42% latency, 107.81 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.27 ms = 0.33% latency, 152.03 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.27 ms = 0.33% latency, 152.72 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.35 ms = 0.35% latency, 143.66 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 563.14 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.25 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
      )
      (2): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 21.21 ms = 5.58% latency, 36.69 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 8.23 ms = 2.17% latency, 24.1 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 359.3 us = 0.09% latency, 134.48 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 343.08 us = 0.09% latency, 140.84 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 342.61 us = 0.09% latency, 141.03 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 381.47 us = 0.1% latency, 126.66 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 3.6 ms = 0.95% latency, 711.75 KFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 6.42 ms = 1.69% latency, 90.36 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 2.26 ms = 0.59% latency, 85.67 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.29 ms = 0.34% latency, 150.18 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.36 ms = 0.36% latency, 142.49 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 566.48 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.25 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.26 ms = 0.33% latency, 0 FLOPS)
      )
      (3): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.81 ms = 3.63% latency, 56.35 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.87 ms = 1.28% latency, 40.69 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 373.6 us = 0.1% latency, 129.33 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 348.57 us = 0.09% latency, 138.62 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 343.32 us = 0.09% latency, 140.74 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 374.56 us = 0.1% latency, 129 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 283.96 us = 0.07% latency, 9.02 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.41 ms = 1.42% latency, 107.16 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.28 ms = 0.34% latency, 151.13 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.27 ms = 0.33% latency, 152.58 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.36 ms = 0.36% latency, 142.62 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 564.34 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.25 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.25 ms = 0.33% latency, 0 FLOPS)
      )
      (4): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 19.94 ms = 5.25% latency, 39.03 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 5 ms = 1.32% latency, 39.69 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 373.6 us = 0.1% latency, 129.33 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 345.23 us = 0.09% latency, 139.96 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 343.8 us = 0.09% latency, 140.54 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 385.28 us = 0.1% latency, 125.41 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 283.96 us = 0.07% latency, 9.02 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 8.06 ms = 2.12% latency, 71.94 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.32 ms = 0.35% latency, 145.9 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 3.85 ms = 1.01% latency, 50.2 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.37 ms = 0.36% latency, 141.03 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 567.91 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.26 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.26 ms = 0.33% latency, 0 FLOPS)
      )
      (5): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 14.11 ms = 3.71% latency, 55.15 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 5.17 ms = 1.36% latency, 38.36 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 380.28 us = 0.1% latency, 127.06 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 352.14 us = 0.09% latency, 137.21 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 343.8 us = 0.09% latency, 140.54 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 377.66 us = 0.1% latency, 127.94 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 474.93 us = 0.13% latency, 5.39 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.4 ms = 1.42% latency, 107.36 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.28 ms = 0.34% latency, 151.55 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.27 ms = 0.33% latency, 152.55 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.35 ms = 0.36% latency, 143.17 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 564.34 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.26 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.25 ms = 0.33% latency, 0 FLOPS)
      )
      (6): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 16.92 ms = 4.45% latency, 46 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 8.25 ms = 2.17% latency, 24.03 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 354.05 us = 0.09% latency, 136.47 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 326.87 us = 0.09% latency, 147.82 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 324.01 us = 0.09% latency, 149.13 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 2.05 ms = 0.54% latency, 23.57 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 1.99 ms = 0.52% latency, 1.29 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.18 ms = 1.36% latency, 111.91 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.21 ms = 0.32% latency, 159.14 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.19 ms = 0.31% latency, 162.78 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.26 ms = 0.33% latency, 153.04 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 569.82 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.26 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.25 ms = 0.33% latency, 0 FLOPS)
      )
      (7): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.6 ms = 3.58% latency, 57.23 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 5 ms = 1.32% latency, 39.69 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 348.81 us = 0.09% latency, 138.52 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 327.11 us = 0.09% latency, 147.71 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 322.1 us = 0.08% latency, 150.01 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 363.35 us = 0.1% latency, 132.98 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 434.88 us = 0.11% latency, 5.89 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.14 ms = 1.35% latency, 112.9 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.19 ms = 0.31% latency, 162.06 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 163.67 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.25 ms = 0.33% latency, 154.62 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 565.05 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.25 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.25 ms = 0.33% latency, 0 FLOPS)
      )
      (8): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 19.29 ms = 5.08% latency, 40.34 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 8.19 ms = 2.15% latency, 24.23 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 358.1 us = 0.09% latency, 134.93 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 942.95 us = 0.25% latency, 51.24 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 324.49 us = 0.09% latency, 148.91 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 346.42 us = 0.09% latency, 139.48 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 3.11 ms = 0.82% latency, 823.17 KFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.12 ms = 1.35% latency, 113.14 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.19 ms = 0.31% latency, 162.42 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 163.24 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.26 ms = 0.33% latency, 153.94 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 563.62 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 3.77 ms = 0.99% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
      )
      (9): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.15 ms = 3.46% latency, 59.19 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.65 ms = 1.23% latency, 42.62 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 337.6 us = 0.09% latency, 143.12 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 324.49 us = 0.09% latency, 148.91 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 319.96 us = 0.08% latency, 151.01 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 334.26 us = 0.09% latency, 144.55 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 257.73 us = 0.07% latency, 9.93 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.07 ms = 1.34% latency, 114.32 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 163.57 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.17 ms = 0.31% latency, 164.63 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.33 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 561.24 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.23 ms = 0.32% latency, 0 FLOPS)
      )
      (10): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.11 ms = 3.45% latency, 59.36 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.62 ms = 1.22% latency, 42.9 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 336.41 us = 0.09% latency, 143.63 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 320.43 us = 0.08% latency, 150.79 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 320.43 us = 0.08% latency, 150.79 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 335.45 us = 0.09% latency, 144.04 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 252.49 us = 0.07% latency, 10.14 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.07 ms = 1.33% latency, 114.42 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 163.77 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.27 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.71 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 559.81 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
      )
      (11): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.11 ms = 3.45% latency, 59.38 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.62 ms = 1.22% latency, 42.89 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 336.89 us = 0.09% latency, 143.43 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 321.87 us = 0.08% latency, 150.12 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 320.91 us = 0.08% latency, 150.57 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 330.92 us = 0.09% latency, 146.01 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 253.92 us = 0.07% latency, 10.08 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.07 ms = 1.33% latency, 114.41 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.03 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.17 ms = 0.31% latency, 164.7 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.36 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 556.95 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.23 ms = 0.32% latency, 0 FLOPS)
      )
      (12): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.1 ms = 3.45% latency, 59.39 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.62 ms = 1.22% latency, 42.92 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 337.12 us = 0.09% latency, 143.33 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 321.87 us = 0.08% latency, 150.12 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 321.15 us = 0.08% latency, 150.45 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 338.32 us = 0.09% latency, 142.82 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 248.67 us = 0.07% latency, 10.29 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.06 ms = 1.33% latency, 114.51 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 163.93 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.17 ms = 0.31% latency, 164.97 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.62 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 560.76 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
      )
      (13): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.07 ms = 3.44% latency, 59.52 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.6 ms = 1.21% latency, 43.11 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 332.36 us = 0.09% latency, 145.38 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 320.2 us = 0.08% latency, 150.9 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 319.24 us = 0.08% latency, 151.35 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 330.45 us = 0.09% latency, 146.22 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 244.62 us = 0.06% latency, 10.47 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.06 ms = 1.33% latency, 114.57 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.17 ms = 0.31% latency, 164.5 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.45 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 555.75 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
      )
      (14): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.07 ms = 3.44% latency, 59.54 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.6 ms = 1.21% latency, 43.16 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 331.64 us = 0.09% latency, 145.7 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 321.39 us = 0.08% latency, 150.34 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 319.48 us = 0.08% latency, 151.24 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 335.93 us = 0.09% latency, 143.83 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 238.18 us = 0.06% latency, 10.75 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.06 ms = 1.33% latency, 114.49 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 163.47 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.17 ms = 0.31% latency, 164.53 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.48 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 554.32 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.23 ms = 0.32% latency, 0 FLOPS)
      )
      (15): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.08 ms = 3.44% latency, 59.47 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.61 ms = 1.21% latency, 43 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 331.64 us = 0.09% latency, 145.7 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 322.1 us = 0.08% latency, 150.01 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 319.48 us = 0.08% latency, 151.24 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 332.36 us = 0.09% latency, 145.38 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 250.82 us = 0.07% latency, 10.21 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.06 ms = 1.33% latency, 114.48 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 163.93 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.33 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.51 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 558.61 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.23 ms = 0.32% latency, 0 FLOPS)
      )
      (16): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.05 ms = 3.44% latency, 59.62 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.59 ms = 1.21% latency, 43.19 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 333.55 us = 0.09% latency, 144.86 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 321.39 us = 0.08% latency, 150.34 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 318.77 us = 0.08% latency, 151.58 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 327.35 us = 0.09% latency, 147.61 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 243.19 us = 0.06% latency, 10.53 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.05 ms = 1.33% latency, 114.7 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.17 ms = 0.31% latency, 164.73 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.74 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 555.04 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.23 ms = 0.32% latency, 0 FLOPS)
      )
      (17): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.09 ms = 3.44% latency, 59.46 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.61 ms = 1.21% latency, 43.07 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 334.98 us = 0.09% latency, 144.24 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 320.91 us = 0.08% latency, 150.57 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 320.2 us = 0.08% latency, 150.9 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 332.12 us = 0.09% latency, 145.49 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 242.95 us = 0.06% latency, 10.54 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.07 ms = 1.34% latency, 114.3 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 163.54 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.43 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.25 ms = 0.33% latency, 155.21 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 559.57 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.23 ms = 0.32% latency, 0 FLOPS)
      )
      (18): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.05 ms = 3.43% latency, 59.64 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.59 ms = 1.21% latency, 43.21 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 332.83 us = 0.09% latency, 145.17 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 320.67 us = 0.08% latency, 150.68 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 319 us = 0.08% latency, 151.47 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 326.87 us = 0.09% latency, 147.82 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 241.99 us = 0.06% latency, 10.58 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.05 ms = 1.33% latency, 114.73 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.1 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.17 ms = 0.31% latency, 164.77 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.89 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 556.47 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.23 ms = 0.32% latency, 0 FLOPS)
      )
      (19): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.03 ms = 3.43% latency, 59.74 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.57 ms = 1.2% latency, 43.41 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 333.07 us = 0.09% latency, 145.07 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 319.96 us = 0.08% latency, 151.01 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 319.24 us = 0.08% latency, 151.35 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 327.83 us = 0.09% latency, 147.39 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 217.44 us = 0.06% latency, 11.77 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.06 ms = 1.33% latency, 114.66 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 163.93 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.17 ms = 0.31% latency, 164.5 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.59 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 554.32 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.23 ms = 0.32% latency, 0 FLOPS)
      )
      (20): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.02 ms = 3.43% latency, 59.75 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.57 ms = 1.2% latency, 43.43 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 331.16 us = 0.09% latency, 145.9 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 319.96 us = 0.08% latency, 151.01 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 319.72 us = 0.08% latency, 151.13 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 329.73 us = 0.09% latency, 146.54 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 221.01 us = 0.06% latency, 11.58 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.05 ms = 1.33% latency, 114.76 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.23 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.4 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.53 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 551.94 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.23 ms = 0.32% latency, 0 FLOPS)
      )
      (21): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.03 ms = 3.43% latency, 59.71 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.57 ms = 1.2% latency, 43.39 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 330.45 us = 0.09% latency, 146.22 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 321.39 us = 0.08% latency, 150.34 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 318.77 us = 0.08% latency, 151.58 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 326.63 us = 0.09% latency, 147.93 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 225.31 us = 0.06% latency, 11.36 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.06 ms = 1.33% latency, 114.67 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.1 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.3 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.8 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 555.75 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.23 ms = 0.32% latency, 0 FLOPS)
      )
      (22): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.02 ms = 3.43% latency, 59.76 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.56 ms = 1.2% latency, 43.47 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 331.16 us = 0.09% latency, 145.9 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 320.43 us = 0.08% latency, 150.79 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 318.53 us = 0.08% latency, 151.69 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 329.02 us = 0.09% latency, 146.86 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 220.06 us = 0.06% latency, 11.63 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.05 ms = 1.33% latency, 114.76 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.03 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.33 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.24 ms = 0.33% latency, 155.98 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 554.32 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.23 ms = 0.32% latency, 0 FLOPS)
      )
      (23): LlamaDecoderLayer(
        9.44 M = 4.01% Params, 389.06 GMACs = 4.09% MACs, 13.06 ms = 3.44% latency, 59.59 TFLOPS
        (self_attn): LlamaAttention(
          2.36 M = 1% Params, 99.15 GMACs = 1.04% MACs, 4.57 ms = 1.2% latency, 43.4 TFLOPS
          (q_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 331.16 us = 0.09% latency, 145.9 TFLOPS, in_features=768, out_features=768, bias=False)
          (k_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 321.15 us = 0.08% latency, 150.45 TFLOPS, in_features=768, out_features=768, bias=False)
          (v_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 319.24 us = 0.08% latency, 151.35 TFLOPS, in_features=768, out_features=768, bias=False)
          (o_proj): Linear(589.82 K = 0.25% Params, 24.16 GMACs = 0.25% MACs, 328.54 us = 0.09% latency, 147.07 TFLOPS, in_features=768, out_features=768, bias=False)
          (rotary_emb): LlamaRotaryEmbedding(0 = 0% Params, 1.28 KMACs = 0% MACs, 225.54 us = 0.06% latency, 11.35 MFLOPS)
        )
        (mlp): LlamaMLP(
          7.08 M = 3.01% Params, 289.91 GMACs = 3.05% MACs, 5.07 ms = 1.34% latency, 114.28 TFLOPS
          (gate_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.2 TFLOPS, in_features=768, out_features=3072, bias=False)
          (up_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.18 ms = 0.31% latency, 164.36 TFLOPS, in_features=768, out_features=3072, bias=False)
          (down_proj): Linear(2.36 M = 1% Params, 96.64 GMACs = 1.02% MACs, 1.25 ms = 0.33% latency, 155.12 TFLOPS, in_features=3072, out_features=768, bias=False)
          (act_fn): GELUActivation(0 = 0% Params, 0 MACs = 0% MACs, 557.9 us = 0.15% latency, 0 FLOPS)
        )
        (input_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
        (post_attention_layernorm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.24 ms = 0.33% latency, 0 FLOPS)
      )
    )
    (norm): LlamaRMSNorm(768 = 0% Params, 0 MACs = 0% MACs, 1.25 ms = 0.33% latency, 0 FLOPS)
  )
  (lm_head): Linear(580.61 K = 0.25% Params, 86.42 GMACs = 0.91% MACs, 1.33 ms = 0.35% latency, 129.68 TFLOPS, in_features=768, out_features=756, bias=False)
  (stacked_feat_agg): StackedFeatAggregation(9.98 K = 0% Params, 0 MACs = 0% MACs, 19.32 ms = 5.08% latency, 42.34 GFLOPS, stacked_feat=13, hidden_size=768)
  (next_n_token_head): Linear(7.67 M = 3.26% Params, 87.79 GMACs = 0.92% MACs, 1.13 ms = 0.3% latency, 154.97 TFLOPS, in_features=768, out_features=9984, bias=False)
)
------------------------------------------------------------------------------
[2024-11-14 15:05:13,305] [INFO] [profiler.py:226:end_profile] Flops profiler finished
[2024-11-14 15:05:13,305] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 380.06 | bwd_microstep: 921.80 | bwd_inner_microstep: 919.10 | bwd_allreduce_microstep: 2.63 | step_microstep: 17.79
[2024-11-14 15:05:13,305] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 0.00 | bwd: 0.00 | bwd_inner: 919.09 | bwd_allreduce: 2.64 | step: 0.00
[2024-11-14 15:05:14,618] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.04 | optimizer_gradients: 16.25 | optimizer_step: 11.51
[2024-11-14 15:05:14,618] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 324.46 | bwd_microstep: 922.15 | bwd_inner_microstep: 919.20 | bwd_allreduce_microstep: 2.91 | step_microstep: 65.46
[2024-11-14 15:05:14,619] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 324.45 | bwd: 922.15 | bwd_inner: 919.21 | bwd_allreduce: 2.92 | step: 65.46
[2024-11-14 15:05:15,891] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:05:15,891] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 319.58 | bwd_microstep: 921.20 | bwd_inner_microstep: 918.40 | bwd_allreduce_microstep: 2.77 | step_microstep: 30.54
[2024-11-14 15:05:15,891] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 319.57 | bwd: 921.20 | bwd_inner: 918.40 | bwd_allreduce: 2.78 | step: 30.54
[2024-11-14 15:05:17,168] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:05:17,168] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 319.53 | bwd_microstep: 921.27 | bwd_inner_microstep: 918.43 | bwd_allreduce_microstep: 2.81 | step_microstep: 35.14
[2024-11-14 15:05:17,168] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 319.52 | bwd: 921.28 | bwd_inner: 918.43 | bwd_allreduce: 2.83 | step: 35.14
[2024-11-14 15:05:18,436] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:05:18,436] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 319.79 | bwd_microstep: 921.30 | bwd_inner_microstep: 918.69 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.40
[2024-11-14 15:05:18,436] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 319.78 | bwd: 921.31 | bwd_inner: 918.69 | bwd_allreduce: 2.60 | step: 25.41
[2024-11-14 15:05:19,415] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:05:19,415] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 245.10 | bwd_microstep: 707.10 | bwd_inner_microstep: 704.55 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.35
[2024-11-14 15:05:19,415] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 245.09 | bwd: 707.11 | bwd_inner: 704.55 | bwd_allreduce: 2.54 | step: 25.35
[2024-11-14 15:05:20,682] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:05:20,682] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 319.51 | bwd_microstep: 921.21 | bwd_inner_microstep: 918.66 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:05:20,682] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 319.50 | bwd: 921.21 | bwd_inner: 918.66 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:05:21,949] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:05:21,950] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 319.70 | bwd_microstep: 921.03 | bwd_inner_microstep: 918.47 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:05:21,950] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 319.70 | bwd: 921.03 | bwd_inner: 918.47 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:05:22,926] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.49
[2024-11-14 15:05:22,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=2, lr=[9.610328138807897e-05], mom=[(0.9, 0.95)]
[2024-11-14 15:05:22,926] [INFO] [timer.py:259:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=852.41312819493, CurrSamplesPerSec=1050.1552852802622, MemAllocated=3.74GB, MaxMemAllocated=10.37GB
[2024-11-14 15:05:22,926] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 241.46 | bwd_microstep: 708.36 | bwd_inner_microstep: 705.81 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.50
[2024-11-14 15:05:22,926] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 241.45 | bwd: 708.37 | bwd_inner: 705.81 | bwd_allreduce: 2.54 | step: 25.50
[2024-11-14 15:05:24,195] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:05:24,195] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 319.86 | bwd_microstep: 922.41 | bwd_inner_microstep: 919.89 | bwd_allreduce_microstep: 2.49 | step_microstep: 25.26
[2024-11-14 15:05:24,195] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 319.85 | bwd: 922.42 | bwd_inner: 919.89 | bwd_allreduce: 2.50 | step: 25.27
[2024-11-14 15:05:26,070] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.48
[2024-11-14 15:05:26,070] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 491.89 | bwd_microstep: 1351.88 | bwd_inner_microstep: 1349.09 | bwd_allreduce_microstep: 2.77 | step_microstep: 29.98
[2024-11-14 15:05:26,070] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 491.88 | bwd: 1351.89 | bwd_inner: 1349.09 | bwd_allreduce: 2.78 | step: 29.98
[2024-11-14 15:05:27,339] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.50
[2024-11-14 15:05:27,339] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 319.98 | bwd_microstep: 922.75 | bwd_inner_microstep: 920.17 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.14
[2024-11-14 15:05:27,339] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 319.97 | bwd: 922.76 | bwd_inner: 920.17 | bwd_allreduce: 2.56 | step: 25.15
[2024-11-14 15:05:28,609] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:05:28,609] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 319.98 | bwd_microstep: 922.92 | bwd_inner_microstep: 920.33 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.33
[2024-11-14 15:05:28,609] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 319.98 | bwd: 922.93 | bwd_inner: 920.33 | bwd_allreduce: 2.57 | step: 25.33
[2024-11-14 15:05:30,180] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:05:30,181] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 402.96 | bwd_microstep: 1141.13 | bwd_inner_microstep: 1138.55 | bwd_allreduce_microstep: 2.55 | step_microstep: 26.40
[2024-11-14 15:05:30,181] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 402.95 | bwd: 1141.14 | bwd_inner: 1138.55 | bwd_allreduce: 2.56 | step: 26.40
[2024-11-14 15:05:31,753] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:05:31,753] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 403.15 | bwd_microstep: 1141.76 | bwd_inner_microstep: 1138.98 | bwd_allreduce_microstep: 2.75 | step_microstep: 25.96
[2024-11-14 15:05:31,753] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 403.14 | bwd: 1141.76 | bwd_inner: 1138.98 | bwd_allreduce: 2.76 | step: 25.96
[2024-11-14 15:05:33,325] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:05:33,325] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 403.15 | bwd_microstep: 1142.20 | bwd_inner_microstep: 1139.66 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.22
[2024-11-14 15:05:33,325] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 403.15 | bwd: 1142.20 | bwd_inner: 1139.66 | bwd_allreduce: 2.52 | step: 25.23
[2024-11-14 15:05:34,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:05:34,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 319.80 | bwd_microstep: 922.92 | bwd_inner_microstep: 920.04 | bwd_allreduce_microstep: 2.85 | step_microstep: 26.50
[2024-11-14 15:05:34,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 319.80 | bwd: 922.93 | bwd_inner: 920.04 | bwd_allreduce: 2.87 | step: 26.50
[2024-11-14 15:05:36,167] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:05:36,168] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 403.41 | bwd_microstep: 1142.22 | bwd_inner_microstep: 1139.65 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.28
[2024-11-14 15:05:36,168] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 403.40 | bwd: 1142.22 | bwd_inner: 1139.65 | bwd_allreduce: 2.55 | step: 25.29
[2024-11-14 15:05:37,450] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:05:37,450] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=2, lr=[0.00012188190857917561], mom=[(0.9, 0.95)]
[2024-11-14 15:05:37,450] [INFO] [timer.py:259:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=764.142134682248, CurrSamplesPerSec=799.1510774986639, MemAllocated=3.75GB, MaxMemAllocated=12.34GB
[2024-11-14 15:05:37,450] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.36 | bwd_microstep: 923.12 | bwd_inner_microstep: 920.44 | bwd_allreduce_microstep: 2.65 | step_microstep: 38.09
[2024-11-14 15:05:37,450] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.35 | bwd: 923.13 | bwd_inner: 920.44 | bwd_allreduce: 2.67 | step: 38.10
[2024-11-14 15:05:39,024] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:05:39,024] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 403.47 | bwd_microstep: 1142.28 | bwd_inner_microstep: 1139.70 | bwd_allreduce_microstep: 2.56 | step_microstep: 26.70
[2024-11-14 15:05:39,024] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 403.46 | bwd: 1142.29 | bwd_inner: 1139.70 | bwd_allreduce: 2.57 | step: 26.70
[2024-11-14 15:05:40,294] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.47
[2024-11-14 15:05:40,295] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 319.98 | bwd_microstep: 923.12 | bwd_inner_microstep: 920.23 | bwd_allreduce_microstep: 2.86 | step_microstep: 26.16
[2024-11-14 15:05:40,295] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 319.97 | bwd: 923.13 | bwd_inner: 920.23 | bwd_allreduce: 2.87 | step: 26.16
[2024-11-14 15:05:41,271] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:05:41,271] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 241.65 | bwd_microstep: 708.49 | bwd_inner_microstep: 705.97 | bwd_allreduce_microstep: 2.49 | step_microstep: 25.21
[2024-11-14 15:05:41,271] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 241.64 | bwd: 708.49 | bwd_inner: 705.96 | bwd_allreduce: 2.50 | step: 25.21
[2024-11-14 15:05:42,540] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:05:42,540] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.08 | bwd_microstep: 922.90 | bwd_inner_microstep: 920.31 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.31
[2024-11-14 15:05:42,541] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.07 | bwd: 922.90 | bwd_inner: 920.31 | bwd_allreduce: 2.57 | step: 25.31
[2024-11-14 15:05:43,809] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:05:43,810] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.05 | bwd_microstep: 922.65 | bwd_inner_microstep: 920.10 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:05:43,810] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.04 | bwd: 922.66 | bwd_inner: 920.10 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:05:45,080] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:05:45,080] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.65 | bwd_microstep: 923.28 | bwd_inner_microstep: 920.72 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.32
[2024-11-14 15:05:45,080] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.64 | bwd: 923.29 | bwd_inner: 920.72 | bwd_allreduce: 2.54 | step: 25.33
[2024-11-14 15:05:46,350] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:05:46,350] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.41 | bwd_microstep: 923.16 | bwd_inner_microstep: 920.63 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.29
[2024-11-14 15:05:46,350] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.40 | bwd: 923.17 | bwd_inner: 920.63 | bwd_allreduce: 2.52 | step: 25.29
[2024-11-14 15:05:47,620] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:05:47,620] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.29 | bwd_microstep: 923.24 | bwd_inner_microstep: 920.70 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.20
[2024-11-14 15:05:47,620] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.28 | bwd: 923.24 | bwd_inner: 920.70 | bwd_allreduce: 2.52 | step: 25.20
[2024-11-14 15:05:48,889] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:05:48,889] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.25 | bwd_microstep: 922.77 | bwd_inner_microstep: 920.24 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.22
[2024-11-14 15:05:48,889] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.24 | bwd: 922.78 | bwd_inner: 920.24 | bwd_allreduce: 2.52 | step: 25.22
[2024-11-14 15:05:50,159] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:05:50,159] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=2, lr=[0.00013592731171504677], mom=[(0.9, 0.95)]
[2024-11-14 15:05:50,160] [INFO] [timer.py:259:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=778.7380052922857, CurrSamplesPerSec=806.9374112777897, MemAllocated=3.74GB, MaxMemAllocated=12.34GB
[2024-11-14 15:05:50,160] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.30 | bwd_microstep: 923.32 | bwd_inner_microstep: 920.77 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.59
[2024-11-14 15:05:50,160] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.29 | bwd: 923.33 | bwd_inner: 920.77 | bwd_allreduce: 2.54 | step: 25.59
[2024-11-14 15:05:51,430] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:05:51,430] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.51 | bwd_microstep: 923.36 | bwd_inner_microstep: 920.83 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.23
[2024-11-14 15:05:51,430] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.50 | bwd: 923.37 | bwd_inner: 920.83 | bwd_allreduce: 2.51 | step: 25.23
[2024-11-14 15:05:52,699] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:05:52,699] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.11 | bwd_microstep: 922.80 | bwd_inner_microstep: 920.26 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.21
[2024-11-14 15:05:52,699] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.10 | bwd: 922.80 | bwd_inner: 920.26 | bwd_allreduce: 2.52 | step: 25.21
[2024-11-14 15:05:54,273] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:05:54,274] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 403.22 | bwd_microstep: 1143.93 | bwd_inner_microstep: 1141.20 | bwd_allreduce_microstep: 2.70 | step_microstep: 25.93
[2024-11-14 15:05:54,274] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 403.22 | bwd: 1143.94 | bwd_inner: 1141.20 | bwd_allreduce: 2.71 | step: 25.94
[2024-11-14 15:05:55,250] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:05:55,251] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 241.97 | bwd_microstep: 708.89 | bwd_inner_microstep: 706.35 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.22
[2024-11-14 15:05:55,251] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 241.96 | bwd: 708.89 | bwd_inner: 706.35 | bwd_allreduce: 2.52 | step: 25.22
[2024-11-14 15:05:56,823] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:05:56,823] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 403.27 | bwd_microstep: 1142.49 | bwd_inner_microstep: 1139.96 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.26
[2024-11-14 15:05:56,823] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 403.26 | bwd: 1142.50 | bwd_inner: 1139.96 | bwd_allreduce: 2.52 | step: 25.27
[2024-11-14 15:05:58,099] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:05:58,099] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.17 | bwd_microstep: 922.90 | bwd_inner_microstep: 920.01 | bwd_allreduce_microstep: 2.86 | step_microstep: 31.88
[2024-11-14 15:05:58,099] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.16 | bwd: 922.91 | bwd_inner: 920.01 | bwd_allreduce: 2.87 | step: 31.88
[2024-11-14 15:05:59,672] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:05:59,673] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 403.35 | bwd_microstep: 1142.57 | bwd_inner_microstep: 1139.73 | bwd_allreduce_microstep: 2.81 | step_microstep: 26.30
[2024-11-14 15:05:59,673] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 403.34 | bwd: 1142.58 | bwd_inner: 1139.73 | bwd_allreduce: 2.82 | step: 26.30
[2024-11-14 15:06:00,944] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:06:00,944] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 319.92 | bwd_microstep: 924.05 | bwd_inner_microstep: 921.20 | bwd_allreduce_microstep: 2.83 | step_microstep: 26.56
[2024-11-14 15:06:00,944] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 319.91 | bwd: 924.06 | bwd_inner: 921.20 | bwd_allreduce: 2.84 | step: 26.56
[2024-11-14 15:06:02,214] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:02,214] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.24 | bwd_microstep: 922.99 | bwd_inner_microstep: 920.29 | bwd_allreduce_microstep: 2.67 | step_microstep: 25.29
[2024-11-14 15:06:02,214] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.24 | bwd: 922.99 | bwd_inner: 920.29 | bwd_allreduce: 2.68 | step: 25.29
[2024-11-14 15:06:03,484] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:03,484] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=2, lr=[0.00014563507637513432], mom=[(0.9, 0.95)]
[2024-11-14 15:06:03,484] [INFO] [timer.py:259:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=776.2053641682633, CurrSamplesPerSec=807.0001815429167, MemAllocated=3.74GB, MaxMemAllocated=12.34GB
[2024-11-14 15:06:03,484] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.28 | bwd_microstep: 923.27 | bwd_inner_microstep: 920.72 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.56
[2024-11-14 15:06:03,484] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.27 | bwd: 923.28 | bwd_inner: 920.72 | bwd_allreduce: 2.54 | step: 25.57
[2024-11-14 15:06:04,754] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:06:04,754] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.45 | bwd_microstep: 923.14 | bwd_inner_microstep: 920.59 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:06:04,754] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.44 | bwd: 923.14 | bwd_inner: 920.59 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:06:05,731] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.49
[2024-11-14 15:06:05,731] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 241.73 | bwd_microstep: 708.73 | bwd_inner_microstep: 706.18 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.18
[2024-11-14 15:06:05,731] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 241.72 | bwd: 708.73 | bwd_inner: 706.18 | bwd_allreduce: 2.53 | step: 25.18
[2024-11-14 15:06:07,002] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:06:07,002] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.37 | bwd_microstep: 924.20 | bwd_inner_microstep: 921.61 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.43
[2024-11-14 15:06:07,002] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.36 | bwd: 924.20 | bwd_inner: 921.61 | bwd_allreduce: 2.56 | step: 25.44
[2024-11-14 15:06:08,273] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:08,273] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.65 | bwd_microstep: 924.03 | bwd_inner_microstep: 921.47 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.25
[2024-11-14 15:06:08,273] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.65 | bwd: 924.04 | bwd_inner: 921.47 | bwd_allreduce: 2.54 | step: 25.26
[2024-11-14 15:06:09,544] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:09,544] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.43 | bwd_microstep: 924.06 | bwd_inner_microstep: 921.53 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.19
[2024-11-14 15:06:09,544] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.42 | bwd: 924.07 | bwd_inner: 921.53 | bwd_allreduce: 2.52 | step: 25.20
[2024-11-14 15:06:10,815] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:10,815] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.62 | bwd_microstep: 924.22 | bwd_inner_microstep: 921.68 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.23
[2024-11-14 15:06:10,815] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.61 | bwd: 924.23 | bwd_inner: 921.68 | bwd_allreduce: 2.52 | step: 25.23
[2024-11-14 15:06:12,086] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:12,086] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.56 | bwd_microstep: 923.86 | bwd_inner_microstep: 921.32 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.23
[2024-11-14 15:06:12,086] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.55 | bwd: 923.87 | bwd_inner: 921.32 | bwd_allreduce: 2.52 | step: 25.23
[2024-11-14 15:06:14,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:06:14,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 576.19 | bwd_microstep: 1570.20 | bwd_inner_microstep: 1567.55 | bwd_allreduce_microstep: 2.61 | step_microstep: 25.50
[2024-11-14 15:06:14,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 576.18 | bwd: 1570.20 | bwd_inner: 1567.55 | bwd_allreduce: 2.63 | step: 25.50
[2024-11-14 15:06:15,530] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:15,530] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.48 | bwd_microstep: 924.12 | bwd_inner_microstep: 921.58 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.17
[2024-11-14 15:06:15,530] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.47 | bwd: 924.12 | bwd_inner: 921.58 | bwd_allreduce: 2.52 | step: 25.17
[2024-11-14 15:06:17,105] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:17,105] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=2, lr=[0.00015306144924234663], mom=[(0.9, 0.95)]
[2024-11-14 15:06:17,105] [INFO] [timer.py:259:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=771.1299690996187, CurrSamplesPerSec=650.687039801127, MemAllocated=3.74GB, MaxMemAllocated=13.35GB
[2024-11-14 15:06:17,105] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 403.59 | bwd_microstep: 1143.55 | bwd_inner_microstep: 1140.65 | bwd_allreduce_microstep: 2.87 | step_microstep: 26.81
[2024-11-14 15:06:17,105] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 403.58 | bwd: 1143.56 | bwd_inner: 1140.65 | bwd_allreduce: 2.88 | step: 26.81
[2024-11-14 15:06:18,378] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:18,378] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.69 | bwd_microstep: 925.38 | bwd_inner_microstep: 922.57 | bwd_allreduce_microstep: 2.77 | step_microstep: 25.95
[2024-11-14 15:06:18,378] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.68 | bwd: 925.38 | bwd_inner: 922.57 | bwd_allreduce: 2.79 | step: 25.95
[2024-11-14 15:06:20,254] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:20,254] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 492.69 | bwd_microstep: 1355.20 | bwd_inner_microstep: 1352.40 | bwd_allreduce_microstep: 2.76 | step_microstep: 26.29
[2024-11-14 15:06:20,254] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 492.68 | bwd: 1355.21 | bwd_inner: 1352.40 | bwd_allreduce: 2.78 | step: 26.29
[2024-11-14 15:06:21,526] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:21,526] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.77 | bwd_microstep: 924.78 | bwd_inner_microstep: 922.26 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.21
[2024-11-14 15:06:21,526] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.76 | bwd: 924.79 | bwd_inner: 922.25 | bwd_allreduce: 2.51 | step: 25.22
[2024-11-14 15:06:22,798] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:22,798] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.88 | bwd_microstep: 924.75 | bwd_inner_microstep: 922.20 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:06:22,798] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.87 | bwd: 924.76 | bwd_inner: 922.20 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:06:24,069] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:24,069] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.62 | bwd_microstep: 924.51 | bwd_inner_microstep: 921.91 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.29
[2024-11-14 15:06:24,069] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.61 | bwd: 924.52 | bwd_inner: 921.91 | bwd_allreduce: 2.58 | step: 25.29
[2024-11-14 15:06:25,341] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:25,341] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.77 | bwd_microstep: 924.61 | bwd_inner_microstep: 922.07 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.22
[2024-11-14 15:06:25,341] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.77 | bwd: 924.61 | bwd_inner: 922.07 | bwd_allreduce: 2.52 | step: 25.22
[2024-11-14 15:06:26,612] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:26,612] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.57 | bwd_microstep: 924.46 | bwd_inner_microstep: 921.92 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.25
[2024-11-14 15:06:26,612] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.56 | bwd: 924.46 | bwd_inner: 921.92 | bwd_allreduce: 2.52 | step: 25.25
[2024-11-14 15:06:27,591] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:27,592] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.45 | bwd_microstep: 710.25 | bwd_inner_microstep: 707.69 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.40
[2024-11-14 15:06:27,592] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.44 | bwd: 710.26 | bwd_inner: 707.69 | bwd_allreduce: 2.55 | step: 25.40
[2024-11-14 15:06:29,467] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:06:29,467] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 492.78 | bwd_microstep: 1355.16 | bwd_inner_microstep: 1352.15 | bwd_allreduce_microstep: 2.98 | step_microstep: 26.39
[2024-11-14 15:06:29,467] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 492.76 | bwd: 1355.17 | bwd_inner: 1352.15 | bwd_allreduce: 3.00 | step: 26.39
[2024-11-14 15:06:30,739] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:06:30,739] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=2, lr=[0.00015907725536231228], mom=[(0.9, 0.95)]
[2024-11-14 15:06:30,740] [INFO] [timer.py:259:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=767.707809372462, CurrSamplesPerSec=805.672718316386, MemAllocated=3.74GB, MaxMemAllocated=13.35GB
[2024-11-14 15:06:30,740] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.96 | bwd_microstep: 924.76 | bwd_inner_microstep: 922.22 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.49
[2024-11-14 15:06:30,740] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.95 | bwd: 924.76 | bwd_inner: 922.22 | bwd_allreduce: 2.51 | step: 25.49
[2024-11-14 15:06:32,314] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:32,315] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 403.93 | bwd_microstep: 1144.56 | bwd_inner_microstep: 1141.54 | bwd_allreduce_microstep: 2.99 | step_microstep: 25.36
[2024-11-14 15:06:32,315] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 403.93 | bwd: 1144.57 | bwd_inner: 1141.54 | bwd_allreduce: 3.01 | step: 25.36
[2024-11-14 15:06:33,890] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:33,891] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 403.89 | bwd_microstep: 1144.08 | bwd_inner_microstep: 1141.25 | bwd_allreduce_microstep: 2.80 | step_microstep: 26.50
[2024-11-14 15:06:33,891] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 403.88 | bwd: 1144.09 | bwd_inner: 1141.25 | bwd_allreduce: 2.81 | step: 26.50
[2024-11-14 15:06:35,163] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:06:35,163] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.76 | bwd_microstep: 924.62 | bwd_inner_microstep: 921.81 | bwd_allreduce_microstep: 2.77 | step_microstep: 26.20
[2024-11-14 15:06:35,163] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.75 | bwd: 924.62 | bwd_inner: 921.81 | bwd_allreduce: 2.79 | step: 26.20
[2024-11-14 15:06:36,434] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:36,435] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.82 | bwd_microstep: 924.41 | bwd_inner_microstep: 921.87 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.23
[2024-11-14 15:06:36,435] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.82 | bwd: 924.42 | bwd_inner: 921.87 | bwd_allreduce: 2.52 | step: 25.23
[2024-11-14 15:06:37,706] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:37,706] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.64 | bwd_microstep: 924.41 | bwd_inner_microstep: 921.81 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.31
[2024-11-14 15:06:37,706] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.64 | bwd: 924.41 | bwd_inner: 921.81 | bwd_allreduce: 2.58 | step: 25.31
[2024-11-14 15:06:38,978] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:38,978] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.92 | bwd_microstep: 924.79 | bwd_inner_microstep: 922.24 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.22
[2024-11-14 15:06:38,978] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.91 | bwd: 924.80 | bwd_inner: 922.24 | bwd_allreduce: 2.54 | step: 25.22
[2024-11-14 15:06:40,250] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:40,250] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.76 | bwd_microstep: 924.95 | bwd_inner_microstep: 922.39 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:06:40,250] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.75 | bwd: 924.96 | bwd_inner: 922.39 | bwd_allreduce: 2.54 | step: 25.30
[2024-11-14 15:06:41,825] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:06:41,825] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 403.68 | bwd_microstep: 1143.75 | bwd_inner_microstep: 1141.01 | bwd_allreduce_microstep: 2.72 | step_microstep: 26.12
[2024-11-14 15:06:41,825] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 403.68 | bwd: 1143.76 | bwd_inner: 1141.01 | bwd_allreduce: 2.73 | step: 26.13
[2024-11-14 15:06:43,098] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:06:43,098] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.89 | bwd_microstep: 925.28 | bwd_inner_microstep: 922.30 | bwd_allreduce_microstep: 2.95 | step_microstep: 26.04
[2024-11-14 15:06:43,098] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.88 | bwd: 925.29 | bwd_inner: 922.30 | bwd_allreduce: 2.96 | step: 26.04
[2024-11-14 15:06:44,370] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:44,370] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=2, lr=[0.00016413375637821533], mom=[(0.9, 0.95)]
[2024-11-14 15:06:44,370] [INFO] [timer.py:259:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=765.3376623309239, CurrSamplesPerSec=805.7330246403957, MemAllocated=3.74GB, MaxMemAllocated=13.35GB
[2024-11-14 15:06:44,371] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.94 | bwd_microstep: 924.73 | bwd_inner_microstep: 922.20 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.46
[2024-11-14 15:06:44,371] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.92 | bwd: 924.74 | bwd_inner: 922.19 | bwd_allreduce: 2.52 | step: 25.46
[2024-11-14 15:06:45,643] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:45,643] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.93 | bwd_microstep: 925.30 | bwd_inner_microstep: 922.75 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:06:45,643] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.92 | bwd: 925.31 | bwd_inner: 922.75 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:06:46,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:06:46,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.77 | bwd_microstep: 924.97 | bwd_inner_microstep: 922.42 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:06:46,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.76 | bwd: 924.97 | bwd_inner: 922.42 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:06:48,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:06:48,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.91 | bwd_microstep: 925.28 | bwd_inner_microstep: 922.67 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.57
[2024-11-14 15:06:48,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.91 | bwd: 925.29 | bwd_inner: 922.67 | bwd_allreduce: 2.60 | step: 25.57
[2024-11-14 15:06:49,460] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:49,460] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.83 | bwd_microstep: 924.75 | bwd_inner_microstep: 922.17 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.27
[2024-11-14 15:06:49,460] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.82 | bwd: 924.75 | bwd_inner: 922.17 | bwd_allreduce: 2.56 | step: 25.27
[2024-11-14 15:06:50,732] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:06:50,733] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.01 | bwd_microstep: 925.14 | bwd_inner_microstep: 922.58 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.26
[2024-11-14 15:06:50,733] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.00 | bwd: 925.15 | bwd_inner: 922.58 | bwd_allreduce: 2.55 | step: 25.26
[2024-11-14 15:06:52,004] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:06:52,004] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.63 | bwd_microstep: 924.57 | bwd_inner_microstep: 921.98 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.45
[2024-11-14 15:06:52,004] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.62 | bwd: 924.58 | bwd_inner: 921.98 | bwd_allreduce: 2.57 | step: 25.45
[2024-11-14 15:06:52,983] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:52,983] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.47 | bwd_microstep: 710.41 | bwd_inner_microstep: 707.87 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.22
[2024-11-14 15:06:52,984] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.46 | bwd: 710.42 | bwd_inner: 707.87 | bwd_allreduce: 2.53 | step: 25.22
[2024-11-14 15:06:53,962] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:06:53,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.40 | bwd_microstep: 710.71 | bwd_inner_microstep: 708.17 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.20
[2024-11-14 15:06:53,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.39 | bwd: 710.72 | bwd_inner: 708.17 | bwd_allreduce: 2.53 | step: 25.20
[2024-11-14 15:06:55,234] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:55,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.90 | bwd_microstep: 924.81 | bwd_inner_microstep: 922.28 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.26
[2024-11-14 15:06:55,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.90 | bwd: 924.82 | bwd_inner: 922.28 | bwd_allreduce: 2.52 | step: 25.26
[2024-11-14 15:06:56,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:06:56,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=80, skipped=2, lr=[0.00016849523717023574], mom=[(0.9, 0.95)]
[2024-11-14 15:06:56,507] [INFO] [timer.py:259:stop] epoch=0/micro_step=80/global_step=80, RunningAvgSamplesPerSec=774.6460791590545, CurrSamplesPerSec=805.56557972476, MemAllocated=3.74GB, MaxMemAllocated=13.35GB
[2024-11-14 15:06:56,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.92 | bwd_microstep: 924.93 | bwd_inner_microstep: 922.38 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.53
[2024-11-14 15:06:56,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.91 | bwd: 924.93 | bwd_inner: 922.38 | bwd_allreduce: 2.54 | step: 25.53
[2024-11-14 15:06:57,780] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:06:57,780] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.34 | bwd_microstep: 925.44 | bwd_inner_microstep: 922.89 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.31
[2024-11-14 15:06:57,780] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.33 | bwd: 925.45 | bwd_inner: 922.89 | bwd_allreduce: 2.54 | step: 25.31
[2024-11-14 15:06:59,053] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:06:59,053] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.08 | bwd_microstep: 925.23 | bwd_inner_microstep: 922.70 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.26
[2024-11-14 15:06:59,053] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.07 | bwd: 925.24 | bwd_inner: 922.70 | bwd_allreduce: 2.51 | step: 25.27
[2024-11-14 15:07:00,327] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:07:00,327] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.14 | bwd_microstep: 926.45 | bwd_inner_microstep: 923.91 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.24
[2024-11-14 15:07:00,327] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.13 | bwd: 926.45 | bwd_inner: 923.91 | bwd_allreduce: 2.52 | step: 25.24
[2024-11-14 15:07:01,599] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:01,599] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.77 | bwd_microstep: 925.01 | bwd_inner_microstep: 922.48 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.18
[2024-11-14 15:07:01,599] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.76 | bwd: 925.02 | bwd_inner: 922.48 | bwd_allreduce: 2.52 | step: 25.18
[2024-11-14 15:07:02,872] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:07:02,872] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.14 | bwd_microstep: 925.17 | bwd_inner_microstep: 922.60 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.36
[2024-11-14 15:07:02,872] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.13 | bwd: 925.17 | bwd_inner: 922.60 | bwd_allreduce: 2.56 | step: 25.36
[2024-11-14 15:07:05,642] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:07:05,643] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 742.03 | bwd_microstep: 2000.45 | bwd_inner_microstep: 1997.82 | bwd_allreduce_microstep: 2.59 | step_microstep: 26.71
[2024-11-14 15:07:05,643] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 742.02 | bwd: 2000.46 | bwd_inner: 1997.82 | bwd_allreduce: 2.61 | step: 26.71
[2024-11-14 15:07:06,914] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.49
[2024-11-14 15:07:06,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.89 | bwd_microstep: 924.87 | bwd_inner_microstep: 922.34 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.17
[2024-11-14 15:07:06,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.88 | bwd: 924.88 | bwd_inner: 922.34 | bwd_allreduce: 2.51 | step: 25.17
[2024-11-14 15:07:09,406] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:07:09,406] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 660.55 | bwd_microstep: 1804.51 | bwd_inner_microstep: 1801.96 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:07:09,406] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 660.54 | bwd: 1804.52 | bwd_inner: 1801.96 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:07:10,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:10,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.91 | bwd_microstep: 924.75 | bwd_inner_microstep: 922.22 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.22
[2024-11-14 15:07:10,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.90 | bwd: 924.75 | bwd_inner: 922.22 | bwd_allreduce: 2.51 | step: 25.23
[2024-11-14 15:07:11,951] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:11,951] [INFO] [logging.py:96:log_dist] [Rank 0] step=90, skipped=2, lr=[0.00017232987529794525], mom=[(0.9, 0.95)]
[2024-11-14 15:07:11,951] [INFO] [timer.py:259:stop] epoch=0/micro_step=90/global_step=90, RunningAvgSamplesPerSec=760.1835076525937, CurrSamplesPerSec=805.2478072132251, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:07:11,951] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.11 | bwd_microstep: 925.26 | bwd_inner_microstep: 922.72 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.53
[2024-11-14 15:07:11,951] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.09 | bwd: 925.26 | bwd_inner: 922.72 | bwd_allreduce: 2.53 | step: 25.53
[2024-11-14 15:07:13,224] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:13,224] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.05 | bwd_microstep: 925.26 | bwd_inner_microstep: 922.71 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:07:13,224] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.04 | bwd: 925.27 | bwd_inner: 922.71 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:07:14,203] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:14,203] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.34 | bwd_microstep: 710.36 | bwd_inner_microstep: 707.77 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.38
[2024-11-14 15:07:14,203] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.33 | bwd: 710.36 | bwd_inner: 707.77 | bwd_allreduce: 2.57 | step: 25.38
[2024-11-14 15:07:15,475] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:15,476] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.70 | bwd_microstep: 925.08 | bwd_inner_microstep: 922.51 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.77
[2024-11-14 15:07:15,476] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.69 | bwd: 925.09 | bwd_inner: 922.51 | bwd_allreduce: 2.56 | step: 25.78
[2024-11-14 15:07:16,455] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:07:16,455] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.63 | bwd_microstep: 710.68 | bwd_inner_microstep: 708.15 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.21
[2024-11-14 15:07:16,455] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.62 | bwd: 710.69 | bwd_inner: 708.15 | bwd_allreduce: 2.52 | step: 25.22
[2024-11-14 15:07:17,728] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:07:17,729] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.51 | bwd_microstep: 925.49 | bwd_inner_microstep: 922.85 | bwd_allreduce_microstep: 2.61 | step_microstep: 25.40
[2024-11-14 15:07:17,729] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.50 | bwd: 925.49 | bwd_inner: 922.85 | bwd_allreduce: 2.62 | step: 25.40
[2024-11-14 15:07:19,001] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:07:19,001] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.08 | bwd_microstep: 925.19 | bwd_inner_microstep: 922.55 | bwd_allreduce_microstep: 2.61 | step_microstep: 25.46
[2024-11-14 15:07:19,001] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.07 | bwd: 925.20 | bwd_inner: 922.55 | bwd_allreduce: 2.63 | step: 25.46
[2024-11-14 15:07:20,274] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:07:20,274] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.16 | bwd_microstep: 925.40 | bwd_inner_microstep: 922.87 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.25
[2024-11-14 15:07:20,274] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.15 | bwd: 925.40 | bwd_inner: 922.87 | bwd_allreduce: 2.51 | step: 25.26
[2024-11-14 15:07:21,253] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:21,254] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.48 | bwd_microstep: 710.51 | bwd_inner_microstep: 707.92 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.32
[2024-11-14 15:07:21,254] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.47 | bwd: 710.52 | bwd_inner: 707.92 | bwd_allreduce: 2.57 | step: 25.32
[2024-11-14 15:07:22,527] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:07:22,528] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.31 | bwd_microstep: 926.20 | bwd_inner_microstep: 923.40 | bwd_allreduce_microstep: 2.77 | step_microstep: 25.38
[2024-11-14 15:07:22,528] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.31 | bwd: 926.20 | bwd_inner: 923.40 | bwd_allreduce: 2.78 | step: 25.38
[2024-11-14 15:07:24,105] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:07:24,106] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=2, lr=[0.00017575134204201456], mom=[(0.9, 0.95)]
[2024-11-14 15:07:24,106] [INFO] [timer.py:259:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=767.9011997522754, CurrSamplesPerSec=649.3857428911377, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:07:24,106] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.35 | bwd_microstep: 1145.20 | bwd_inner_microstep: 1142.34 | bwd_allreduce_microstep: 2.83 | step_microstep: 27.54
[2024-11-14 15:07:24,106] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.34 | bwd: 1145.21 | bwd_inner: 1142.34 | bwd_allreduce: 2.84 | step: 27.55
[2024-11-14 15:07:25,386] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:25,386] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.35 | bwd_microstep: 925.95 | bwd_inner_microstep: 923.13 | bwd_allreduce_microstep: 2.79 | step_microstep: 31.73
[2024-11-14 15:07:25,386] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.34 | bwd: 925.96 | bwd_inner: 923.13 | bwd_allreduce: 2.80 | step: 31.73
[2024-11-14 15:07:25.386698][epoch 0][local 0: 100][global 100] train_loss: 0.829411, 535.2 samples / 10704 tokens per sec
[2024-11-14 15:07:26,658] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:07:26,659] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.01 | bwd_microstep: 924.90 | bwd_inner_microstep: 922.34 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.33
[2024-11-14 15:07:26,659] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.00 | bwd: 924.90 | bwd_inner: 922.34 | bwd_allreduce: 2.54 | step: 25.34
[2024-11-14 15:07:27,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:07:27,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.08 | bwd_microstep: 925.11 | bwd_inner_microstep: 922.56 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:07:27,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.08 | bwd: 925.11 | bwd_inner: 922.56 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:07:28,911] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:07:28,911] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.73 | bwd_microstep: 710.65 | bwd_inner_microstep: 708.13 | bwd_allreduce_microstep: 2.49 | step_microstep: 25.33
[2024-11-14 15:07:28,911] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.72 | bwd: 710.66 | bwd_inner: 708.13 | bwd_allreduce: 2.50 | step: 25.34
[2024-11-14 15:07:30,185] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:30,185] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.42 | bwd_microstep: 925.75 | bwd_inner_microstep: 923.20 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.81
[2024-11-14 15:07:30,185] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.42 | bwd: 925.76 | bwd_inner: 923.20 | bwd_allreduce: 2.53 | step: 25.82
[2024-11-14 15:07:31,164] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:31,164] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.46 | bwd_microstep: 710.59 | bwd_inner_microstep: 708.05 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.25
[2024-11-14 15:07:31,165] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.45 | bwd: 710.60 | bwd_inner: 708.05 | bwd_allreduce: 2.52 | step: 25.25
[2024-11-14 15:07:32,437] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:32,438] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.07 | bwd_microstep: 925.54 | bwd_inner_microstep: 922.95 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.34
[2024-11-14 15:07:32,438] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.06 | bwd: 925.55 | bwd_inner: 922.95 | bwd_allreduce: 2.57 | step: 25.34
[2024-11-14 15:07:34,015] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:34,016] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.23 | bwd_microstep: 1146.94 | bwd_inner_microstep: 1144.07 | bwd_allreduce_microstep: 2.84 | step_microstep: 25.96
[2024-11-14 15:07:34,016] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.22 | bwd: 1146.95 | bwd_inner: 1144.07 | bwd_allreduce: 2.85 | step: 25.96
[2024-11-14 15:07:35,290] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:07:35,290] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.29 | bwd_microstep: 925.84 | bwd_inner_microstep: 923.16 | bwd_allreduce_microstep: 2.65 | step_microstep: 26.24
[2024-11-14 15:07:35,290] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.28 | bwd: 925.85 | bwd_inner: 923.16 | bwd_allreduce: 2.66 | step: 26.24
[2024-11-14 15:07:36,562] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:07:36,562] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=2, lr=[0.00017884007643344325], mom=[(0.9, 0.95)]
[2024-11-14 15:07:36,563] [INFO] [timer.py:259:stop] epoch=0/micro_step=110/global_step=110, RunningAvgSamplesPerSec=772.6742897192145, CurrSamplesPerSec=805.487321587055, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:07:36,563] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 320.99 | bwd_microstep: 925.03 | bwd_inner_microstep: 922.49 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.50
[2024-11-14 15:07:36,563] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 320.98 | bwd: 925.03 | bwd_inner: 922.49 | bwd_allreduce: 2.52 | step: 25.50
[2024-11-14 15:07:37,836] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:07:37,836] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.27 | bwd_microstep: 925.51 | bwd_inner_microstep: 922.96 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.31
[2024-11-14 15:07:37,836] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.26 | bwd: 925.51 | bwd_inner: 922.96 | bwd_allreduce: 2.53 | step: 25.31
[2024-11-14 15:07:39,109] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:39,109] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.24 | bwd_microstep: 925.65 | bwd_inner_microstep: 923.10 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.25
[2024-11-14 15:07:39,109] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.23 | bwd: 925.66 | bwd_inner: 923.10 | bwd_allreduce: 2.54 | step: 25.25
[2024-11-14 15:07:40,384] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:40,384] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.39 | bwd_microstep: 927.23 | bwd_inner_microstep: 924.68 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.23
[2024-11-14 15:07:40,384] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.38 | bwd: 927.24 | bwd_inner: 924.68 | bwd_allreduce: 2.53 | step: 25.23
[2024-11-14 15:07:41,961] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:07:41,961] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.57 | bwd_microstep: 1145.44 | bwd_inner_microstep: 1142.78 | bwd_allreduce_microstep: 2.63 | step_microstep: 26.14
[2024-11-14 15:07:41,961] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.56 | bwd: 1145.45 | bwd_inner: 1142.78 | bwd_allreduce: 2.65 | step: 26.15
[2024-11-14 15:07:43,537] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:43,538] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.30 | bwd_microstep: 1145.03 | bwd_inner_microstep: 1142.31 | bwd_allreduce_microstep: 2.69 | step_microstep: 26.19
[2024-11-14 15:07:43,538] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.30 | bwd: 1145.03 | bwd_inner: 1142.31 | bwd_allreduce: 2.70 | step: 26.20
[2024-11-14 15:07:44,811] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:07:44,811] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.10 | bwd_microstep: 925.78 | bwd_inner_microstep: 922.98 | bwd_allreduce_microstep: 2.77 | step_microstep: 25.99
[2024-11-14 15:07:44,812] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.09 | bwd: 925.79 | bwd_inner: 922.98 | bwd_allreduce: 2.79 | step: 25.99
[2024-11-14 15:07:46,085] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:07:46,085] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.53 | bwd_microstep: 925.88 | bwd_inner_microstep: 923.33 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:07:46,085] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.52 | bwd: 925.88 | bwd_inner: 923.33 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:07:47,358] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:47,358] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.52 | bwd_microstep: 925.59 | bwd_inner_microstep: 923.05 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.24
[2024-11-14 15:07:47,359] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.51 | bwd: 925.60 | bwd_inner: 923.05 | bwd_allreduce: 2.52 | step: 25.24
[2024-11-14 15:07:48,631] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.49
[2024-11-14 15:07:48,632] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.28 | bwd_microstep: 925.65 | bwd_inner_microstep: 923.11 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.27
[2024-11-14 15:07:48,632] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.28 | bwd: 925.66 | bwd_inner: 923.11 | bwd_allreduce: 2.52 | step: 25.28
[2024-11-14 15:07:49,611] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:07:49,611] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=2, lr=[0.0001816550967285573], mom=[(0.9, 0.95)]
[2024-11-14 15:07:49,612] [INFO] [timer.py:259:stop] epoch=0/micro_step=120/global_step=120, RunningAvgSamplesPerSec=773.7322030150688, CurrSamplesPerSec=1045.9238592701247, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:07:49,612] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.72 | bwd_microstep: 711.02 | bwd_inner_microstep: 708.48 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.54
[2024-11-14 15:07:49,612] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.70 | bwd: 711.03 | bwd_inner: 708.48 | bwd_allreduce: 2.52 | step: 25.54
[2024-11-14 15:07:51,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:51,189] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.69 | bwd_microstep: 1145.70 | bwd_inner_microstep: 1143.16 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.25
[2024-11-14 15:07:51,189] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.68 | bwd: 1145.70 | bwd_inner: 1143.16 | bwd_allreduce: 2.52 | step: 25.25
[2024-11-14 15:07:52,168] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:07:52,168] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.50 | bwd_microstep: 710.79 | bwd_inner_microstep: 708.23 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.33
[2024-11-14 15:07:52,168] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.49 | bwd: 710.80 | bwd_inner: 708.23 | bwd_allreduce: 2.55 | step: 25.33
[2024-11-14 15:07:53,441] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:07:53,442] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.35 | bwd_microstep: 925.46 | bwd_inner_microstep: 922.92 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.25
[2024-11-14 15:07:53,442] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.34 | bwd: 925.47 | bwd_inner: 922.92 | bwd_allreduce: 2.52 | step: 25.25
[2024-11-14 15:07:54,715] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:07:54,715] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.41 | bwd_microstep: 925.73 | bwd_inner_microstep: 923.10 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.34
[2024-11-14 15:07:54,715] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.40 | bwd: 925.73 | bwd_inner: 923.10 | bwd_allreduce: 2.61 | step: 25.34
[2024-11-14 15:07:55,989] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:07:55,989] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.21 | bwd_microstep: 926.89 | bwd_inner_microstep: 924.34 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.31
[2024-11-14 15:07:55,990] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.19 | bwd: 926.90 | bwd_inner: 924.33 | bwd_allreduce: 2.54 | step: 25.31
[2024-11-14 15:07:57,264] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:07:57,264] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.11 | bwd_microstep: 927.01 | bwd_inner_microstep: 924.39 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.45
[2024-11-14 15:07:57,264] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.10 | bwd: 927.01 | bwd_inner: 924.39 | bwd_allreduce: 2.60 | step: 25.45
[2024-11-14 15:07:58,843] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:07:58,843] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.61 | bwd_microstep: 1147.27 | bwd_inner_microstep: 1144.51 | bwd_allreduce_microstep: 2.73 | step_microstep: 26.11
[2024-11-14 15:07:58,843] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.60 | bwd: 1147.27 | bwd_inner: 1144.51 | bwd_allreduce: 2.74 | step: 26.11
[2024-11-14 15:08:00,133] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.85 | optimizer_step: 9.49
[2024-11-14 15:08:00,134] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.19 | bwd_microstep: 926.29 | bwd_inner_microstep: 923.64 | bwd_allreduce_microstep: 2.62 | step_microstep: 41.84
[2024-11-14 15:08:00,134] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.18 | bwd: 926.30 | bwd_inner: 923.64 | bwd_allreduce: 2.63 | step: 41.84
[2024-11-14 15:08:01,114] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:08:01,114] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.90 | bwd_microstep: 711.21 | bwd_inner_microstep: 708.56 | bwd_allreduce_microstep: 2.62 | step_microstep: 25.43
[2024-11-14 15:08:01,114] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.89 | bwd: 711.22 | bwd_inner: 708.56 | bwd_allreduce: 2.63 | step: 25.44
[2024-11-14 15:08:02,992] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:08:02,992] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=2, lr=[0.00018424098990551762], mom=[(0.9, 0.95)]
[2024-11-14 15:08:02,992] [INFO] [timer.py:259:stop] epoch=0/micro_step=130/global_step=130, RunningAvgSamplesPerSec=773.1177360132235, CurrSamplesPerSec=545.6461159963292, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:08:02,992] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 493.52 | bwd_microstep: 1356.47 | bwd_inner_microstep: 1353.52 | bwd_allreduce_microstep: 2.92 | step_microstep: 26.90
[2024-11-14 15:08:02,992] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 493.51 | bwd: 1356.47 | bwd_inner: 1353.52 | bwd_allreduce: 2.93 | step: 26.90
[2024-11-14 15:08:04,265] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:04,265] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.34 | bwd_microstep: 925.36 | bwd_inner_microstep: 922.82 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.23
[2024-11-14 15:08:04,265] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.33 | bwd: 925.37 | bwd_inner: 922.82 | bwd_allreduce: 2.53 | step: 25.23
[2024-11-14 15:08:05,538] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:08:05,538] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.21 | bwd_microstep: 925.50 | bwd_inner_microstep: 922.95 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.22
[2024-11-14 15:08:05,538] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.20 | bwd: 925.51 | bwd_inner: 922.95 | bwd_allreduce: 2.54 | step: 25.22
[2024-11-14 15:08:07,415] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:08:07,415] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 493.51 | bwd_microstep: 1356.21 | bwd_inner_microstep: 1353.32 | bwd_allreduce_microstep: 2.86 | step_microstep: 26.47
[2024-11-14 15:08:07,416] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 493.51 | bwd: 1356.22 | bwd_inner: 1353.32 | bwd_allreduce: 2.87 | step: 26.47
[2024-11-14 15:08:08,689] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:08:08,689] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.45 | bwd_microstep: 925.67 | bwd_inner_microstep: 923.09 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.39
[2024-11-14 15:08:08,689] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.44 | bwd: 925.67 | bwd_inner: 923.08 | bwd_allreduce: 2.57 | step: 25.39
[2024-11-14 15:08:09,669] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:08:09,669] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.84 | bwd_microstep: 710.96 | bwd_inner_microstep: 708.43 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.20
[2024-11-14 15:08:09,669] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.83 | bwd: 710.97 | bwd_inner: 708.43 | bwd_allreduce: 2.52 | step: 25.20
[2024-11-14 15:08:10,941] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:10,942] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.24 | bwd_microstep: 925.20 | bwd_inner_microstep: 922.61 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.33
[2024-11-14 15:08:10,942] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.23 | bwd: 925.20 | bwd_inner: 922.61 | bwd_allreduce: 2.57 | step: 25.34
[2024-11-14 15:08:12,214] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:08:12,214] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.26 | bwd_microstep: 925.38 | bwd_inner_microstep: 922.83 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.19
[2024-11-14 15:08:12,215] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.25 | bwd: 925.39 | bwd_inner: 922.83 | bwd_allreduce: 2.53 | step: 25.19
[2024-11-14 15:08:13,195] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:13,195] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.97 | bwd_microstep: 711.15 | bwd_inner_microstep: 708.59 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.29
[2024-11-14 15:08:13,195] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.96 | bwd: 711.16 | bwd_inner: 708.59 | bwd_allreduce: 2.55 | step: 25.29
[2024-11-14 15:08:14,468] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:08:14,468] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.22 | bwd_microstep: 925.67 | bwd_inner_microstep: 923.13 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.23
[2024-11-14 15:08:14,468] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.22 | bwd: 925.68 | bwd_inner: 923.13 | bwd_allreduce: 2.52 | step: 25.23
[2024-11-14 15:08:15,741] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:08:15,741] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=2, lr=[0.00018663226414014953], mom=[(0.9, 0.95)]
[2024-11-14 15:08:15,741] [INFO] [timer.py:259:stop] epoch=0/micro_step=140/global_step=140, RunningAvgSamplesPerSec=775.2640649260888, CurrSamplesPerSec=804.7770468763451, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:08:15,742] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.44 | bwd_microstep: 925.57 | bwd_inner_microstep: 922.92 | bwd_allreduce_microstep: 2.62 | step_microstep: 25.60
[2024-11-14 15:08:15,742] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.43 | bwd: 925.58 | bwd_inner: 922.92 | bwd_allreduce: 2.63 | step: 25.61
[2024-11-14 15:08:17,319] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:08:17,319] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.66 | bwd_microstep: 1145.41 | bwd_inner_microstep: 1142.56 | bwd_allreduce_microstep: 2.82 | step_microstep: 26.40
[2024-11-14 15:08:17,319] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.65 | bwd: 1145.42 | bwd_inner: 1142.56 | bwd_allreduce: 2.83 | step: 26.40
[2024-11-14 15:08:18,593] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:08:18,593] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.07 | bwd_microstep: 925.56 | bwd_inner_microstep: 922.72 | bwd_allreduce_microstep: 2.81 | step_microstep: 26.21
[2024-11-14 15:08:18,593] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.06 | bwd: 925.57 | bwd_inner: 922.72 | bwd_allreduce: 2.83 | step: 26.21
[2024-11-14 15:08:20,170] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:08:20,170] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.49 | bwd_microstep: 1145.52 | bwd_inner_microstep: 1142.71 | bwd_allreduce_microstep: 2.78 | step_microstep: 26.19
[2024-11-14 15:08:20,170] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.49 | bwd: 1145.53 | bwd_inner: 1142.71 | bwd_allreduce: 2.79 | step: 26.19
[2024-11-14 15:08:21,444] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:08:21,444] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.16 | bwd_microstep: 925.66 | bwd_inner_microstep: 922.86 | bwd_allreduce_microstep: 2.77 | step_microstep: 26.11
[2024-11-14 15:08:21,444] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.15 | bwd: 925.67 | bwd_inner: 922.86 | bwd_allreduce: 2.79 | step: 26.11
[2024-11-14 15:08:22,717] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:08:22,717] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.30 | bwd_microstep: 925.55 | bwd_inner_microstep: 922.75 | bwd_allreduce_microstep: 2.77 | step_microstep: 25.54
[2024-11-14 15:08:22,718] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.29 | bwd: 925.56 | bwd_inner: 922.75 | bwd_allreduce: 2.79 | step: 25.54
[2024-11-14 15:08:23,991] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:08:23,991] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.48 | bwd_microstep: 925.64 | bwd_inner_microstep: 923.09 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:08:23,991] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.47 | bwd: 925.65 | bwd_inner: 923.09 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:08:25,264] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:08:25,265] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.51 | bwd_microstep: 925.69 | bwd_inner_microstep: 923.15 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.28
[2024-11-14 15:08:25,265] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.51 | bwd: 925.69 | bwd_inner: 923.15 | bwd_allreduce: 2.52 | step: 25.29
[2024-11-14 15:08:26,537] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:08:26,538] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.32 | bwd_microstep: 925.43 | bwd_inner_microstep: 922.86 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.37
[2024-11-14 15:08:26,538] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.31 | bwd: 925.44 | bwd_inner: 922.86 | bwd_allreduce: 2.55 | step: 25.37
[2024-11-14 15:08:27,811] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:08:27,811] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.32 | bwd_microstep: 925.82 | bwd_inner_microstep: 923.24 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.24
[2024-11-14 15:08:27,811] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.31 | bwd: 925.83 | bwd_inner: 923.24 | bwd_allreduce: 2.57 | step: 25.24
[2024-11-14 15:08:29,084] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:08:29,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=2, lr=[0.00018885617482746785], mom=[(0.9, 0.95)]
[2024-11-14 15:08:29,084] [INFO] [timer.py:259:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=774.7727694660124, CurrSamplesPerSec=804.8922719080351, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:08:29,084] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.30 | bwd_microstep: 925.52 | bwd_inner_microstep: 922.95 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.63
[2024-11-14 15:08:29,084] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.29 | bwd: 925.53 | bwd_inner: 922.95 | bwd_allreduce: 2.55 | step: 25.63
[2024-11-14 15:08:30,661] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:08:30,661] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.59 | bwd_microstep: 1145.44 | bwd_inner_microstep: 1142.61 | bwd_allreduce_microstep: 2.80 | step_microstep: 25.97
[2024-11-14 15:08:30,662] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.58 | bwd: 1145.45 | bwd_inner: 1142.61 | bwd_allreduce: 2.81 | step: 25.97
[2024-11-14 15:08:31,934] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.53
[2024-11-14 15:08:31,935] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.22 | bwd_microstep: 925.57 | bwd_inner_microstep: 923.01 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.35
[2024-11-14 15:08:31,935] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.21 | bwd: 925.58 | bwd_inner: 923.02 | bwd_allreduce: 2.54 | step: 25.35
[2024-11-14 15:08:32,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:32,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.96 | bwd_microstep: 711.06 | bwd_inner_microstep: 708.53 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.21
[2024-11-14 15:08:32,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.95 | bwd: 711.06 | bwd_inner: 708.53 | bwd_allreduce: 2.52 | step: 25.21
[2024-11-14 15:08:34,491] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:08:34,491] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.51 | bwd_microstep: 1145.33 | bwd_inner_microstep: 1142.75 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.36
[2024-11-14 15:08:34,491] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.50 | bwd: 1145.33 | bwd_inner: 1142.75 | bwd_allreduce: 2.56 | step: 25.36
[2024-11-14 15:08:35,765] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:08:35,765] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.17 | bwd_microstep: 925.52 | bwd_inner_microstep: 922.70 | bwd_allreduce_microstep: 2.79 | step_microstep: 26.35
[2024-11-14 15:08:35,765] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.15 | bwd: 925.54 | bwd_inner: 922.70 | bwd_allreduce: 2.80 | step: 26.35
[2024-11-14 15:08:37,038] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.48
[2024-11-14 15:08:37,038] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.35 | bwd_microstep: 925.43 | bwd_inner_microstep: 922.89 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.25
[2024-11-14 15:08:37,038] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.35 | bwd: 925.44 | bwd_inner: 922.89 | bwd_allreduce: 2.52 | step: 25.25
[2024-11-14 15:08:38,312] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:38,312] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.58 | bwd_microstep: 925.63 | bwd_inner_microstep: 923.08 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.32
[2024-11-14 15:08:38,312] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.56 | bwd: 925.64 | bwd_inner: 923.08 | bwd_allreduce: 2.54 | step: 25.32
[2024-11-14 15:08:39,585] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:39,585] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.29 | bwd_microstep: 925.41 | bwd_inner_microstep: 922.87 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.27
[2024-11-14 15:08:39,585] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.27 | bwd: 925.41 | bwd_inner: 922.87 | bwd_allreduce: 2.52 | step: 25.27
[2024-11-14 15:08:40,857] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:40,857] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.16 | bwd_microstep: 925.19 | bwd_inner_microstep: 922.64 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.30
[2024-11-14 15:08:40,858] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.16 | bwd: 925.19 | bwd_inner: 922.64 | bwd_allreduce: 2.53 | step: 25.30
[2024-11-14 15:08:42,131] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:42,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=2, lr=[0.00019093462466452835], mom=[(0.9, 0.95)]
[2024-11-14 15:08:42,131] [INFO] [timer.py:259:stop] epoch=0/micro_step=160/global_step=160, RunningAvgSamplesPerSec=775.4429439938563, CurrSamplesPerSec=804.6253741739079, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:08:42,131] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.46 | bwd_microstep: 925.83 | bwd_inner_microstep: 923.29 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.58
[2024-11-14 15:08:42,131] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.46 | bwd: 925.83 | bwd_inner: 923.29 | bwd_allreduce: 2.52 | step: 25.58
[2024-11-14 15:08:43,404] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:08:43,404] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.32 | bwd_microstep: 925.46 | bwd_inner_microstep: 922.91 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:08:43,404] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.31 | bwd: 925.46 | bwd_inner: 922.91 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:08:44,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:44,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.57 | bwd_microstep: 925.86 | bwd_inner_microstep: 923.32 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.24
[2024-11-14 15:08:44,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.57 | bwd: 925.87 | bwd_inner: 923.32 | bwd_allreduce: 2.52 | step: 25.24
[2024-11-14 15:08:45,951] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:08:45,951] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.38 | bwd_microstep: 925.39 | bwd_inner_microstep: 922.86 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.26
[2024-11-14 15:08:45,951] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.38 | bwd: 925.40 | bwd_inner: 922.86 | bwd_allreduce: 2.52 | step: 25.26
[2024-11-14 15:08:46,930] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:46,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.68 | bwd_microstep: 710.78 | bwd_inner_microstep: 708.24 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.27
[2024-11-14 15:08:46,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.67 | bwd: 710.79 | bwd_inner: 708.24 | bwd_allreduce: 2.52 | step: 25.27
[2024-11-14 15:08:48,506] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:08:48,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.52 | bwd_microstep: 1145.24 | bwd_inner_microstep: 1142.45 | bwd_allreduce_microstep: 2.77 | step_microstep: 25.25
[2024-11-14 15:08:48,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.51 | bwd: 1145.25 | bwd_inner: 1142.45 | bwd_allreduce: 2.78 | step: 25.25
[2024-11-14 15:08:49,797] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.85 | optimizer_step: 9.51
[2024-11-14 15:08:49,798] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.52 | bwd_microstep: 926.15 | bwd_inner_microstep: 923.32 | bwd_allreduce_microstep: 2.80 | step_microstep: 42.38
[2024-11-14 15:08:49,798] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.52 | bwd: 926.15 | bwd_inner: 923.32 | bwd_allreduce: 2.81 | step: 42.38
[2024-11-14 15:08:51,070] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:08:51,071] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.30 | bwd_microstep: 925.28 | bwd_inner_microstep: 922.66 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.46
[2024-11-14 15:08:51,071] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.29 | bwd: 925.29 | bwd_inner: 922.66 | bwd_allreduce: 2.60 | step: 25.46
[2024-11-14 15:08:52,344] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.50
[2024-11-14 15:08:52,344] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.39 | bwd_microstep: 925.45 | bwd_inner_microstep: 922.88 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.25
[2024-11-14 15:08:52,344] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.38 | bwd: 925.46 | bwd_inner: 922.88 | bwd_allreduce: 2.55 | step: 25.25
[2024-11-14 15:08:53,617] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:08:53,617] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.44 | bwd_microstep: 925.82 | bwd_inner_microstep: 923.27 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.24
[2024-11-14 15:08:53,618] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.43 | bwd: 925.83 | bwd_inner: 923.27 | bwd_allreduce: 2.54 | step: 25.24
[2024-11-14 15:08:54,891] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:54,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=2, lr=[0.00019288547956931442], mom=[(0.9, 0.95)]
[2024-11-14 15:08:54,891] [INFO] [timer.py:259:stop] epoch=0/micro_step=170/global_step=170, RunningAvgSamplesPerSec=777.0385058755165, CurrSamplesPerSec=804.5598077566549, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:08:54,892] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.57 | bwd_microstep: 925.84 | bwd_inner_microstep: 923.30 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.56
[2024-11-14 15:08:54,892] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.56 | bwd: 925.85 | bwd_inner: 923.30 | bwd_allreduce: 2.53 | step: 25.56
[2024-11-14 15:08:56,165] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:56,166] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.69 | bwd_microstep: 925.95 | bwd_inner_microstep: 923.41 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:08:56,166] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.68 | bwd: 925.96 | bwd_inner: 923.41 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:08:57,438] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:08:57,439] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.18 | bwd_microstep: 925.28 | bwd_inner_microstep: 922.74 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.70
[2024-11-14 15:08:57,439] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.17 | bwd: 925.29 | bwd_inner: 922.74 | bwd_allreduce: 2.53 | step: 25.71
[2024-11-14 15:08:58,712] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:08:58,712] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.40 | bwd_microstep: 925.74 | bwd_inner_microstep: 923.13 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.31
[2024-11-14 15:08:58,713] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.39 | bwd: 925.75 | bwd_inner: 923.13 | bwd_allreduce: 2.59 | step: 25.31
[2024-11-14 15:09:00,291] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:00,291] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.64 | bwd_microstep: 1146.53 | bwd_inner_microstep: 1143.68 | bwd_allreduce_microstep: 2.81 | step_microstep: 25.96
[2024-11-14 15:09:00,291] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.63 | bwd: 1146.54 | bwd_inner: 1143.68 | bwd_allreduce: 2.83 | step: 25.96
[2024-11-14 15:09:01,565] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:01,565] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.07 | bwd_microstep: 925.53 | bwd_inner_microstep: 922.75 | bwd_allreduce_microstep: 2.74 | step_microstep: 26.12
[2024-11-14 15:09:01,565] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.06 | bwd: 925.53 | bwd_inner: 922.75 | bwd_allreduce: 2.75 | step: 26.12
[2024-11-14 15:09:02,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:02,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.57 | bwd_microstep: 926.02 | bwd_inner_microstep: 923.21 | bwd_allreduce_microstep: 2.78 | step_microstep: 25.28
[2024-11-14 15:09:02,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.56 | bwd: 926.03 | bwd_inner: 923.21 | bwd_allreduce: 2.79 | step: 25.28
[2024-11-14 15:09:04,112] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:09:04,112] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.50 | bwd_microstep: 925.78 | bwd_inner_microstep: 923.24 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.25
[2024-11-14 15:09:04,112] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.49 | bwd: 925.79 | bwd_inner: 923.24 | bwd_allreduce: 2.52 | step: 25.25
[2024-11-14 15:09:05,385] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:05,385] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.27 | bwd_microstep: 925.38 | bwd_inner_microstep: 922.84 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.24
[2024-11-14 15:09:05,385] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.26 | bwd: 925.39 | bwd_inner: 922.84 | bwd_allreduce: 2.52 | step: 25.24
[2024-11-14 15:09:06,659] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:06,660] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.69 | bwd_microstep: 926.09 | bwd_inner_microstep: 923.51 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.31
[2024-11-14 15:09:06,660] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.68 | bwd: 926.10 | bwd_inner: 923.51 | bwd_allreduce: 2.56 | step: 25.31
[2024-11-14 15:09:07,933] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:09:07,933] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=2, lr=[0.00019472350352314695], mom=[(0.9, 0.95)]
[2024-11-14 15:09:07,934] [INFO] [timer.py:259:stop] epoch=0/micro_step=180/global_step=180, RunningAvgSamplesPerSec=777.5289344171363, CurrSamplesPerSec=804.633815684509, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:09:07,934] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.54 | bwd_microstep: 925.73 | bwd_inner_microstep: 923.16 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.58
[2024-11-14 15:09:07,934] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.53 | bwd: 925.74 | bwd_inner: 923.16 | bwd_allreduce: 2.56 | step: 25.59
[2024-11-14 15:09:09,207] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:09:09,207] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.51 | bwd_microstep: 925.71 | bwd_inner_microstep: 923.11 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.30
[2024-11-14 15:09:09,207] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.50 | bwd: 925.72 | bwd_inner: 923.11 | bwd_allreduce: 2.59 | step: 25.30
[2024-11-14 15:09:10,481] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:10,482] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.48 | bwd_microstep: 926.01 | bwd_inner_microstep: 923.47 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.70
[2024-11-14 15:09:10,482] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.47 | bwd: 926.01 | bwd_inner: 923.46 | bwd_allreduce: 2.52 | step: 25.70
[2024-11-14 15:09:11,461] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:11,462] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 242.72 | bwd_microstep: 710.68 | bwd_inner_microstep: 708.15 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.66
[2024-11-14 15:09:11,462] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 242.71 | bwd: 710.69 | bwd_inner: 708.15 | bwd_allreduce: 2.52 | step: 25.66
[2024-11-14 15:09:12,736] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:09:12,736] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.57 | bwd_microstep: 926.49 | bwd_inner_microstep: 923.31 | bwd_allreduce_microstep: 3.14 | step_microstep: 25.42
[2024-11-14 15:09:12,736] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.56 | bwd: 926.50 | bwd_inner: 923.31 | bwd_allreduce: 3.15 | step: 25.42
[2024-11-14 15:09:14,313] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:09:14,313] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.75 | bwd_microstep: 1145.38 | bwd_inner_microstep: 1142.80 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.49
[2024-11-14 15:09:14,313] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.75 | bwd: 1145.39 | bwd_inner: 1142.80 | bwd_allreduce: 2.57 | step: 25.50
[2024-11-14 15:09:15,889] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:09:15,889] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.56 | bwd_microstep: 1144.78 | bwd_inner_microstep: 1142.20 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.42
[2024-11-14 15:09:15,889] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.55 | bwd: 1144.79 | bwd_inner: 1142.20 | bwd_allreduce: 2.56 | step: 25.42
[2024-11-14 15:09:18,065] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:09:18,065] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 577.15 | bwd_microstep: 1572.75 | bwd_inner_microstep: 1570.19 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.25
[2024-11-14 15:09:18,065] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 577.15 | bwd: 1572.76 | bwd_inner: 1570.19 | bwd_allreduce: 2.54 | step: 25.25
[2024-11-14 15:09:19,338] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:19,338] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.07 | bwd_microstep: 925.27 | bwd_inner_microstep: 922.74 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.21
[2024-11-14 15:09:19,338] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.06 | bwd: 925.28 | bwd_inner: 922.74 | bwd_allreduce: 2.52 | step: 25.21
[2024-11-14 15:09:20,611] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:20,612] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.58 | bwd_microstep: 925.85 | bwd_inner_microstep: 923.28 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.37
[2024-11-14 15:09:20,612] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.57 | bwd: 925.86 | bwd_inner: 923.28 | bwd_allreduce: 2.56 | step: 25.37
[2024-11-14 15:09:21,885] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.50
[2024-11-14 15:09:21,886] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=2, lr=[0.0001964610375445638], mom=[(0.9, 0.95)]
[2024-11-14 15:09:21,886] [INFO] [timer.py:259:stop] epoch=0/micro_step=190/global_step=190, RunningAvgSamplesPerSec=775.1146633838555, CurrSamplesPerSec=804.3547367699783, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:09:21,886] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.83 | bwd_microstep: 926.00 | bwd_inner_microstep: 923.47 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.45
[2024-11-14 15:09:21,886] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.82 | bwd: 926.01 | bwd_inner: 923.46 | bwd_allreduce: 2.52 | step: 25.46
[2024-11-14 15:09:23,159] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:09:23,159] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.51 | bwd_microstep: 925.57 | bwd_inner_microstep: 923.03 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.24
[2024-11-14 15:09:23,159] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.50 | bwd: 925.58 | bwd_inner: 923.03 | bwd_allreduce: 2.53 | step: 25.24
[2024-11-14 15:09:24,433] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:24,434] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.52 | bwd_microstep: 926.11 | bwd_inner_microstep: 923.53 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.76
[2024-11-14 15:09:24,434] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.51 | bwd: 926.11 | bwd_inner: 923.53 | bwd_allreduce: 2.55 | step: 25.76
[2024-11-14 15:09:25,707] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:25,707] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.50 | bwd_microstep: 925.57 | bwd_inner_microstep: 922.92 | bwd_allreduce_microstep: 2.62 | step_microstep: 25.29
[2024-11-14 15:09:25,707] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.49 | bwd: 925.58 | bwd_inner: 922.92 | bwd_allreduce: 2.63 | step: 25.29
[2024-11-14 15:09:26,687] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:09:26,688] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.15 | bwd_microstep: 711.25 | bwd_inner_microstep: 708.68 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.37
[2024-11-14 15:09:26,688] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.14 | bwd: 711.25 | bwd_inner: 708.68 | bwd_allreduce: 2.55 | step: 25.37
[2024-11-14 15:09:27,960] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:09:27,960] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.19 | bwd_microstep: 925.15 | bwd_inner_microstep: 922.62 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.28
[2024-11-14 15:09:27,960] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.18 | bwd: 925.16 | bwd_inner: 922.62 | bwd_allreduce: 2.52 | step: 25.28
[2024-11-14 15:09:29,233] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:29,233] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.48 | bwd_microstep: 925.51 | bwd_inner_microstep: 922.99 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.25
[2024-11-14 15:09:29,234] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.47 | bwd: 925.52 | bwd_inner: 922.99 | bwd_allreduce: 2.51 | step: 25.25
[2024-11-14 15:09:30,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:09:30,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.41 | bwd_microstep: 925.71 | bwd_inner_microstep: 923.12 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.36
[2024-11-14 15:09:30,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.40 | bwd: 925.71 | bwd_inner: 923.12 | bwd_allreduce: 2.57 | step: 25.36
[2024-11-14 15:09:31,782] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:31,782] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.67 | bwd_microstep: 927.15 | bwd_inner_microstep: 924.60 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.31
[2024-11-14 15:09:31,782] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.66 | bwd: 927.15 | bwd_inner: 924.60 | bwd_allreduce: 2.53 | step: 25.31
[2024-11-14 15:09:33,057] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:09:33,057] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.86 | bwd_microstep: 927.24 | bwd_inner_microstep: 924.48 | bwd_allreduce_microstep: 2.73 | step_microstep: 25.27
[2024-11-14 15:09:33,057] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.85 | bwd: 927.25 | bwd_inner: 924.48 | bwd_allreduce: 2.74 | step: 25.27
[2024-11-14 15:09:34,332] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:09:34,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=2, lr=[0.0001981085024890419], mom=[(0.9, 0.95)]
[2024-11-14 15:09:34,332] [INFO] [timer.py:259:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=777.4168307289118, CurrSamplesPerSec=803.919025697963, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:09:34,332] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.57 | bwd_microstep: 926.78 | bwd_inner_microstep: 924.20 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.62
[2024-11-14 15:09:34,332] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.57 | bwd: 926.79 | bwd_inner: 924.20 | bwd_allreduce: 2.56 | step: 25.62
[2024-11-14 15:09:35,911] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:09:35,911] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.39 | bwd_microstep: 1146.86 | bwd_inner_microstep: 1144.25 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.63
[2024-11-14 15:09:35,911] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.38 | bwd: 1146.86 | bwd_inner: 1144.25 | bwd_allreduce: 2.59 | step: 25.64
[2024-11-14 15:09:35.911705][epoch 0][local 0: 200][global 200] train_loss: 0.6915601, 636.3 samples / 12726 tokens per sec
[2024-11-14 15:09:37,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:09:37,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.80 | bwd_microstep: 927.39 | bwd_inner_microstep: 924.48 | bwd_allreduce_microstep: 2.88 | step_microstep: 26.20
[2024-11-14 15:09:37,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.79 | bwd: 927.40 | bwd_inner: 924.48 | bwd_allreduce: 2.90 | step: 26.21
[2024-11-14 15:09:38,767] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:09:38,767] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.97 | bwd_microstep: 1147.18 | bwd_inner_microstep: 1144.34 | bwd_allreduce_microstep: 2.81 | step_microstep: 26.30
[2024-11-14 15:09:38,767] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.96 | bwd: 1147.19 | bwd_inner: 1144.34 | bwd_allreduce: 2.82 | step: 26.30
[2024-11-14 15:09:40,042] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:09:40,043] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.45 | bwd_microstep: 926.92 | bwd_inner_microstep: 924.05 | bwd_allreduce_microstep: 2.84 | step_microstep: 25.96
[2024-11-14 15:09:40,045] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.44 | bwd: 926.93 | bwd_inner: 924.05 | bwd_allreduce: 2.86 | step: 25.96
[2024-11-14 15:09:41,319] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:41,320] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.83 | bwd_microstep: 926.88 | bwd_inner_microstep: 924.32 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.33
[2024-11-14 15:09:41,320] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.82 | bwd: 926.88 | bwd_inner: 924.32 | bwd_allreduce: 2.54 | step: 25.33
[2024-11-14 15:09:42,594] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:09:42,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.72 | bwd_microstep: 926.92 | bwd_inner_microstep: 924.33 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.46
[2024-11-14 15:09:42,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.71 | bwd: 926.93 | bwd_inner: 924.33 | bwd_allreduce: 2.58 | step: 25.46
[2024-11-14 15:09:43,870] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:09:43,870] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.92 | bwd_microstep: 926.81 | bwd_inner_microstep: 924.23 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.47
[2024-11-14 15:09:43,870] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.91 | bwd: 926.82 | bwd_inner: 924.23 | bwd_allreduce: 2.56 | step: 25.47
[2024-11-14 15:09:45,144] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:45,145] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.73 | bwd_microstep: 926.61 | bwd_inner_microstep: 924.07 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:09:45,145] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.72 | bwd: 926.62 | bwd_inner: 924.07 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:09:46,419] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:09:46,420] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.78 | bwd_microstep: 927.20 | bwd_inner_microstep: 924.62 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.30
[2024-11-14 15:09:46,420] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.77 | bwd: 927.20 | bwd_inner: 924.62 | bwd_allreduce: 2.56 | step: 25.30
[2024-11-14 15:09:47,694] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:09:47,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=210, skipped=2, lr=[0.00019967477783340673], mom=[(0.9, 0.95)]
[2024-11-14 15:09:47,695] [INFO] [timer.py:259:stop] epoch=0/micro_step=210/global_step=210, RunningAvgSamplesPerSec=776.9117085325524, CurrSamplesPerSec=803.898110197845, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:09:47,695] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.72 | bwd_microstep: 926.77 | bwd_inner_microstep: 924.21 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.52
[2024-11-14 15:09:47,695] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.72 | bwd: 926.78 | bwd_inner: 924.21 | bwd_allreduce: 2.54 | step: 25.52
[2024-11-14 15:09:48,970] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:48,970] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 927.20 | bwd_inner_microstep: 924.64 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:09:48,970] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 927.20 | bwd_inner: 924.64 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:09:50,245] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:09:50,245] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.96 | bwd_microstep: 926.84 | bwd_inner_microstep: 924.25 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.37
[2024-11-14 15:09:50,245] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.95 | bwd: 926.84 | bwd_inner: 924.25 | bwd_allreduce: 2.57 | step: 25.37
[2024-11-14 15:09:51,521] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:51,521] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.91 | bwd_microstep: 927.44 | bwd_inner_microstep: 924.91 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.31
[2024-11-14 15:09:51,521] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.90 | bwd: 927.45 | bwd_inner: 924.91 | bwd_allreduce: 2.51 | step: 25.32
[2024-11-14 15:09:52,502] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:09:52,503] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.03 | bwd_microstep: 711.90 | bwd_inner_microstep: 709.29 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.65
[2024-11-14 15:09:52,503] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.02 | bwd: 711.91 | bwd_inner: 709.29 | bwd_allreduce: 2.59 | step: 25.65
[2024-11-14 15:09:53,779] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:09:53,779] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 928.05 | bwd_inner_microstep: 925.49 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.21
[2024-11-14 15:09:53,779] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 928.05 | bwd_inner: 925.49 | bwd_allreduce: 2.53 | step: 25.21
[2024-11-14 15:09:55,055] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:09:55,055] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.01 | bwd_microstep: 927.45 | bwd_inner_microstep: 924.90 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:09:55,055] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 927.46 | bwd_inner: 924.90 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:09:56,330] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:09:56,330] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.86 | bwd_microstep: 927.18 | bwd_inner_microstep: 924.60 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.31
[2024-11-14 15:09:56,330] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.85 | bwd: 927.19 | bwd_inner: 924.60 | bwd_allreduce: 2.56 | step: 25.31
[2024-11-14 15:09:57,606] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:57,606] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.65 | bwd_inner_microstep: 925.11 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.23
[2024-11-14 15:09:57,606] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 927.65 | bwd_inner: 925.11 | bwd_allreduce: 2.52 | step: 25.24
[2024-11-14 15:09:58,881] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:09:58,881] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.88 | bwd_microstep: 927.03 | bwd_inner_microstep: 924.50 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.23
[2024-11-14 15:09:58,881] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.87 | bwd: 927.04 | bwd_inner: 924.50 | bwd_allreduce: 2.52 | step: 25.24
[2024-11-14 15:10:00,158] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:10:00,158] [INFO] [logging.py:96:log_dist] [Rank 0] step=220, skipped=2, lr=[0.00020116749143173117], mom=[(0.9, 0.95)]
[2024-11-14 15:10:00,158] [INFO] [timer.py:259:stop] epoch=0/micro_step=220/global_step=220, RunningAvgSamplesPerSec=778.882258378747, CurrSamplesPerSec=802.6613688816338, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:10:00,158] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 928.49 | bwd_inner_microstep: 925.94 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.50
[2024-11-14 15:10:00,158] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.97 | bwd: 928.50 | bwd_inner: 925.94 | bwd_allreduce: 2.54 | step: 25.50
[2024-11-14 15:10:01,434] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:10:01,434] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.35 | bwd_microstep: 927.60 | bwd_inner_microstep: 925.08 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.23
[2024-11-14 15:10:01,434] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.34 | bwd: 927.61 | bwd_inner: 925.08 | bwd_allreduce: 2.51 | step: 25.23
[2024-11-14 15:10:02,710] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:10:02,710] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 927.52 | bwd_inner_microstep: 924.93 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.49
[2024-11-14 15:10:02,710] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.11 | bwd: 927.53 | bwd_inner: 924.93 | bwd_allreduce: 2.57 | step: 25.49
[2024-11-14 15:10:04,292] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:10:04,292] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.26 | bwd_microstep: 1147.33 | bwd_inner_microstep: 1144.52 | bwd_allreduce_microstep: 2.78 | step_microstep: 27.79
[2024-11-14 15:10:04,292] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.25 | bwd: 1147.33 | bwd_inner: 1144.52 | bwd_allreduce: 2.79 | step: 27.79
[2024-11-14 15:10:05,569] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:10:05,569] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.77 | bwd_microstep: 926.94 | bwd_inner_microstep: 924.22 | bwd_allreduce_microstep: 2.69 | step_microstep: 27.80
[2024-11-14 15:10:05,569] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.76 | bwd: 926.94 | bwd_inner: 924.22 | bwd_allreduce: 2.70 | step: 27.80
[2024-11-14 15:10:06,845] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:10:06,845] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.96 | bwd_microstep: 927.53 | bwd_inner_microstep: 924.87 | bwd_allreduce_microstep: 2.63 | step_microstep: 25.67
[2024-11-14 15:10:06,846] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.95 | bwd: 927.54 | bwd_inner: 924.87 | bwd_allreduce: 2.64 | step: 25.68
[2024-11-14 15:10:08,425] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:10:08,425] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.14 | bwd_microstep: 1146.67 | bwd_inner_microstep: 1143.85 | bwd_allreduce_microstep: 2.79 | step_microstep: 26.23
[2024-11-14 15:10:08,425] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.13 | bwd: 1146.68 | bwd_inner: 1143.85 | bwd_allreduce: 2.81 | step: 26.23
[2024-11-14 15:10:09,406] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.50
[2024-11-14 15:10:09,406] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.23 | bwd_microstep: 711.73 | bwd_inner_microstep: 709.20 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.26
[2024-11-14 15:10:09,406] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.22 | bwd: 711.74 | bwd_inner: 709.20 | bwd_allreduce: 2.51 | step: 25.27
[2024-11-14 15:10:10,681] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:10:10,681] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.90 | bwd_microstep: 926.78 | bwd_inner_microstep: 924.23 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:10:10,681] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.89 | bwd: 926.79 | bwd_inner: 924.23 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:10:12,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:10:12,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.01 | bwd_microstep: 1146.54 | bwd_inner_microstep: 1143.65 | bwd_allreduce_microstep: 2.86 | step_microstep: 26.00
[2024-11-14 15:10:12,260] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.00 | bwd: 1146.55 | bwd_inner: 1143.65 | bwd_allreduce: 2.87 | step: 26.00
[2024-11-14 15:10:13,536] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:10:13,536] [INFO] [logging.py:96:log_dist] [Rank 0] step=230, skipped=2, lr=[0.00020259324422940196], mom=[(0.9, 0.95)]
[2024-11-14 15:10:13,536] [INFO] [timer.py:259:stop] epoch=0/micro_step=230/global_step=230, RunningAvgSamplesPerSec=778.3103805830831, CurrSamplesPerSec=802.9166080112607, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:10:13,536] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.90 | bwd_microstep: 927.25 | bwd_inner_microstep: 924.37 | bwd_allreduce_microstep: 2.86 | step_microstep: 26.44
[2024-11-14 15:10:13,536] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.88 | bwd: 927.26 | bwd_inner: 924.36 | bwd_allreduce: 2.87 | step: 26.45
[2024-11-14 15:10:14,811] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:10:14,811] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.73 | bwd_microstep: 926.78 | bwd_inner_microstep: 924.13 | bwd_allreduce_microstep: 2.62 | step_microstep: 25.43
[2024-11-14 15:10:14,811] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.72 | bwd: 926.79 | bwd_inner: 924.13 | bwd_allreduce: 2.63 | step: 25.43
[2024-11-14 15:10:16,086] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:10:16,086] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.80 | bwd_microstep: 926.67 | bwd_inner_microstep: 924.12 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:10:16,086] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.79 | bwd: 926.67 | bwd_inner: 924.12 | bwd_allreduce: 2.53 | step: 25.29
[2024-11-14 15:10:17,361] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:10:17,361] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.25 | bwd_microstep: 927.05 | bwd_inner_microstep: 924.49 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:10:17,361] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.24 | bwd: 927.06 | bwd_inner: 924.49 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:10:18,342] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:10:18,342] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.11 | bwd_microstep: 711.71 | bwd_inner_microstep: 709.14 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.37
[2024-11-14 15:10:18,342] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.10 | bwd: 711.71 | bwd_inner: 709.14 | bwd_allreduce: 2.56 | step: 25.38
[2024-11-14 15:10:19,323] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.50
[2024-11-14 15:10:19,323] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.23 | bwd_microstep: 711.83 | bwd_inner_microstep: 709.29 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.24
[2024-11-14 15:10:19,324] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.22 | bwd: 711.83 | bwd_inner: 709.29 | bwd_allreduce: 2.52 | step: 25.25
[2024-11-14 15:10:20,901] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:10:20,901] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.14 | bwd_microstep: 1146.45 | bwd_inner_microstep: 1143.88 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.32
[2024-11-14 15:10:20,901] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.13 | bwd: 1146.45 | bwd_inner: 1143.88 | bwd_allreduce: 2.55 | step: 25.32
[2024-11-14 15:10:22,178] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:10:22,178] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.89 | bwd_microstep: 927.43 | bwd_inner_microstep: 924.63 | bwd_allreduce_microstep: 2.77 | step_microstep: 26.47
[2024-11-14 15:10:22,178] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.88 | bwd: 927.43 | bwd_inner: 924.63 | bwd_allreduce: 2.78 | step: 26.47
[2024-11-14 15:10:23,453] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:10:23,453] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.02 | bwd_microstep: 926.70 | bwd_inner_microstep: 924.12 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.35
[2024-11-14 15:10:23,453] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.01 | bwd: 926.71 | bwd_inner: 924.12 | bwd_allreduce: 2.57 | step: 25.36
[2024-11-14 15:10:24,434] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:10:24,434] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.28 | bwd_microstep: 711.75 | bwd_inner_microstep: 709.21 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.31
[2024-11-14 15:10:24,435] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.27 | bwd: 711.76 | bwd_inner: 709.21 | bwd_allreduce: 2.52 | step: 25.31
[2024-11-14 15:10:25,709] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:10:25,709] [INFO] [logging.py:96:log_dist] [Rank 0] step=240, skipped=2, lr=[0.00020395778670518312], mom=[(0.9, 0.95)]
[2024-11-14 15:10:25,709] [INFO] [timer.py:259:stop] epoch=0/micro_step=240/global_step=240, RunningAvgSamplesPerSec=780.7871891807762, CurrSamplesPerSec=803.9915612589582, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:10:25,709] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.70 | bwd_microstep: 926.63 | bwd_inner_microstep: 924.04 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.53
[2024-11-14 15:10:25,709] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.70 | bwd: 926.64 | bwd_inner: 924.04 | bwd_allreduce: 2.57 | step: 25.53
[2024-11-14 15:10:26,985] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:10:26,985] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.05 | bwd_microstep: 927.09 | bwd_inner_microstep: 924.50 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.70
[2024-11-14 15:10:26,985] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.04 | bwd: 927.09 | bwd_inner: 924.50 | bwd_allreduce: 2.57 | step: 25.70
[2024-11-14 15:10:28,260] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:10:28,261] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 926.97 | bwd_inner_microstep: 924.42 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:10:28,261] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 926.98 | bwd_inner: 924.42 | bwd_allreduce: 2.54 | step: 25.30
[2024-11-14 15:10:29,536] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:10:29,537] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 927.34 | bwd_inner_microstep: 924.77 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.51
[2024-11-14 15:10:29,537] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.07 | bwd: 927.35 | bwd_inner: 924.76 | bwd_allreduce: 2.56 | step: 25.51
[2024-11-14 15:10:30,812] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:10:30,812] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.22 | bwd_microstep: 926.99 | bwd_inner_microstep: 924.44 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.20
[2024-11-14 15:10:30,812] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.21 | bwd: 927.00 | bwd_inner: 924.44 | bwd_allreduce: 2.54 | step: 25.20
[2024-11-14 15:10:32,086] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:10:32,087] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.82 | bwd_microstep: 926.66 | bwd_inner_microstep: 924.11 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:10:32,087] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.81 | bwd: 926.67 | bwd_inner: 924.11 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:10:33,068] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:10:33,068] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.43 | bwd_microstep: 712.09 | bwd_inner_microstep: 709.37 | bwd_allreduce_microstep: 2.69 | step_microstep: 25.31
[2024-11-14 15:10:33,068] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.42 | bwd: 712.09 | bwd_inner: 709.37 | bwd_allreduce: 2.70 | step: 25.31
[2024-11-14 15:10:34,344] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:10:34,344] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.25 | bwd_microstep: 927.19 | bwd_inner_microstep: 924.65 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.33
[2024-11-14 15:10:34,344] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.20 | bwd_inner: 924.65 | bwd_allreduce: 2.53 | step: 25.33
[2024-11-14 15:10:36,224] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:10:36,224] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.56 | bwd_microstep: 1358.26 | bwd_inner_microstep: 1355.41 | bwd_allreduce_microstep: 2.81 | step_microstep: 25.85
[2024-11-14 15:10:36,224] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.55 | bwd: 1358.26 | bwd_inner: 1355.41 | bwd_allreduce: 2.83 | step: 25.85
[2024-11-14 15:10:37,499] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:10:37,499] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.01 | bwd_microstep: 927.07 | bwd_inner_microstep: 924.51 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:10:37,499] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 927.07 | bwd_inner: 924.51 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:10:38,480] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:10:38,480] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=2, lr=[0.0002052661589738411], mom=[(0.9, 0.95)]
[2024-11-14 15:10:38,481] [INFO] [timer.py:259:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=781.6374461179661, CurrSamplesPerSec=1044.4382309297307, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:10:38,481] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.16 | bwd_microstep: 711.94 | bwd_inner_microstep: 709.36 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.56
[2024-11-14 15:10:38,481] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.15 | bwd: 711.95 | bwd_inner: 709.36 | bwd_allreduce: 2.56 | step: 25.56
[2024-11-14 15:10:39,756] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:10:39,757] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.19 | bwd_microstep: 927.31 | bwd_inner_microstep: 924.76 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.33
[2024-11-14 15:10:39,757] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.18 | bwd: 927.31 | bwd_inner: 924.76 | bwd_allreduce: 2.53 | step: 25.33
[2024-11-14 15:10:41,637] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:10:41,637] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.64 | bwd_microstep: 1358.48 | bwd_inner_microstep: 1355.57 | bwd_allreduce_microstep: 2.88 | step_microstep: 25.98
[2024-11-14 15:10:41,637] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.63 | bwd: 1358.49 | bwd_inner: 1355.57 | bwd_allreduce: 2.89 | step: 25.98
[2024-11-14 15:10:42,912] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:10:42,912] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.01 | bwd_microstep: 927.19 | bwd_inner_microstep: 924.57 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.29
[2024-11-14 15:10:42,913] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 927.20 | bwd_inner: 924.57 | bwd_allreduce: 2.60 | step: 25.29
[2024-11-14 15:10:44,187] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:10:44,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.95 | bwd_microstep: 926.77 | bwd_inner_microstep: 924.18 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.26
[2024-11-14 15:10:44,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.94 | bwd: 926.78 | bwd_inner: 924.18 | bwd_allreduce: 2.57 | step: 25.26
[2024-11-14 15:10:45,462] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:10:45,463] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 926.98 | bwd_inner_microstep: 924.41 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.32
[2024-11-14 15:10:45,463] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 926.99 | bwd_inner: 924.41 | bwd_allreduce: 2.55 | step: 25.32
[2024-11-14 15:10:47,041] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:10:47,042] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.13 | bwd_microstep: 1146.65 | bwd_inner_microstep: 1143.83 | bwd_allreduce_microstep: 2.79 | step_microstep: 26.17
[2024-11-14 15:10:47,042] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.12 | bwd: 1146.66 | bwd_inner: 1143.83 | bwd_allreduce: 2.80 | step: 26.17
[2024-11-14 15:10:48,318] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:10:48,319] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 927.64 | bwd_inner_microstep: 924.74 | bwd_allreduce_microstep: 2.88 | step_microstep: 26.30
[2024-11-14 15:10:48,319] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 927.65 | bwd_inner: 924.74 | bwd_allreduce: 2.89 | step: 26.30
[2024-11-14 15:10:49,593] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.51
[2024-11-14 15:10:49,593] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.85 | bwd_microstep: 926.64 | bwd_inner_microstep: 924.10 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.27
[2024-11-14 15:10:49,594] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.84 | bwd: 926.65 | bwd_inner: 924.10 | bwd_allreduce: 2.52 | step: 25.27
[2024-11-14 15:10:50,869] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:10:50,869] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.02 | bwd_microstep: 927.27 | bwd_inner_microstep: 924.73 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.33
[2024-11-14 15:10:50,869] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 927.28 | bwd_inner: 924.73 | bwd_allreduce: 2.53 | step: 25.33
[2024-11-14 15:10:52,144] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:10:52,144] [INFO] [logging.py:96:log_dist] [Rank 0] step=260, skipped=2, lr=[0.0002065228031763637], mom=[(0.9, 0.95)]
[2024-11-14 15:10:52,144] [INFO] [timer.py:259:stop] epoch=0/micro_step=260/global_step=260, RunningAvgSamplesPerSec=780.3626168542954, CurrSamplesPerSec=803.7780552170196, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:10:52,144] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.71 | bwd_microstep: 927.00 | bwd_inner_microstep: 924.43 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.52
[2024-11-14 15:10:52,144] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.70 | bwd: 927.01 | bwd_inner: 924.43 | bwd_allreduce: 2.55 | step: 25.52
[2024-11-14 15:10:53,419] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:10:53,420] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 926.83 | bwd_inner_microstep: 924.26 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.39
[2024-11-14 15:10:53,420] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 926.84 | bwd_inner: 924.26 | bwd_allreduce: 2.55 | step: 25.39
[2024-11-14 15:10:54,695] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:10:54,695] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.24 | bwd_inner_microstep: 924.68 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.25
[2024-11-14 15:10:54,696] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 927.25 | bwd_inner: 924.68 | bwd_allreduce: 2.55 | step: 25.26
[2024-11-14 15:10:56,274] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:10:56,274] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.02 | bwd_microstep: 1146.70 | bwd_inner_microstep: 1143.84 | bwd_allreduce_microstep: 2.83 | step_microstep: 25.94
[2024-11-14 15:10:56,274] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.02 | bwd: 1146.71 | bwd_inner: 1143.84 | bwd_allreduce: 2.84 | step: 25.94
[2024-11-14 15:10:57,551] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:10:57,551] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.90 | bwd_microstep: 927.29 | bwd_inner_microstep: 924.53 | bwd_allreduce_microstep: 2.73 | step_microstep: 26.39
[2024-11-14 15:10:57,551] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.89 | bwd: 927.29 | bwd_inner: 924.53 | bwd_allreduce: 2.74 | step: 26.39
[2024-11-14 15:10:58,826] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:10:58,827] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.23 | bwd_microstep: 927.32 | bwd_inner_microstep: 924.76 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.20
[2024-11-14 15:10:58,827] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.22 | bwd: 927.32 | bwd_inner: 924.76 | bwd_allreduce: 2.54 | step: 25.20
[2024-11-14 15:11:00,103] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:00,103] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 928.01 | bwd_inner_microstep: 925.46 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.30
[2024-11-14 15:11:00,103] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 928.02 | bwd_inner: 925.46 | bwd_allreduce: 2.53 | step: 25.30
[2024-11-14 15:11:01,378] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:01,378] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.76 | bwd_microstep: 926.68 | bwd_inner_microstep: 924.14 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:11:01,378] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.75 | bwd: 926.69 | bwd_inner: 924.14 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:11:02,653] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:11:02,653] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 927.26 | bwd_inner_microstep: 924.72 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.24
[2024-11-14 15:11:02,653] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 927.27 | bwd_inner: 924.72 | bwd_allreduce: 2.53 | step: 25.24
[2024-11-14 15:11:03,928] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:11:03,928] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.91 | bwd_microstep: 926.79 | bwd_inner_microstep: 924.14 | bwd_allreduce_microstep: 2.63 | step_microstep: 25.39
[2024-11-14 15:11:03,929] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.90 | bwd: 926.80 | bwd_inner: 924.13 | bwd_allreduce: 2.64 | step: 25.39
[2024-11-14 15:11:05,203] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:11:05,203] [INFO] [logging.py:96:log_dist] [Rank 0] step=270, skipped=2, lr=[0.00020773165448605743], mom=[(0.9, 0.95)]
[2024-11-14 15:11:05,203] [INFO] [timer.py:259:stop] epoch=0/micro_step=270/global_step=270, RunningAvgSamplesPerSec=780.5267327979677, CurrSamplesPerSec=803.9486703934152, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:11:05,203] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.59 | bwd_microstep: 926.85 | bwd_inner_microstep: 924.30 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.50
[2024-11-14 15:11:05,203] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.58 | bwd: 926.86 | bwd_inner: 924.30 | bwd_allreduce: 2.53 | step: 25.50
[2024-11-14 15:11:06,782] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:06,782] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.15 | bwd_microstep: 1146.82 | bwd_inner_microstep: 1144.25 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.40
[2024-11-14 15:11:06,782] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.14 | bwd: 1146.82 | bwd_inner: 1144.25 | bwd_allreduce: 2.54 | step: 25.40
[2024-11-14 15:11:08,058] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:11:08,058] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.70 | bwd_microstep: 927.07 | bwd_inner_microstep: 924.16 | bwd_allreduce_microstep: 2.88 | step_microstep: 26.50
[2024-11-14 15:11:08,058] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.69 | bwd: 927.07 | bwd_inner: 924.16 | bwd_allreduce: 2.89 | step: 26.50
[2024-11-14 15:11:09,039] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:11:09,039] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.13 | bwd_microstep: 711.65 | bwd_inner_microstep: 709.10 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.29
[2024-11-14 15:11:09,039] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.13 | bwd: 711.65 | bwd_inner: 709.10 | bwd_allreduce: 2.53 | step: 25.30
[2024-11-14 15:11:10,314] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:10,315] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.31 | bwd_inner_microstep: 924.76 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:11:10,315] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.32 | bwd_inner: 924.76 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:11:12,196] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:11:12,196] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.87 | bwd_microstep: 1358.97 | bwd_inner_microstep: 1356.14 | bwd_allreduce_microstep: 2.79 | step_microstep: 26.15
[2024-11-14 15:11:12,196] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.86 | bwd: 1358.97 | bwd_inner: 1356.14 | bwd_allreduce: 2.80 | step: 26.15
[2024-11-14 15:11:13,470] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.51
[2024-11-14 15:11:13,471] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.87 | bwd_microstep: 926.66 | bwd_inner_microstep: 924.13 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.19
[2024-11-14 15:11:13,471] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.86 | bwd: 926.67 | bwd_inner: 924.12 | bwd_allreduce: 2.52 | step: 25.19
[2024-11-14 15:11:14,745] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:11:14,745] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.86 | bwd_microstep: 926.88 | bwd_inner_microstep: 924.34 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.21
[2024-11-14 15:11:14,746] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.85 | bwd: 926.88 | bwd_inner: 924.34 | bwd_allreduce: 2.52 | step: 25.21
[2024-11-14 15:11:16,021] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:16,021] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 927.05 | bwd_inner_microstep: 924.47 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.36
[2024-11-14 15:11:16,021] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 927.05 | bwd_inner: 924.47 | bwd_allreduce: 2.56 | step: 25.36
[2024-11-14 15:11:17,296] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:11:17,296] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.95 | bwd_microstep: 926.76 | bwd_inner_microstep: 924.16 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.49
[2024-11-14 15:11:17,296] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.94 | bwd: 926.77 | bwd_inner: 924.16 | bwd_allreduce: 2.59 | step: 25.49
[2024-11-14 15:11:18,874] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:11:18,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=280, skipped=2, lr=[0.00020889621543449126], mom=[(0.9, 0.95)]
[2024-11-14 15:11:18,875] [INFO] [timer.py:259:stop] epoch=0/micro_step=280/global_step=280, RunningAvgSamplesPerSec=779.3695595186495, CurrSamplesPerSec=649.1785402548961, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:11:18,875] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.22 | bwd_microstep: 1146.72 | bwd_inner_microstep: 1144.14 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.68
[2024-11-14 15:11:18,875] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.22 | bwd: 1146.73 | bwd_inner: 1144.14 | bwd_allreduce: 2.57 | step: 25.68
[2024-11-14 15:11:20,151] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:11:20,151] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.17 | bwd_inner_microstep: 924.60 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.32
[2024-11-14 15:11:20,151] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.18 | bwd_inner: 924.60 | bwd_allreduce: 2.56 | step: 25.32
[2024-11-14 15:11:21,426] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:11:21,426] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.00 | bwd_microstep: 927.09 | bwd_inner_microstep: 924.54 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.24
[2024-11-14 15:11:21,426] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 927.10 | bwd_inner: 924.54 | bwd_allreduce: 2.54 | step: 25.24
[2024-11-14 15:11:22,701] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:22,701] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.75 | bwd_microstep: 926.72 | bwd_inner_microstep: 924.16 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:11:22,701] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.74 | bwd: 926.73 | bwd_inner: 924.16 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:11:23,977] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:11:23,977] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.32 | bwd_microstep: 927.22 | bwd_inner_microstep: 924.65 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.49
[2024-11-14 15:11:23,977] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.31 | bwd: 927.23 | bwd_inner: 924.65 | bwd_allreduce: 2.55 | step: 25.49
[2024-11-14 15:11:25,252] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:11:25,252] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 926.89 | bwd_inner_microstep: 924.33 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:11:25,252] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.11 | bwd: 926.90 | bwd_inner: 924.33 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:11:26,527] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:26,527] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.81 | bwd_microstep: 927.24 | bwd_inner_microstep: 924.68 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.23
[2024-11-14 15:11:26,528] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.80 | bwd: 927.24 | bwd_inner: 924.68 | bwd_allreduce: 2.54 | step: 25.23
[2024-11-14 15:11:27,803] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:27,803] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 927.05 | bwd_inner_microstep: 924.46 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.29
[2024-11-14 15:11:27,803] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.07 | bwd: 927.06 | bwd_inner: 924.46 | bwd_allreduce: 2.58 | step: 25.30
[2024-11-14 15:11:29,382] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:11:29,382] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.10 | bwd_microstep: 1146.60 | bwd_inner_microstep: 1143.61 | bwd_allreduce_microstep: 2.96 | step_microstep: 26.13
[2024-11-14 15:11:29,382] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.09 | bwd: 1146.61 | bwd_inner: 1143.61 | bwd_allreduce: 2.97 | step: 26.13
[2024-11-14 15:11:31,260] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:11:31,260] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.38 | bwd_microstep: 1357.77 | bwd_inner_microstep: 1355.24 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.23
[2024-11-14 15:11:31,261] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.37 | bwd: 1357.77 | bwd_inner: 1355.24 | bwd_allreduce: 2.51 | step: 25.23
[2024-11-14 15:11:32,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:11:32,839] [INFO] [logging.py:96:log_dist] [Rank 0] step=290, skipped=2, lr=[0.00021001961709661427], mom=[(0.9, 0.95)]
[2024-11-14 15:11:32,839] [INFO] [timer.py:259:stop] epoch=0/micro_step=290/global_step=290, RunningAvgSamplesPerSec=777.6962895289063, CurrSamplesPerSec=649.2631328410954, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:11:32,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.03 | bwd_microstep: 1146.42 | bwd_inner_microstep: 1143.85 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.96
[2024-11-14 15:11:32,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.01 | bwd: 1146.43 | bwd_inner: 1143.85 | bwd_allreduce: 2.55 | step: 25.96
[2024-11-14 15:11:33,820] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:11:33,821] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.08 | bwd_microstep: 712.14 | bwd_inner_microstep: 709.61 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.30
[2024-11-14 15:11:33,821] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.08 | bwd: 712.15 | bwd_inner: 709.61 | bwd_allreduce: 2.52 | step: 25.30
[2024-11-14 15:11:35,096] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:35,096] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 927.10 | bwd_inner_microstep: 924.54 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.33
[2024-11-14 15:11:35,096] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 927.11 | bwd_inner: 924.54 | bwd_allreduce: 2.55 | step: 25.33
[2024-11-14 15:11:36,371] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:11:36,372] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.90 | bwd_microstep: 927.09 | bwd_inner_microstep: 924.54 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:11:36,372] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.90 | bwd: 927.10 | bwd_inner: 924.53 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:11:37,646] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:37,646] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.83 | bwd_microstep: 926.69 | bwd_inner_microstep: 924.13 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.23
[2024-11-14 15:11:37,646] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.82 | bwd: 926.70 | bwd_inner: 924.13 | bwd_allreduce: 2.54 | step: 25.24
[2024-11-14 15:11:38,921] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:38,921] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.93 | bwd_microstep: 926.97 | bwd_inner_microstep: 924.43 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:11:38,921] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.92 | bwd: 926.98 | bwd_inner: 924.43 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:11:40,501] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:11:40,501] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.25 | bwd_microstep: 1147.18 | bwd_inner_microstep: 1144.37 | bwd_allreduce_microstep: 2.78 | step_microstep: 26.26
[2024-11-14 15:11:40,501] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.24 | bwd: 1147.19 | bwd_inner: 1144.37 | bwd_allreduce: 2.80 | step: 26.26
[2024-11-14 15:11:41,777] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:11:41,777] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 927.10 | bwd_inner_microstep: 924.14 | bwd_allreduce_microstep: 2.93 | step_microstep: 26.22
[2024-11-14 15:11:41,777] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 927.11 | bwd_inner: 924.14 | bwd_allreduce: 2.94 | step: 26.23
[2024-11-14 15:11:43,053] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:11:43,053] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.00 | bwd_inner_microstep: 924.41 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.49
[2024-11-14 15:11:43,053] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 927.01 | bwd_inner: 924.41 | bwd_allreduce: 2.58 | step: 25.50
[2024-11-14 15:11:44,328] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:11:44,329] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.14 | bwd_inner_microstep: 924.59 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.27
[2024-11-14 15:11:44,329] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 927.14 | bwd_inner: 924.59 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:11:45,603] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:11:45,603] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=2, lr=[0.00021110466982805038], mom=[(0.9, 0.95)]
[2024-11-14 15:11:45,603] [INFO] [timer.py:259:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=778.5168239386517, CurrSamplesPerSec=804.2922267366391, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:11:45,603] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.50 | bwd_microstep: 926.38 | bwd_inner_microstep: 923.82 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.52
[2024-11-14 15:11:45,603] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.49 | bwd: 926.39 | bwd_inner: 923.82 | bwd_allreduce: 2.55 | step: 25.52
[2024-11-14 15:11:46,878] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:11:46,878] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.91 | bwd_microstep: 927.14 | bwd_inner_microstep: 924.58 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.49
[2024-11-14 15:11:46,879] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.90 | bwd: 927.15 | bwd_inner: 924.58 | bwd_allreduce: 2.55 | step: 25.49
[2024-11-14 15:11:46.879122][epoch 0][local 0: 300][global 300] train_loss: 0.6540006, 678.4 samples / 13568 tokens per sec
[2024-11-14 15:11:48,153] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:48,154] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.85 | bwd_microstep: 926.73 | bwd_inner_microstep: 924.19 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.28
[2024-11-14 15:11:48,154] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.84 | bwd: 926.74 | bwd_inner: 924.19 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:11:49,429] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:49,429] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.90 | bwd_microstep: 927.05 | bwd_inner_microstep: 924.50 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.26
[2024-11-14 15:11:49,429] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.90 | bwd: 927.06 | bwd_inner: 924.50 | bwd_allreduce: 2.54 | step: 25.26
[2024-11-14 15:11:50,703] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:11:50,703] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.80 | bwd_microstep: 926.52 | bwd_inner_microstep: 923.98 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.28
[2024-11-14 15:11:50,703] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.79 | bwd: 926.53 | bwd_inner: 923.98 | bwd_allreduce: 2.52 | step: 25.29
[2024-11-14 15:11:51,978] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:11:51,979] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.03 | bwd_microstep: 926.84 | bwd_inner_microstep: 924.26 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.37
[2024-11-14 15:11:51,979] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 926.85 | bwd_inner: 924.26 | bwd_allreduce: 2.57 | step: 25.37
[2024-11-14 15:11:53,254] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:53,254] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 927.28 | bwd_inner_microstep: 924.51 | bwd_allreduce_microstep: 2.73 | step_microstep: 25.28
[2024-11-14 15:11:53,254] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 927.28 | bwd_inner: 924.52 | bwd_allreduce: 2.74 | step: 25.28
[2024-11-14 15:11:54,529] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:11:54,529] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.88 | bwd_microstep: 926.70 | bwd_inner_microstep: 924.15 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.22
[2024-11-14 15:11:54,529] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.87 | bwd: 926.70 | bwd_inner: 924.15 | bwd_allreduce: 2.53 | step: 25.22
[2024-11-14 15:11:55,510] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:55,510] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.25 | bwd_microstep: 712.03 | bwd_inner_microstep: 709.48 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:11:55,511] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.24 | bwd: 712.04 | bwd_inner: 709.48 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:11:56,492] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:11:56,492] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.28 | bwd_microstep: 712.04 | bwd_inner_microstep: 709.43 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.29
[2024-11-14 15:11:56,492] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.27 | bwd: 712.05 | bwd_inner: 709.43 | bwd_allreduce: 2.60 | step: 25.29
[2024-11-14 15:11:57,475] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:11:57,475] [INFO] [logging.py:96:log_dist] [Rank 0] step=310, skipped=2, lr=[0.00021215390562491303], mom=[(0.9, 0.95)]
[2024-11-14 15:11:57,476] [INFO] [timer.py:259:stop] epoch=0/micro_step=310/global_step=310, RunningAvgSamplesPerSec=781.0051848527376, CurrSamplesPerSec=1042.2051661487633, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:11:57,476] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.33 | bwd_microstep: 712.05 | bwd_inner_microstep: 709.18 | bwd_allreduce_microstep: 2.84 | step_microstep: 27.39
[2024-11-14 15:11:57,476] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.32 | bwd: 712.05 | bwd_inner: 709.18 | bwd_allreduce: 2.85 | step: 27.39
[2024-11-14 15:11:59,356] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:11:59,356] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.58 | bwd_microstep: 1358.54 | bwd_inner_microstep: 1355.63 | bwd_allreduce_microstep: 2.87 | step_microstep: 26.26
[2024-11-14 15:11:59,356] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.57 | bwd: 1358.54 | bwd_inner: 1355.63 | bwd_allreduce: 2.89 | step: 26.26
[2024-11-14 15:12:00,632] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:12:00,632] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.68 | bwd_inner_microstep: 925.14 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:12:00,632] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 927.69 | bwd_inner: 925.14 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:12:01,907] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:12:01,907] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 926.65 | bwd_inner_microstep: 924.09 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.27
[2024-11-14 15:12:01,907] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 926.66 | bwd_inner: 924.09 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:12:03,182] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:12:03,182] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 926.75 | bwd_inner_microstep: 924.20 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.30
[2024-11-14 15:12:03,183] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 926.76 | bwd_inner: 924.20 | bwd_allreduce: 2.53 | step: 25.31
[2024-11-14 15:12:04,458] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:12:04,458] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.13 | bwd_inner_microstep: 924.56 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.38
[2024-11-14 15:12:04,458] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 927.13 | bwd_inner: 924.56 | bwd_allreduce: 2.55 | step: 25.38
[2024-11-14 15:12:05,733] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:05,734] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 927.27 | bwd_inner_microstep: 924.71 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.31
[2024-11-14 15:12:05,734] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.11 | bwd: 927.28 | bwd_inner: 924.71 | bwd_allreduce: 2.54 | step: 25.31
[2024-11-14 15:12:07,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:12:07,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 926.92 | bwd_inner_microstep: 924.36 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.22
[2024-11-14 15:12:07,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.97 | bwd: 926.93 | bwd_inner: 924.36 | bwd_allreduce: 2.54 | step: 25.22
[2024-11-14 15:12:08,588] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:12:08,588] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.46 | bwd_microstep: 1147.22 | bwd_inner_microstep: 1144.39 | bwd_allreduce_microstep: 2.80 | step_microstep: 25.94
[2024-11-14 15:12:08,589] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.45 | bwd: 1147.22 | bwd_inner: 1144.39 | bwd_allreduce: 2.81 | step: 25.94
[2024-11-14 15:12:09,570] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:09,570] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.12 | bwd_microstep: 712.23 | bwd_inner_microstep: 709.67 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.31
[2024-11-14 15:12:09,570] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.12 | bwd: 712.23 | bwd_inner: 709.67 | bwd_allreduce: 2.54 | step: 25.31
[2024-11-14 15:12:10,846] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:12:10,846] [INFO] [logging.py:96:log_dist] [Rank 0] step=320, skipped=2, lr=[0.00021316961371310912], mom=[(0.9, 0.95)]
[2024-11-14 15:12:10,846] [INFO] [timer.py:259:stop] epoch=0/micro_step=320/global_step=320, RunningAvgSamplesPerSec=780.5392005854725, CurrSamplesPerSec=803.1262024685178, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:12:10,846] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.08 | bwd_microstep: 927.21 | bwd_inner_microstep: 924.66 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.96
[2024-11-14 15:12:10,846] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.07 | bwd: 927.21 | bwd_inner: 924.66 | bwd_allreduce: 2.53 | step: 25.96
[2024-11-14 15:12:12,121] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:12:12,122] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.86 | bwd_microstep: 927.36 | bwd_inner_microstep: 924.82 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.34
[2024-11-14 15:12:12,122] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.85 | bwd: 927.37 | bwd_inner: 924.82 | bwd_allreduce: 2.53 | step: 25.34
[2024-11-14 15:12:13,398] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:13,398] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.19 | bwd_microstep: 927.64 | bwd_inner_microstep: 924.88 | bwd_allreduce_microstep: 2.73 | step_microstep: 25.31
[2024-11-14 15:12:13,398] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.18 | bwd: 927.65 | bwd_inner: 924.87 | bwd_allreduce: 2.74 | step: 25.31
[2024-11-14 15:12:14,379] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:14,380] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.42 | bwd_microstep: 712.12 | bwd_inner_microstep: 709.59 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.26
[2024-11-14 15:12:14,380] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.41 | bwd: 712.13 | bwd_inner: 709.59 | bwd_allreduce: 2.52 | step: 25.27
[2024-11-14 15:12:15,656] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:15,656] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.29 | bwd_inner_microstep: 924.72 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.48
[2024-11-14 15:12:15,656] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.29 | bwd_inner: 924.72 | bwd_allreduce: 2.55 | step: 25.48
[2024-11-14 15:12:16,932] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.49
[2024-11-14 15:12:16,932] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.19 | bwd_microstep: 927.73 | bwd_inner_microstep: 925.00 | bwd_allreduce_microstep: 2.70 | step_microstep: 25.58
[2024-11-14 15:12:16,932] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.18 | bwd: 927.74 | bwd_inner: 924.99 | bwd_allreduce: 2.71 | step: 25.59
[2024-11-14 15:12:18,511] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:12:18,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.11 | bwd_microstep: 1146.59 | bwd_inner_microstep: 1143.76 | bwd_allreduce_microstep: 2.80 | step_microstep: 26.11
[2024-11-14 15:12:18,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.10 | bwd: 1146.60 | bwd_inner: 1143.76 | bwd_allreduce: 2.81 | step: 26.12
[2024-11-14 15:12:20,390] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:12:20,390] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.38 | bwd_microstep: 1357.79 | bwd_inner_microstep: 1355.24 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.24
[2024-11-14 15:12:20,390] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.38 | bwd: 1357.80 | bwd_inner: 1355.24 | bwd_allreduce: 2.54 | step: 25.24
[2024-11-14 15:12:21,665] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:21,666] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 927.21 | bwd_inner_microstep: 924.68 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.26
[2024-11-14 15:12:21,666] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.27 | bwd: 927.22 | bwd_inner: 924.68 | bwd_allreduce: 2.52 | step: 25.26
[2024-11-14 15:12:23,245] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:12:23,245] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.17 | bwd_microstep: 1146.81 | bwd_inner_microstep: 1144.00 | bwd_allreduce_microstep: 2.77 | step_microstep: 26.25
[2024-11-14 15:12:23,245] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.16 | bwd: 1146.81 | bwd_inner: 1144.00 | bwd_allreduce: 2.79 | step: 26.25
[2024-11-14 15:12:24,823] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:12:24,823] [INFO] [logging.py:96:log_dist] [Rank 0] step=330, skipped=2, lr=[0.00021415387062559096], mom=[(0.9, 0.95)]
[2024-11-14 15:12:24,824] [INFO] [timer.py:259:stop] epoch=0/micro_step=330/global_step=330, RunningAvgSamplesPerSec=779.0053370207123, CurrSamplesPerSec=649.1786383773757, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:12:24,824] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.48 | bwd_microstep: 1146.51 | bwd_inner_microstep: 1143.93 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.62
[2024-11-14 15:12:24,824] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.47 | bwd: 1146.52 | bwd_inner: 1143.93 | bwd_allreduce: 2.56 | step: 25.63
[2024-11-14 15:12:26,099] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:12:26,099] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.83 | bwd_microstep: 926.99 | bwd_inner_microstep: 924.15 | bwd_allreduce_microstep: 2.82 | step_microstep: 25.82
[2024-11-14 15:12:26,099] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.82 | bwd: 927.00 | bwd_inner: 924.15 | bwd_allreduce: 2.83 | step: 25.82
[2024-11-14 15:12:27,374] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:27,374] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.90 | bwd_microstep: 926.87 | bwd_inner_microstep: 924.33 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:12:27,374] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.89 | bwd: 926.88 | bwd_inner: 924.33 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:12:28,650] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:12:28,651] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.31 | bwd_microstep: 927.94 | bwd_inner_microstep: 925.39 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.24
[2024-11-14 15:12:28,651] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.30 | bwd: 927.95 | bwd_inner: 925.39 | bwd_allreduce: 2.53 | step: 25.24
[2024-11-14 15:12:29,632] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:29,633] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.30 | bwd_microstep: 712.39 | bwd_inner_microstep: 709.85 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:12:29,633] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.29 | bwd: 712.40 | bwd_inner: 709.85 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:12:30,909] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:12:30,909] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.22 | bwd_microstep: 928.10 | bwd_inner_microstep: 925.54 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.27
[2024-11-14 15:12:30,909] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.22 | bwd: 928.10 | bwd_inner: 925.53 | bwd_allreduce: 2.55 | step: 25.27
[2024-11-14 15:12:32,184] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:12:32,185] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 926.86 | bwd_inner_microstep: 924.28 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.32
[2024-11-14 15:12:32,185] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 926.87 | bwd_inner: 924.28 | bwd_allreduce: 2.56 | step: 25.33
[2024-11-14 15:12:33,461] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:12:33,461] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.66 | bwd_inner_microstep: 924.91 | bwd_allreduce_microstep: 2.73 | step_microstep: 25.34
[2024-11-14 15:12:33,461] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.67 | bwd_inner: 924.91 | bwd_allreduce: 2.74 | step: 25.34
[2024-11-14 15:12:34,736] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:12:34,736] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.88 | bwd_microstep: 926.96 | bwd_inner_microstep: 924.38 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.54
[2024-11-14 15:12:34,736] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.87 | bwd: 926.96 | bwd_inner: 924.38 | bwd_allreduce: 2.56 | step: 25.54
[2024-11-14 15:12:36,011] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:36,012] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.81 | bwd_microstep: 927.32 | bwd_inner_microstep: 924.76 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.23
[2024-11-14 15:12:36,012] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.80 | bwd: 927.32 | bwd_inner: 924.76 | bwd_allreduce: 2.54 | step: 25.24
[2024-11-14 15:12:37,288] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:37,288] [INFO] [logging.py:96:log_dist] [Rank 0] step=340, skipped=2, lr=[0.00021510856576129587], mom=[(0.9, 0.95)]
[2024-11-14 15:12:37,289] [INFO] [timer.py:259:stop] epoch=0/micro_step=340/global_step=340, RunningAvgSamplesPerSec=780.2178431757085, CurrSamplesPerSec=802.5917727366381, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:12:37,289] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.34 | bwd_microstep: 928.16 | bwd_inner_microstep: 925.60 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.60
[2024-11-14 15:12:37,289] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.34 | bwd: 928.17 | bwd_inner: 925.60 | bwd_allreduce: 2.55 | step: 25.61
[2024-11-14 15:12:38,563] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:38,564] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.71 | bwd_microstep: 926.87 | bwd_inner_microstep: 924.32 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.24
[2024-11-14 15:12:38,564] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.70 | bwd: 926.88 | bwd_inner: 924.32 | bwd_allreduce: 2.53 | step: 25.24
[2024-11-14 15:12:39,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.48
[2024-11-14 15:12:39,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 927.29 | bwd_inner_microstep: 924.73 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.34
[2024-11-14 15:12:39,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 927.29 | bwd_inner: 924.73 | bwd_allreduce: 2.54 | step: 25.34
[2024-11-14 15:12:41,114] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:41,114] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.73 | bwd_microstep: 927.15 | bwd_inner_microstep: 924.59 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.26
[2024-11-14 15:12:41,114] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.72 | bwd: 927.15 | bwd_inner: 924.59 | bwd_allreduce: 2.54 | step: 25.26
[2024-11-14 15:12:42,390] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:42,390] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.89 | bwd_microstep: 927.81 | bwd_inner_microstep: 925.26 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.25
[2024-11-14 15:12:42,390] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.89 | bwd: 927.82 | bwd_inner: 925.26 | bwd_allreduce: 2.54 | step: 25.25
[2024-11-14 15:12:43,665] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:43,665] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.77 | bwd_microstep: 927.05 | bwd_inner_microstep: 924.32 | bwd_allreduce_microstep: 2.70 | step_microstep: 25.23
[2024-11-14 15:12:43,665] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.76 | bwd: 927.05 | bwd_inner: 924.32 | bwd_allreduce: 2.71 | step: 25.23
[2024-11-14 15:12:44,941] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:12:44,941] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.13 | bwd_microstep: 927.18 | bwd_inner_microstep: 924.65 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.26
[2024-11-14 15:12:44,941] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 927.19 | bwd_inner: 924.65 | bwd_allreduce: 2.52 | step: 25.26
[2024-11-14 15:12:46,216] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:12:46,217] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.22 | bwd_microstep: 927.06 | bwd_inner_microstep: 924.51 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.30
[2024-11-14 15:12:46,217] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.21 | bwd: 927.06 | bwd_inner: 924.51 | bwd_allreduce: 2.53 | step: 25.30
[2024-11-14 15:12:47,492] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:47,492] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 927.09 | bwd_inner_microstep: 924.54 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:12:47,492] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 927.10 | bwd_inner: 924.54 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:12:48,768] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:12:48,768] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.10 | bwd_microstep: 927.23 | bwd_inner_microstep: 924.63 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.38
[2024-11-14 15:12:48,768] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.23 | bwd_inner: 924.63 | bwd_allreduce: 2.58 | step: 25.38
[2024-11-14 15:12:50,044] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:12:50,044] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=2, lr=[0.00021603542321657992], mom=[(0.9, 0.95)]
[2024-11-14 15:12:50,044] [INFO] [timer.py:259:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=780.866797703305, CurrSamplesPerSec=803.0865573046507, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:12:50,044] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.02 | bwd_microstep: 927.73 | bwd_inner_microstep: 925.18 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.57
[2024-11-14 15:12:50,045] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.01 | bwd: 927.74 | bwd_inner: 925.18 | bwd_allreduce: 2.53 | step: 25.58
[2024-11-14 15:12:51,321] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:51,321] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.82 | bwd_inner_microstep: 925.21 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.31
[2024-11-14 15:12:51,321] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 927.83 | bwd_inner: 925.21 | bwd_allreduce: 2.59 | step: 25.31
[2024-11-14 15:12:52,597] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:52,597] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 927.48 | bwd_inner_microstep: 924.91 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.65
[2024-11-14 15:12:52,597] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 927.48 | bwd_inner: 924.91 | bwd_allreduce: 2.55 | step: 25.65
[2024-11-14 15:12:53,871] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:53,872] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.74 | bwd_microstep: 926.86 | bwd_inner_microstep: 924.02 | bwd_allreduce_microstep: 2.81 | step_microstep: 25.32
[2024-11-14 15:12:53,872] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.73 | bwd: 926.87 | bwd_inner: 924.02 | bwd_allreduce: 2.83 | step: 25.32
[2024-11-14 15:12:55,147] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:55,147] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.79 | bwd_microstep: 927.37 | bwd_inner_microstep: 924.81 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.30
[2024-11-14 15:12:55,147] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.78 | bwd: 927.38 | bwd_inner: 924.81 | bwd_allreduce: 2.54 | step: 25.30
[2024-11-14 15:12:56,727] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:12:56,727] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.21 | bwd_microstep: 1147.40 | bwd_inner_microstep: 1144.54 | bwd_allreduce_microstep: 2.83 | step_microstep: 26.14
[2024-11-14 15:12:56,727] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.21 | bwd: 1147.41 | bwd_inner: 1144.54 | bwd_allreduce: 2.84 | step: 26.14
[2024-11-14 15:12:58,003] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:12:58,003] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.95 | bwd_microstep: 927.39 | bwd_inner_microstep: 924.56 | bwd_allreduce_microstep: 2.80 | step_microstep: 25.97
[2024-11-14 15:12:58,003] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.94 | bwd: 927.40 | bwd_inner: 924.56 | bwd_allreduce: 2.82 | step: 25.98
[2024-11-14 15:12:59,278] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:12:59,279] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.91 | bwd_microstep: 927.30 | bwd_inner_microstep: 924.74 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:12:59,279] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.90 | bwd: 927.31 | bwd_inner: 924.74 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:13:00,262] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:00,262] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.47 | bwd_microstep: 713.91 | bwd_inner_microstep: 711.36 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.30
[2024-11-14 15:13:00,262] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.46 | bwd: 713.92 | bwd_inner: 711.36 | bwd_allreduce: 2.54 | step: 25.30
[2024-11-14 15:13:01,244] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:13:01,245] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.61 | bwd_microstep: 712.52 | bwd_inner_microstep: 709.97 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:13:01,245] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.60 | bwd: 712.53 | bwd_inner: 709.97 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:13:02,521] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:13:02,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=360, skipped=2, lr=[0.00021693602052304107], mom=[(0.9, 0.95)]
[2024-11-14 15:13:02,521] [INFO] [timer.py:259:stop] epoch=0/micro_step=360/global_step=360, RunningAvgSamplesPerSec=781.9445264543468, CurrSamplesPerSec=802.9377726851715, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:13:02,521] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.35 | bwd_microstep: 927.69 | bwd_inner_microstep: 925.15 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.52
[2024-11-14 15:13:02,521] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.33 | bwd: 927.70 | bwd_inner: 925.15 | bwd_allreduce: 2.52 | step: 25.52
[2024-11-14 15:13:04,102] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:13:04,102] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.44 | bwd_microstep: 1148.05 | bwd_inner_microstep: 1145.13 | bwd_allreduce_microstep: 2.90 | step_microstep: 26.43
[2024-11-14 15:13:04,102] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.43 | bwd: 1148.06 | bwd_inner: 1145.13 | bwd_allreduce: 2.91 | step: 26.43
[2024-11-14 15:13:05,084] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:13:05,084] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.53 | bwd_microstep: 712.45 | bwd_inner_microstep: 709.85 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.28
[2024-11-14 15:13:05,084] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.51 | bwd: 712.46 | bwd_inner: 709.85 | bwd_allreduce: 2.58 | step: 25.29
[2024-11-14 15:13:06,359] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:06,360] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.08 | bwd_microstep: 926.95 | bwd_inner_microstep: 924.40 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:13:06,360] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.07 | bwd: 926.96 | bwd_inner: 924.40 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:13:07,634] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:13:07,635] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.04 | bwd_microstep: 926.88 | bwd_inner_microstep: 924.33 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.30
[2024-11-14 15:13:07,635] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.03 | bwd: 926.89 | bwd_inner: 924.33 | bwd_allreduce: 2.53 | step: 25.30
[2024-11-14 15:13:08,910] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:13:08,910] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.16 | bwd_inner_microstep: 924.58 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.33
[2024-11-14 15:13:08,910] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.17 | bwd_inner: 924.58 | bwd_allreduce: 2.57 | step: 25.34
[2024-11-14 15:13:09,892] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:13:09,892] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.50 | bwd_microstep: 712.14 | bwd_inner_microstep: 709.60 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.32
[2024-11-14 15:13:09,892] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.50 | bwd: 712.15 | bwd_inner: 709.60 | bwd_allreduce: 2.53 | step: 25.32
[2024-11-14 15:13:11,470] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:11,471] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.32 | bwd_microstep: 1146.55 | bwd_inner_microstep: 1143.98 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.32
[2024-11-14 15:13:11,471] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.31 | bwd: 1146.56 | bwd_inner: 1143.98 | bwd_allreduce: 2.56 | step: 25.32
[2024-11-14 15:13:12,746] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:13:12,746] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.30 | bwd_inner_microstep: 924.69 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.32
[2024-11-14 15:13:12,746] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.30 | bwd_inner: 924.69 | bwd_allreduce: 2.59 | step: 25.32
[2024-11-14 15:13:14,022] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:13:14,022] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.04 | bwd_microstep: 927.13 | bwd_inner_microstep: 924.54 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.50
[2024-11-14 15:13:14,022] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.03 | bwd: 927.13 | bwd_inner: 924.54 | bwd_allreduce: 2.58 | step: 25.50
[2024-11-14 15:13:15,297] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:13:15,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=370, skipped=2, lr=[0.00021781180480332055], mom=[(0.9, 0.95)]
[2024-11-14 15:13:15,298] [INFO] [timer.py:259:stop] epoch=0/micro_step=370/global_step=370, RunningAvgSamplesPerSec=782.4790296577811, CurrSamplesPerSec=803.3482276368169, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:13:15,298] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.03 | bwd_microstep: 927.20 | bwd_inner_microstep: 924.56 | bwd_allreduce_microstep: 2.61 | step_microstep: 25.69
[2024-11-14 15:13:15,298] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.01 | bwd: 927.20 | bwd_inner: 924.56 | bwd_allreduce: 2.62 | step: 25.69
[2024-11-14 15:13:16,574] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:13:16,574] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.02 | bwd_microstep: 927.24 | bwd_inner_microstep: 924.62 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.99
[2024-11-14 15:13:16,574] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.01 | bwd: 927.25 | bwd_inner: 924.62 | bwd_allreduce: 2.61 | step: 25.99
[2024-11-14 15:13:18,455] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:13:18,455] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.74 | bwd_microstep: 1358.91 | bwd_inner_microstep: 1356.17 | bwd_allreduce_microstep: 2.70 | step_microstep: 25.99
[2024-11-14 15:13:18,455] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.73 | bwd: 1358.91 | bwd_inner: 1356.17 | bwd_allreduce: 2.72 | step: 26.00
[2024-11-14 15:13:19,730] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:19,730] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.91 | bwd_microstep: 926.81 | bwd_inner_microstep: 924.28 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.21
[2024-11-14 15:13:19,730] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.91 | bwd: 926.82 | bwd_inner: 924.28 | bwd_allreduce: 2.51 | step: 25.21
[2024-11-14 15:13:21,005] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:21,005] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.04 | bwd_inner_microstep: 924.51 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.24
[2024-11-14 15:13:21,005] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.05 | bwd_inner: 924.51 | bwd_allreduce: 2.52 | step: 25.24
[2024-11-14 15:13:22,281] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:13:22,281] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.10 | bwd_microstep: 927.12 | bwd_inner_microstep: 924.58 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.24
[2024-11-14 15:13:22,281] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.13 | bwd_inner: 924.58 | bwd_allreduce: 2.53 | step: 25.24
[2024-11-14 15:13:23,860] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:13:23,860] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.17 | bwd_microstep: 1146.82 | bwd_inner_microstep: 1144.07 | bwd_allreduce_microstep: 2.72 | step_microstep: 25.93
[2024-11-14 15:13:23,860] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.16 | bwd: 1146.83 | bwd_inner: 1144.07 | bwd_allreduce: 2.74 | step: 25.93
[2024-11-14 15:13:25,136] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:13:25,136] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.93 | bwd_microstep: 927.07 | bwd_inner_microstep: 924.31 | bwd_allreduce_microstep: 2.72 | step_microstep: 26.02
[2024-11-14 15:13:25,136] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.92 | bwd: 927.07 | bwd_inner: 924.31 | bwd_allreduce: 2.74 | step: 26.03
[2024-11-14 15:13:26,411] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:26,412] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.13 | bwd_microstep: 926.86 | bwd_inner_microstep: 924.31 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.67
[2024-11-14 15:13:26,412] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 926.87 | bwd_inner: 924.31 | bwd_allreduce: 2.53 | step: 25.67
[2024-11-14 15:13:28,291] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:13:28,291] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.68 | bwd_microstep: 1358.34 | bwd_inner_microstep: 1355.75 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.39
[2024-11-14 15:13:28,291] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.67 | bwd: 1358.35 | bwd_inner: 1355.75 | bwd_allreduce: 2.58 | step: 25.39
[2024-11-14 15:13:29,273] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:13:29,274] [INFO] [logging.py:96:log_dist] [Rank 0] step=380, skipped=2, lr=[0.00021866410676041104], mom=[(0.9, 0.95)]
[2024-11-14 15:13:29,274] [INFO] [timer.py:259:stop] epoch=0/micro_step=380/global_step=380, RunningAvgSamplesPerSec=781.0914535160089, CurrSamplesPerSec=1042.9550441285462, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:13:29,274] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.36 | bwd_microstep: 712.37 | bwd_inner_microstep: 709.61 | bwd_allreduce_microstep: 2.73 | step_microstep: 26.34
[2024-11-14 15:13:29,274] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.35 | bwd: 712.37 | bwd_inner: 709.61 | bwd_allreduce: 2.74 | step: 26.34
[2024-11-14 15:13:30,549] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:13:30,549] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.22 | bwd_inner_microstep: 924.67 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.23
[2024-11-14 15:13:30,549] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 927.23 | bwd_inner: 924.67 | bwd_allreduce: 2.53 | step: 25.24
[2024-11-14 15:13:31,825] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:13:31,825] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 926.94 | bwd_inner_microstep: 924.37 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.44
[2024-11-14 15:13:31,825] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 926.95 | bwd_inner: 924.37 | bwd_allreduce: 2.55 | step: 25.45
[2024-11-14 15:13:32,806] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:13:32,806] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.31 | bwd_microstep: 712.03 | bwd_inner_microstep: 709.49 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.32
[2024-11-14 15:13:32,807] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.30 | bwd: 712.04 | bwd_inner: 709.49 | bwd_allreduce: 2.52 | step: 25.32
[2024-11-14 15:13:34,687] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:13:34,687] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.88 | bwd_microstep: 1358.57 | bwd_inner_microstep: 1355.78 | bwd_allreduce_microstep: 2.76 | step_microstep: 25.92
[2024-11-14 15:13:34,687] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.87 | bwd: 1358.58 | bwd_inner: 1355.78 | bwd_allreduce: 2.77 | step: 25.92
[2024-11-14 15:13:36,266] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:36,266] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.42 | bwd_microstep: 1147.20 | bwd_inner_microstep: 1144.64 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:13:36,266] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.42 | bwd: 1147.21 | bwd_inner: 1144.64 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:13:37,542] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:13:37,542] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 927.28 | bwd_inner_microstep: 924.50 | bwd_allreduce_microstep: 2.74 | step_microstep: 25.85
[2024-11-14 15:13:37,542] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 927.28 | bwd_inner: 924.50 | bwd_allreduce: 2.76 | step: 25.86
[2024-11-14 15:13:38,817] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:13:38,818] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.97 | bwd_microstep: 927.41 | bwd_inner_microstep: 924.86 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.22
[2024-11-14 15:13:38,818] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.96 | bwd: 927.41 | bwd_inner: 924.86 | bwd_allreduce: 2.53 | step: 25.22
[2024-11-14 15:13:40,093] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:40,094] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.08 | bwd_microstep: 927.80 | bwd_inner_microstep: 925.26 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.30
[2024-11-14 15:13:40,094] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.07 | bwd: 927.81 | bwd_inner: 925.27 | bwd_allreduce: 2.52 | step: 25.31
[2024-11-14 15:13:41,368] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:41,368] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.86 | bwd_microstep: 926.71 | bwd_inner_microstep: 924.18 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.19
[2024-11-14 15:13:41,369] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.85 | bwd: 926.72 | bwd_inner: 924.18 | bwd_allreduce: 2.52 | step: 25.19
[2024-11-14 15:13:42,644] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:13:42,644] [INFO] [logging.py:96:log_dist] [Rank 0] step=390, skipped=2, lr=[0.0002194941528400166], mom=[(0.9, 0.95)]
[2024-11-14 15:13:42,644] [INFO] [timer.py:259:stop] epoch=0/micro_step=390/global_step=390, RunningAvgSamplesPerSec=780.7076319759768, CurrSamplesPerSec=803.3952622506251, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:13:42,644] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.04 | bwd_microstep: 927.19 | bwd_inner_microstep: 924.62 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.59
[2024-11-14 15:13:42,644] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.04 | bwd: 927.20 | bwd_inner: 924.62 | bwd_allreduce: 2.56 | step: 25.59
[2024-11-14 15:13:44,224] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:13:44,224] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.53 | bwd_microstep: 1147.46 | bwd_inner_microstep: 1144.61 | bwd_allreduce_microstep: 2.82 | step_microstep: 26.27
[2024-11-14 15:13:44,225] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.52 | bwd: 1147.47 | bwd_inner: 1144.61 | bwd_allreduce: 2.83 | step: 26.28
[2024-11-14 15:13:45,803] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:13:45,803] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.60 | bwd_microstep: 1147.07 | bwd_inner_microstep: 1144.51 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.23
[2024-11-14 15:13:45,803] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.60 | bwd: 1147.08 | bwd_inner: 1144.51 | bwd_allreduce: 2.55 | step: 25.23
[2024-11-14 15:13:47,080] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:47,080] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 927.42 | bwd_inner_microstep: 924.65 | bwd_allreduce_microstep: 2.73 | step_microstep: 25.99
[2024-11-14 15:13:47,080] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 927.42 | bwd_inner: 924.65 | bwd_allreduce: 2.74 | step: 25.99
[2024-11-14 15:13:48,659] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:13:48,659] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.24 | bwd_microstep: 1146.75 | bwd_inner_microstep: 1143.94 | bwd_allreduce_microstep: 2.78 | step_microstep: 25.97
[2024-11-14 15:13:48,659] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.23 | bwd: 1146.76 | bwd_inner: 1143.94 | bwd_allreduce: 2.79 | step: 25.97
[2024-11-14 15:13:49,936] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:13:49,936] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 927.53 | bwd_inner_microstep: 924.81 | bwd_allreduce_microstep: 2.69 | step_microstep: 26.60
[2024-11-14 15:13:49,936] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.94 | bwd: 927.54 | bwd_inner: 924.81 | bwd_allreduce: 2.70 | step: 26.61
[2024-11-14 15:13:51,212] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:51,212] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.33 | bwd_microstep: 927.35 | bwd_inner_microstep: 924.80 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.70
[2024-11-14 15:13:51,212] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.32 | bwd: 927.35 | bwd_inner: 924.80 | bwd_allreduce: 2.53 | step: 25.70
[2024-11-14 15:13:52,194] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:52,194] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.50 | bwd_microstep: 712.17 | bwd_inner_microstep: 709.62 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.35
[2024-11-14 15:13:52,194] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.49 | bwd: 712.17 | bwd_inner: 709.62 | bwd_allreduce: 2.53 | step: 25.35
[2024-11-14 15:13:54,075] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:54,075] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.73 | bwd_microstep: 1358.53 | bwd_inner_microstep: 1355.67 | bwd_allreduce_microstep: 2.82 | step_microstep: 26.03
[2024-11-14 15:13:54,075] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.71 | bwd: 1358.53 | bwd_inner: 1355.67 | bwd_allreduce: 2.84 | step: 26.03
[2024-11-14 15:13:55,350] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:55,351] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.83 | bwd_microstep: 927.46 | bwd_inner_microstep: 924.93 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.22
[2024-11-14 15:13:55,351] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.82 | bwd: 927.47 | bwd_inner: 924.93 | bwd_allreduce: 2.52 | step: 25.22
[2024-11-14 15:13:56,626] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:13:56,627] [INFO] [logging.py:96:log_dist] [Rank 0] step=400, skipped=2, lr=[0.00022030307584500257], mom=[(0.9, 0.95)]
[2024-11-14 15:13:56,627] [INFO] [timer.py:259:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=779.4302931522071, CurrSamplesPerSec=803.0888097659024, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:13:56,627] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 927.73 | bwd_inner_microstep: 925.10 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.64
[2024-11-14 15:13:56,627] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 927.74 | bwd_inner: 925.10 | bwd_allreduce: 2.61 | step: 25.64
[2024-11-14 15:13:57,609] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:13:57,609] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.77 | bwd_microstep: 712.52 | bwd_inner_microstep: 709.98 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.22
[2024-11-14 15:13:57,610] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.76 | bwd: 712.53 | bwd_inner: 709.98 | bwd_allreduce: 2.53 | step: 25.22
[2024-11-14 15:13:57.610032][epoch 0][local 0: 400][global 400] train_loss: 0.6293653, 701.9 samples / 14038 tokens per sec
[2024-11-14 15:13:58,885] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:13:58,885] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 927.45 | bwd_inner_microstep: 924.85 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.27
[2024-11-14 15:13:58,885] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 927.46 | bwd_inner: 924.85 | bwd_allreduce: 2.58 | step: 25.27
[2024-11-14 15:14:00,162] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:14:00,162] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.01 | bwd_microstep: 928.20 | bwd_inner_microstep: 925.65 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:14:00,162] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 928.21 | bwd_inner: 925.65 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:14:01,437] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:01,438] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.32 | bwd_microstep: 927.43 | bwd_inner_microstep: 924.85 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.20
[2024-11-14 15:14:01,438] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.31 | bwd: 927.44 | bwd_inner: 924.85 | bwd_allreduce: 2.56 | step: 25.20
[2024-11-14 15:14:02,713] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:02,713] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.03 | bwd_inner_microstep: 924.48 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.31
[2024-11-14 15:14:02,713] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.11 | bwd: 927.04 | bwd_inner: 924.48 | bwd_allreduce: 2.53 | step: 25.31
[2024-11-14 15:14:03,989] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:03,989] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.90 | bwd_microstep: 926.97 | bwd_inner_microstep: 924.41 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.78
[2024-11-14 15:14:03,989] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.89 | bwd: 926.97 | bwd_inner: 924.41 | bwd_allreduce: 2.54 | step: 25.78
[2024-11-14 15:14:05,264] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:05,265] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 927.33 | bwd_inner_microstep: 924.70 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.30
[2024-11-14 15:14:05,265] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 927.33 | bwd_inner: 924.70 | bwd_allreduce: 2.60 | step: 25.31
[2024-11-14 15:14:06,246] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:06,246] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.28 | bwd_microstep: 712.10 | bwd_inner_microstep: 709.55 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.30
[2024-11-14 15:14:06,246] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.27 | bwd: 712.11 | bwd_inner: 709.55 | bwd_allreduce: 2.53 | step: 25.31
[2024-11-14 15:14:07,521] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:07,521] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 926.79 | bwd_inner_microstep: 924.24 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:14:07,522] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 926.80 | bwd_inner: 924.24 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:14:08,504] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:08,504] [INFO] [logging.py:96:log_dist] [Rank 0] step=410, skipped=2, lr=[0.00022109192423248295], mom=[(0.9, 0.95)]
[2024-11-14 15:14:08,504] [INFO] [timer.py:259:stop] epoch=0/micro_step=410/global_step=410, RunningAvgSamplesPerSec=781.282923780099, CurrSamplesPerSec=1043.1688417065066, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:14:08,504] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.41 | bwd_microstep: 712.79 | bwd_inner_microstep: 710.21 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.66
[2024-11-14 15:14:08,504] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.40 | bwd: 712.80 | bwd_inner: 710.21 | bwd_allreduce: 2.56 | step: 25.66
[2024-11-14 15:14:09,486] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:09,486] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.39 | bwd_microstep: 712.54 | bwd_inner_microstep: 709.96 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.26
[2024-11-14 15:14:09,487] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.38 | bwd: 712.55 | bwd_inner: 709.96 | bwd_allreduce: 2.56 | step: 25.26
[2024-11-14 15:14:10,762] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:14:10,762] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.08 | bwd_microstep: 927.34 | bwd_inner_microstep: 924.78 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.21
[2024-11-14 15:14:10,762] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 927.34 | bwd_inner: 924.78 | bwd_allreduce: 2.53 | step: 25.21
[2024-11-14 15:14:11,744] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:14:11,744] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.27 | bwd_microstep: 712.45 | bwd_inner_microstep: 709.92 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.31
[2024-11-14 15:14:11,744] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.27 | bwd: 712.46 | bwd_inner: 709.92 | bwd_allreduce: 2.52 | step: 25.31
[2024-11-14 15:14:13,323] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:13,323] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.32 | bwd_microstep: 1147.18 | bwd_inner_microstep: 1144.63 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.41
[2024-11-14 15:14:13,323] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.32 | bwd: 1147.19 | bwd_inner: 1144.63 | bwd_allreduce: 2.53 | step: 25.41
[2024-11-14 15:14:14,600] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:14:14,600] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.13 | bwd_microstep: 927.50 | bwd_inner_microstep: 924.65 | bwd_allreduce_microstep: 2.82 | step_microstep: 26.22
[2024-11-14 15:14:14,600] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.13 | bwd: 927.51 | bwd_inner: 924.65 | bwd_allreduce: 2.84 | step: 26.22
[2024-11-14 15:14:15,876] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:15,876] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.70 | bwd_inner_microstep: 925.12 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.33
[2024-11-14 15:14:15,876] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 927.71 | bwd_inner: 925.12 | bwd_allreduce: 2.56 | step: 25.33
[2024-11-14 15:14:16,858] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:14:16,858] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.41 | bwd_microstep: 712.37 | bwd_inner_microstep: 709.82 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:14:16,858] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.39 | bwd: 712.38 | bwd_inner: 709.82 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:14:18,437] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:18,438] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.50 | bwd_microstep: 1147.74 | bwd_inner_microstep: 1145.16 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.36
[2024-11-14 15:14:18,438] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.49 | bwd: 1147.75 | bwd_inner: 1145.16 | bwd_allreduce: 2.57 | step: 25.37
[2024-11-14 15:14:19,715] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:14:19,715] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.55 | bwd_microstep: 927.33 | bwd_inner_microstep: 924.13 | bwd_allreduce_microstep: 3.15 | step_microstep: 27.35
[2024-11-14 15:14:19,715] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.54 | bwd: 927.35 | bwd_inner: 924.13 | bwd_allreduce: 3.17 | step: 27.34
[2024-11-14 15:14:21,295] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:21,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=420, skipped=2, lr=[0.00022186167028500058], mom=[(0.9, 0.95)]
[2024-11-14 15:14:21,295] [INFO] [timer.py:259:stop] epoch=0/micro_step=420/global_step=420, RunningAvgSamplesPerSec=781.7485467839371, CurrSamplesPerSec=648.5667350796632, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:14:21,295] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.42 | bwd_microstep: 1147.24 | bwd_inner_microstep: 1144.44 | bwd_allreduce_microstep: 2.77 | step_microstep: 26.44
[2024-11-14 15:14:21,295] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.41 | bwd: 1147.25 | bwd_inner: 1144.44 | bwd_allreduce: 2.78 | step: 26.44
[2024-11-14 15:14:22,570] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:22,571] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.66 | bwd_microstep: 927.32 | bwd_inner_microstep: 924.75 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.43
[2024-11-14 15:14:22,571] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.66 | bwd: 927.33 | bwd_inner: 924.75 | bwd_allreduce: 2.55 | step: 25.43
[2024-11-14 15:14:23,854] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:14:23,855] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 329.85 | bwd_microstep: 927.61 | bwd_inner_microstep: 925.02 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.47
[2024-11-14 15:14:23,855] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 329.84 | bwd: 927.61 | bwd_inner: 925.02 | bwd_allreduce: 2.57 | step: 25.47
[2024-11-14 15:14:25,130] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:25,130] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 927.00 | bwd_inner_microstep: 924.47 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.27
[2024-11-14 15:14:25,130] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 927.01 | bwd_inner: 924.47 | bwd_allreduce: 2.52 | step: 25.27
[2024-11-14 15:14:26,406] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:26,406] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.31 | bwd_microstep: 927.63 | bwd_inner_microstep: 925.06 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.25
[2024-11-14 15:14:26,406] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.30 | bwd: 927.63 | bwd_inner: 925.06 | bwd_allreduce: 2.55 | step: 25.26
[2024-11-14 15:14:27,681] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:14:27,682] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 926.91 | bwd_inner_microstep: 924.34 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.50
[2024-11-14 15:14:27,682] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.97 | bwd: 926.92 | bwd_inner: 924.34 | bwd_allreduce: 2.55 | step: 25.51
[2024-11-14 15:14:28,663] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:14:28,663] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.33 | bwd_microstep: 711.91 | bwd_inner_microstep: 709.36 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.29
[2024-11-14 15:14:28,663] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.32 | bwd: 711.92 | bwd_inner: 709.36 | bwd_allreduce: 2.53 | step: 25.30
[2024-11-14 15:14:29,939] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:14:29,939] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.27 | bwd_microstep: 927.36 | bwd_inner_microstep: 924.78 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.42
[2024-11-14 15:14:29,939] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.26 | bwd: 927.36 | bwd_inner: 924.78 | bwd_allreduce: 2.56 | step: 25.42
[2024-11-14 15:14:31,215] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:14:31,215] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.39 | bwd_microstep: 927.51 | bwd_inner_microstep: 924.95 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:14:31,216] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.38 | bwd: 927.51 | bwd_inner: 924.95 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:14:32,491] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:32,492] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.76 | bwd_inner_microstep: 925.22 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.28
[2024-11-14 15:14:32,492] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.77 | bwd_inner: 925.22 | bwd_allreduce: 2.52 | step: 25.28
[2024-11-14 15:14:33,768] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:33,768] [INFO] [logging.py:96:log_dist] [Rank 0] step=430, skipped=2, lr=[0.00022261321731555924], mom=[(0.9, 0.95)]
[2024-11-14 15:14:33,768] [INFO] [timer.py:259:stop] epoch=0/micro_step=430/global_step=430, RunningAvgSamplesPerSec=782.6368815778948, CurrSamplesPerSec=802.9027990382992, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:14:33,768] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.43 | bwd_microstep: 927.68 | bwd_inner_microstep: 925.09 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.52
[2024-11-14 15:14:33,768] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.40 | bwd: 927.68 | bwd_inner: 925.09 | bwd_allreduce: 2.57 | step: 25.52
[2024-11-14 15:14:35,044] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:35,044] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.03 | bwd_microstep: 927.46 | bwd_inner_microstep: 924.91 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.32
[2024-11-14 15:14:35,044] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 927.47 | bwd_inner: 924.91 | bwd_allreduce: 2.53 | step: 25.32
[2024-11-14 15:14:36,026] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:14:36,027] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.59 | bwd_microstep: 712.57 | bwd_inner_microstep: 710.00 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.30
[2024-11-14 15:14:36,027] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.58 | bwd: 712.58 | bwd_inner: 710.01 | bwd_allreduce: 2.55 | step: 25.31
[2024-11-14 15:14:37,302] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:37,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.71 | bwd_inner_microstep: 925.15 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:14:37,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.72 | bwd_inner: 925.15 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:14:40,078] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:40,078] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 743.66 | bwd_microstep: 2004.79 | bwd_inner_microstep: 2002.22 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.41
[2024-11-14 15:14:40,078] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 743.65 | bwd: 2004.80 | bwd_inner: 2002.22 | bwd_allreduce: 2.56 | step: 25.41
[2024-11-14 15:14:41,352] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:14:41,352] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.64 | bwd_microstep: 926.45 | bwd_inner_microstep: 923.91 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.23
[2024-11-14 15:14:41,352] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.63 | bwd: 926.46 | bwd_inner: 923.91 | bwd_allreduce: 2.52 | step: 25.23
[2024-11-14 15:14:42,628] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:42,628] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 927.26 | bwd_inner_microstep: 924.70 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.66
[2024-11-14 15:14:42,628] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.97 | bwd: 927.26 | bwd_inner: 924.70 | bwd_allreduce: 2.54 | step: 25.67
[2024-11-14 15:14:43,904] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:43,904] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.24 | bwd_microstep: 927.27 | bwd_inner_microstep: 924.70 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.37
[2024-11-14 15:14:43,904] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.24 | bwd: 927.28 | bwd_inner: 924.70 | bwd_allreduce: 2.55 | step: 25.37
[2024-11-14 15:14:45,484] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:45,484] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.59 | bwd_microstep: 1147.45 | bwd_inner_microstep: 1144.59 | bwd_allreduce_microstep: 2.83 | step_microstep: 26.04
[2024-11-14 15:14:45,484] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.58 | bwd: 1147.46 | bwd_inner: 1144.59 | bwd_allreduce: 2.84 | step: 26.05
[2024-11-14 15:14:46,466] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:46,466] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.47 | bwd_microstep: 712.08 | bwd_inner_microstep: 709.55 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.27
[2024-11-14 15:14:46,466] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.46 | bwd: 712.09 | bwd_inner: 709.55 | bwd_allreduce: 2.51 | step: 25.27
[2024-11-14 15:14:48,962] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:48,963] [INFO] [logging.py:96:log_dist] [Rank 0] step=440, skipped=2, lr=[0.0002233474060404302], mom=[(0.9, 0.95)]
[2024-11-14 15:14:48,963] [INFO] [timer.py:259:stop] epoch=0/micro_step=440/global_step=440, RunningAvgSamplesPerSec=779.7802074951819, CurrSamplesPerSec=410.3839117061843, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:14:48,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 662.52 | bwd_microstep: 1807.30 | bwd_inner_microstep: 1804.68 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.65
[2024-11-14 15:14:48,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 662.51 | bwd: 1807.31 | bwd_inner: 1804.68 | bwd_allreduce: 2.61 | step: 25.65
[2024-11-14 15:14:50,541] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:14:50,541] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.39 | bwd_microstep: 1146.67 | bwd_inner_microstep: 1144.14 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.28
[2024-11-14 15:14:50,541] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.38 | bwd: 1146.68 | bwd_inner: 1144.14 | bwd_allreduce: 2.51 | step: 25.28
[2024-11-14 15:14:53,038] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:14:53,038] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 662.50 | bwd_microstep: 1807.35 | bwd_inner_microstep: 1804.79 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:14:53,038] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 662.49 | bwd: 1807.36 | bwd_inner: 1804.79 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:14:54,313] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.51
[2024-11-14 15:14:54,313] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.80 | bwd_microstep: 927.08 | bwd_inner_microstep: 924.35 | bwd_allreduce_microstep: 2.69 | step_microstep: 25.26
[2024-11-14 15:14:54,313] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.79 | bwd: 927.08 | bwd_inner: 924.35 | bwd_allreduce: 2.71 | step: 25.26
[2024-11-14 15:14:55,294] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:14:55,294] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.14 | bwd_microstep: 711.55 | bwd_inner_microstep: 709.00 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:14:55,294] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.13 | bwd: 711.55 | bwd_inner: 709.00 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:14:56,570] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:14:56,570] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.33 | bwd_microstep: 927.30 | bwd_inner_microstep: 924.75 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.29
[2024-11-14 15:14:56,570] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.32 | bwd: 927.31 | bwd_inner: 924.75 | bwd_allreduce: 2.53 | step: 25.29
[2024-11-14 15:14:57,846] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:14:57,846] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.36 | bwd_microstep: 927.19 | bwd_inner_microstep: 924.63 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.34
[2024-11-14 15:14:57,846] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.35 | bwd: 927.20 | bwd_inner: 924.63 | bwd_allreduce: 2.55 | step: 25.34
[2024-11-14 15:14:59,121] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:14:59,121] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 926.80 | bwd_inner_microstep: 924.23 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.25
[2024-11-14 15:14:59,121] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 926.81 | bwd_inner: 924.23 | bwd_allreduce: 2.55 | step: 25.25
[2024-11-14 15:15:00,701] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:15:00,701] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.16 | bwd_microstep: 1147.93 | bwd_inner_microstep: 1145.11 | bwd_allreduce_microstep: 2.79 | step_microstep: 26.07
[2024-11-14 15:15:00,702] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.15 | bwd: 1147.94 | bwd_inner: 1145.11 | bwd_allreduce: 2.80 | step: 26.07
[2024-11-14 15:15:01,978] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:15:01,978] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 927.56 | bwd_inner_microstep: 924.84 | bwd_allreduce_microstep: 2.69 | step_microstep: 25.97
[2024-11-14 15:15:01,978] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 927.57 | bwd_inner: 924.84 | bwd_allreduce: 2.70 | step: 25.97
[2024-11-14 15:15:03,253] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:15:03,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=2, lr=[0.0002240650202324854], mom=[(0.9, 0.95)]
[2024-11-14 15:15:03,253] [INFO] [timer.py:259:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=778.2623080456162, CurrSamplesPerSec=803.5869138489953, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:15:03,253] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.08 | bwd_microstep: 926.86 | bwd_inner_microstep: 924.30 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.57
[2024-11-14 15:15:03,253] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.07 | bwd: 926.87 | bwd_inner: 924.30 | bwd_allreduce: 2.55 | step: 25.58
[2024-11-14 15:15:04,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:15:04,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.38 | bwd_microstep: 711.92 | bwd_inner_microstep: 709.34 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.38
[2024-11-14 15:15:04,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.37 | bwd: 711.93 | bwd_inner: 709.34 | bwd_allreduce: 2.57 | step: 25.39
[2024-11-14 15:15:05,510] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:15:05,511] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 927.19 | bwd_inner_microstep: 924.63 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.25
[2024-11-14 15:15:05,511] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 927.19 | bwd_inner: 924.63 | bwd_allreduce: 2.54 | step: 25.26
[2024-11-14 15:15:06,786] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:15:06,786] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.02 | bwd_inner_microstep: 924.41 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.37
[2024-11-14 15:15:06,786] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 927.03 | bwd_inner: 924.41 | bwd_allreduce: 2.60 | step: 25.37
[2024-11-14 15:15:08,062] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:15:08,062] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.25 | bwd_inner_microstep: 924.69 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.30
[2024-11-14 15:15:08,062] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.18 | bwd: 927.26 | bwd_inner: 924.69 | bwd_allreduce: 2.54 | step: 25.30
[2024-11-14 15:15:09,642] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:15:09,642] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.75 | bwd_microstep: 1147.63 | bwd_inner_microstep: 1144.54 | bwd_allreduce_microstep: 3.06 | step_microstep: 25.78
[2024-11-14 15:15:09,642] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.75 | bwd: 1147.64 | bwd_inner: 1144.54 | bwd_allreduce: 3.07 | step: 25.78
[2024-11-14 15:15:10,917] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:15:10,917] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.70 | bwd_microstep: 926.77 | bwd_inner_microstep: 924.16 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.40
[2024-11-14 15:15:10,917] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.70 | bwd: 926.78 | bwd_inner: 924.16 | bwd_allreduce: 2.59 | step: 25.40
[2024-11-14 15:15:12,192] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:15:12,193] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.22 | bwd_inner_microstep: 924.65 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.27
[2024-11-14 15:15:12,193] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.11 | bwd: 927.23 | bwd_inner: 924.65 | bwd_allreduce: 2.55 | step: 25.27
[2024-11-14 15:15:13,468] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:15:13,468] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 927.18 | bwd_inner_microstep: 924.62 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:15:13,469] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.28 | bwd: 927.18 | bwd_inner: 924.62 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:15:15,349] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:15:15,349] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.73 | bwd_microstep: 1358.63 | bwd_inner_microstep: 1355.88 | bwd_allreduce_microstep: 2.72 | step_microstep: 25.88
[2024-11-14 15:15:15,349] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.72 | bwd: 1358.64 | bwd_inner: 1355.88 | bwd_allreduce: 2.73 | step: 25.88
[2024-11-14 15:15:16,625] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:15:16,625] [INFO] [logging.py:96:log_dist] [Rank 0] step=460, skipped=2, lr=[0.00022476679175038202], mom=[(0.9, 0.95)]
[2024-11-14 15:15:16,625] [INFO] [timer.py:259:stop] epoch=0/micro_step=460/global_step=460, RunningAvgSamplesPerSec=777.9995152589196, CurrSamplesPerSec=803.1463268902472, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:15:16,625] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.45 | bwd_microstep: 927.31 | bwd_inner_microstep: 924.78 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.45
[2024-11-14 15:15:16,625] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.45 | bwd: 927.32 | bwd_inner: 924.78 | bwd_allreduce: 2.52 | step: 25.45
[2024-11-14 15:15:17,901] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:15:17,901] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.33 | bwd_microstep: 927.37 | bwd_inner_microstep: 924.81 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.32
[2024-11-14 15:15:17,901] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.32 | bwd: 927.38 | bwd_inner: 924.81 | bwd_allreduce: 2.54 | step: 25.32
[2024-11-14 15:15:18,882] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:15:18,883] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.33 | bwd_microstep: 712.02 | bwd_inner_microstep: 709.47 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.31
[2024-11-14 15:15:18,883] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.32 | bwd: 712.02 | bwd_inner: 709.47 | bwd_allreduce: 2.53 | step: 25.31
[2024-11-14 15:15:20,461] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:15:20,461] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.53 | bwd_microstep: 1146.94 | bwd_inner_microstep: 1144.38 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.33
[2024-11-14 15:15:20,461] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.52 | bwd: 1146.95 | bwd_inner: 1144.38 | bwd_allreduce: 2.55 | step: 25.33
[2024-11-14 15:15:21,737] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:15:21,738] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.03 | bwd_microstep: 927.16 | bwd_inner_microstep: 924.38 | bwd_allreduce_microstep: 2.76 | step_microstep: 26.01
[2024-11-14 15:15:21,738] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 927.17 | bwd_inner: 924.38 | bwd_allreduce: 2.77 | step: 26.01
[2024-11-14 15:15:23,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:15:23,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.40 | bwd_inner_microstep: 924.85 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:15:23,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.41 | bwd_inner: 924.85 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:15:24,290] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:15:24,290] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 927.49 | bwd_inner_microstep: 924.80 | bwd_allreduce_microstep: 2.65 | step_microstep: 25.89
[2024-11-14 15:15:24,290] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.49 | bwd_inner: 924.80 | bwd_allreduce: 2.67 | step: 25.89
[2024-11-14 15:15:25,869] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:15:25,870] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.32 | bwd_microstep: 1146.63 | bwd_inner_microstep: 1143.78 | bwd_allreduce_microstep: 2.82 | step_microstep: 26.45
[2024-11-14 15:15:25,870] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.31 | bwd: 1146.64 | bwd_inner: 1143.78 | bwd_allreduce: 2.83 | step: 26.45
[2024-11-14 15:15:28,645] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:15:28,645] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 743.80 | bwd_microstep: 2003.74 | bwd_inner_microstep: 2000.75 | bwd_allreduce_microstep: 2.95 | step_microstep: 26.79
[2024-11-14 15:15:28,645] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 743.79 | bwd: 2003.75 | bwd_inner: 2000.75 | bwd_allreduce: 2.97 | step: 26.80
[2024-11-14 15:15:29,921] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:15:29,921] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 927.35 | bwd_inner_microstep: 924.72 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.52
[2024-11-14 15:15:29,921] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 927.35 | bwd_inner: 924.72 | bwd_allreduce: 2.61 | step: 25.52
[2024-11-14 15:15:31,197] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:15:31,197] [INFO] [logging.py:96:log_dist] [Rank 0] step=470, skipped=2, lr=[0.00022545340502450338], mom=[(0.9, 0.95)]
[2024-11-14 15:15:31,197] [INFO] [timer.py:259:stop] epoch=0/micro_step=470/global_step=470, RunningAvgSamplesPerSec=776.2362168737491, CurrSamplesPerSec=803.3587460819235, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:15:31,197] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.22 | bwd_microstep: 927.16 | bwd_inner_microstep: 924.60 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.51
[2024-11-14 15:15:31,197] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.21 | bwd: 927.16 | bwd_inner: 924.60 | bwd_allreduce: 2.54 | step: 25.51
[2024-11-14 15:15:32,473] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.48
[2024-11-14 15:15:32,473] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.08 | bwd_inner_microstep: 924.50 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.40
[2024-11-14 15:15:32,473] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.09 | bwd_inner: 924.50 | bwd_allreduce: 2.56 | step: 25.40
[2024-11-14 15:15:34,353] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:15:34,353] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.78 | bwd_microstep: 1358.57 | bwd_inner_microstep: 1355.56 | bwd_allreduce_microstep: 2.98 | step_microstep: 25.99
[2024-11-14 15:15:34,353] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.77 | bwd: 1358.57 | bwd_inner: 1355.56 | bwd_allreduce: 2.99 | step: 25.99
[2024-11-14 15:15:35,629] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:15:35,629] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.89 | bwd_microstep: 927.15 | bwd_inner_microstep: 924.22 | bwd_allreduce_microstep: 2.90 | step_microstep: 25.75
[2024-11-14 15:15:35,629] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.88 | bwd: 927.16 | bwd_inner: 924.22 | bwd_allreduce: 2.91 | step: 25.75
[2024-11-14 15:15:36,904] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:15:36,904] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 927.07 | bwd_inner_microstep: 924.52 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.25
[2024-11-14 15:15:36,904] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 927.08 | bwd_inner: 924.52 | bwd_allreduce: 2.54 | step: 25.25
[2024-11-14 15:15:38,180] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:15:38,181] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.63 | bwd_microstep: 927.45 | bwd_inner_microstep: 924.79 | bwd_allreduce_microstep: 2.62 | step_microstep: 25.36
[2024-11-14 15:15:38,181] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.62 | bwd: 927.46 | bwd_inner: 924.79 | bwd_allreduce: 2.64 | step: 25.36
[2024-11-14 15:15:39,456] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:15:39,456] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.18 | bwd_inner_microstep: 924.64 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.26
[2024-11-14 15:15:39,456] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 927.18 | bwd_inner: 924.64 | bwd_allreduce: 2.51 | step: 25.26
[2024-11-14 15:15:40,732] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.50
[2024-11-14 15:15:40,732] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 927.10 | bwd_inner_microstep: 924.52 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.89
[2024-11-14 15:15:40,732] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 927.10 | bwd_inner: 924.52 | bwd_allreduce: 2.56 | step: 25.89
[2024-11-14 15:15:42,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:15:42,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.47 | bwd_microstep: 928.00 | bwd_inner_microstep: 925.41 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.35
[2024-11-14 15:15:42,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.46 | bwd: 928.01 | bwd_inner: 925.41 | bwd_allreduce: 2.58 | step: 25.35
[2024-11-14 15:15:43,890] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:15:43,890] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.61 | bwd_microstep: 1359.35 | bwd_inner_microstep: 1356.52 | bwd_allreduce_microstep: 2.80 | step_microstep: 25.92
[2024-11-14 15:15:43,890] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.60 | bwd: 1359.36 | bwd_inner: 1356.51 | bwd_allreduce: 2.82 | step: 25.92
[2024-11-14 15:15:45,166] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.48
[2024-11-14 15:15:45,167] [INFO] [logging.py:96:log_dist] [Rank 0] step=480, skipped=2, lr=[0.00022612550106858797], mom=[(0.9, 0.95)]
[2024-11-14 15:15:45,167] [INFO] [timer.py:259:stop] epoch=0/micro_step=480/global_step=480, RunningAvgSamplesPerSec=775.292844663319, CurrSamplesPerSec=802.9074520087366, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:15:45,167] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 927.93 | bwd_inner_microstep: 925.30 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.77
[2024-11-14 15:15:45,167] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.94 | bwd: 927.93 | bwd_inner: 925.30 | bwd_allreduce: 2.61 | step: 25.77
[2024-11-14 15:15:46,442] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:15:46,443] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.21 | bwd_inner_microstep: 924.65 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:15:46,443] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 927.22 | bwd_inner: 924.65 | bwd_allreduce: 2.54 | step: 25.30
[2024-11-14 15:15:48,023] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:15:48,023] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.43 | bwd_microstep: 1147.41 | bwd_inner_microstep: 1144.51 | bwd_allreduce_microstep: 2.88 | step_microstep: 26.07
[2024-11-14 15:15:48,023] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.42 | bwd: 1147.43 | bwd_inner: 1144.51 | bwd_allreduce: 2.89 | step: 26.07
[2024-11-14 15:15:49,299] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:15:49,299] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.84 | bwd_microstep: 927.18 | bwd_inner_microstep: 924.36 | bwd_allreduce_microstep: 2.79 | step_microstep: 26.35
[2024-11-14 15:15:49,299] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.83 | bwd: 927.18 | bwd_inner: 924.35 | bwd_allreduce: 2.80 | step: 26.35
[2024-11-14 15:15:50,879] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:15:50,879] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.29 | bwd_microstep: 1147.50 | bwd_inner_microstep: 1144.73 | bwd_allreduce_microstep: 2.74 | step_microstep: 26.08
[2024-11-14 15:15:50,879] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.28 | bwd: 1147.51 | bwd_inner: 1144.73 | bwd_allreduce: 2.76 | step: 26.08
[2024-11-14 15:15:52,156] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:15:52,156] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.05 | bwd_microstep: 927.77 | bwd_inner_microstep: 924.93 | bwd_allreduce_microstep: 2.81 | step_microstep: 26.26
[2024-11-14 15:15:52,156] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.04 | bwd: 927.78 | bwd_inner: 924.94 | bwd_allreduce: 2.82 | step: 26.26
[2024-11-14 15:15:53,432] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:15:53,432] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 926.95 | bwd_inner_microstep: 924.36 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.80
[2024-11-14 15:15:53,432] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 926.96 | bwd_inner: 924.36 | bwd_allreduce: 2.57 | step: 25.80
[2024-11-14 15:15:54,708] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:15:54,708] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.27 | bwd_microstep: 927.37 | bwd_inner_microstep: 924.83 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.29
[2024-11-14 15:15:54,708] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.27 | bwd: 927.38 | bwd_inner: 924.82 | bwd_allreduce: 2.53 | step: 25.29
[2024-11-14 15:15:56,287] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:15:56,288] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.56 | bwd_microstep: 1147.79 | bwd_inner_microstep: 1145.20 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.40
[2024-11-14 15:15:56,288] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.55 | bwd: 1147.79 | bwd_inner: 1145.20 | bwd_allreduce: 2.57 | step: 25.40
[2024-11-14 15:15:57,269] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:15:57,269] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.34 | bwd_microstep: 712.25 | bwd_inner_microstep: 709.65 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.33
[2024-11-14 15:15:57,270] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.33 | bwd: 712.26 | bwd_inner: 709.65 | bwd_allreduce: 2.58 | step: 25.34
[2024-11-14 15:15:58,546] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.50
[2024-11-14 15:15:58,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=490, skipped=2, lr=[0.00022678368107598095], mom=[(0.9, 0.95)]
[2024-11-14 15:15:58,546] [INFO] [timer.py:259:stop] epoch=0/micro_step=490/global_step=490, RunningAvgSamplesPerSec=775.0993469426528, CurrSamplesPerSec=802.7947452174974, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:15:58,546] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 927.34 | bwd_inner_microstep: 924.63 | bwd_allreduce_microstep: 2.68 | step_microstep: 26.29
[2024-11-14 15:15:58,547] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.35 | bwd_inner: 924.63 | bwd_allreduce: 2.69 | step: 26.30
[2024-11-14 15:15:59,528] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:15:59,528] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.34 | bwd_microstep: 711.79 | bwd_inner_microstep: 709.25 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.29
[2024-11-14 15:15:59,528] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.34 | bwd: 711.80 | bwd_inner: 709.25 | bwd_allreduce: 2.53 | step: 25.29
[2024-11-14 15:16:00,805] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:16:00,805] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 928.34 | bwd_inner_microstep: 925.71 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.28
[2024-11-14 15:16:00,805] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 928.35 | bwd_inner: 925.71 | bwd_allreduce: 2.61 | step: 25.29
[2024-11-14 15:16:02,080] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:16:02,080] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 927.37 | bwd_inner_microstep: 924.81 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:16:02,081] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 927.37 | bwd_inner: 924.81 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:16:03,063] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:16:03,063] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.52 | bwd_microstep: 712.62 | bwd_inner_microstep: 710.08 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.38
[2024-11-14 15:16:03,063] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.51 | bwd: 712.63 | bwd_inner: 710.08 | bwd_allreduce: 2.52 | step: 25.38
[2024-11-14 15:16:04,641] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:16:04,641] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.24 | bwd_microstep: 1146.54 | bwd_inner_microstep: 1143.87 | bwd_allreduce_microstep: 2.65 | step_microstep: 25.26
[2024-11-14 15:16:04,641] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.23 | bwd: 1146.55 | bwd_inner: 1143.87 | bwd_allreduce: 2.66 | step: 25.26
[2024-11-14 15:16:05,623] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:16:05,623] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.46 | bwd_microstep: 712.29 | bwd_inner_microstep: 709.60 | bwd_allreduce_microstep: 2.66 | step_microstep: 25.42
[2024-11-14 15:16:05,623] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.45 | bwd: 712.30 | bwd_inner: 709.60 | bwd_allreduce: 2.67 | step: 25.42
[2024-11-14 15:16:06,899] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:16:06,899] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.33 | bwd_microstep: 927.07 | bwd_inner_microstep: 924.50 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:16:06,899] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.32 | bwd: 927.07 | bwd_inner: 924.50 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:16:08,174] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:16:08,174] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.90 | bwd_microstep: 926.94 | bwd_inner_microstep: 924.37 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.31
[2024-11-14 15:16:08,174] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.89 | bwd: 926.94 | bwd_inner: 924.37 | bwd_allreduce: 2.55 | step: 25.31
[2024-11-14 15:16:09,449] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:16:09,449] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 926.90 | bwd_inner_microstep: 924.35 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.37
[2024-11-14 15:16:09,450] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 926.90 | bwd_inner: 924.35 | bwd_allreduce: 2.53 | step: 25.37
[2024-11-14 15:16:11,630] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:16:11,630] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=2, lr=[0.0002274285096510759], mom=[(0.9, 0.95)]
[2024-11-14 15:16:11,630] [INFO] [timer.py:259:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=775.262454553272, CurrSamplesPerSec=469.88729234532104, MemAllocated=3.75GB, MaxMemAllocated=15.4GB
[2024-11-14 15:16:11,630] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 578.34 | bwd_microstep: 1575.57 | bwd_inner_microstep: 1572.99 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.58
[2024-11-14 15:16:11,630] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 578.33 | bwd: 1575.57 | bwd_inner: 1572.99 | bwd_allreduce: 2.56 | step: 25.58
[2024-11-14 15:16:12,612] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:16:12,612] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.36 | bwd_microstep: 712.23 | bwd_inner_microstep: 709.65 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.28
[2024-11-14 15:16:12,612] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.35 | bwd: 712.24 | bwd_inner: 709.65 | bwd_allreduce: 2.57 | step: 25.29
[2024-11-14 15:16:12.612665][epoch 0][local 0: 500][global 500] train_loss: 0.6239738, 712.5 samples / 14251 tokens per sec
[2024-11-14 15:16:14,191] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:16:14,191] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.83 | bwd_microstep: 1146.99 | bwd_inner_microstep: 1144.43 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.31
[2024-11-14 15:16:14,192] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.82 | bwd: 1147.00 | bwd_inner: 1144.43 | bwd_allreduce: 2.55 | step: 25.32
[2024-11-14 15:16:16,967] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:16:16,967] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 743.62 | bwd_microstep: 2004.37 | bwd_inner_microstep: 2001.30 | bwd_allreduce_microstep: 3.05 | step_microstep: 25.94
[2024-11-14 15:16:16,967] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 743.62 | bwd: 2004.38 | bwd_inner: 2001.30 | bwd_allreduce: 3.06 | step: 25.95
[2024-11-14 15:16:18,545] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:16:18,546] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.31 | bwd_microstep: 1146.88 | bwd_inner_microstep: 1144.28 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.37
[2024-11-14 15:16:18,546] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.30 | bwd: 1146.89 | bwd_inner: 1144.28 | bwd_allreduce: 2.58 | step: 25.38
[2024-11-14 15:16:19,527] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:16:19,528] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.45 | bwd_microstep: 712.14 | bwd_inner_microstep: 709.53 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.55
[2024-11-14 15:16:19,528] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.44 | bwd: 712.14 | bwd_inner: 709.53 | bwd_allreduce: 2.59 | step: 25.55
[2024-11-14 15:16:20,804] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:16:20,805] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.58 | bwd_inner_microstep: 924.83 | bwd_allreduce_microstep: 2.71 | step_microstep: 25.92
[2024-11-14 15:16:20,805] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.58 | bwd_inner: 924.83 | bwd_allreduce: 2.73 | step: 25.92
[2024-11-14 15:16:22,080] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:16:22,080] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.13 | bwd_inner_microstep: 924.48 | bwd_allreduce_microstep: 2.62 | step_microstep: 25.37
[2024-11-14 15:16:22,080] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.21 | bwd: 927.14 | bwd_inner: 924.48 | bwd_allreduce: 2.63 | step: 25.37
[2024-11-14 15:16:23,356] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:16:23,356] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.36 | bwd_microstep: 927.37 | bwd_inner_microstep: 924.78 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.40
[2024-11-14 15:16:23,356] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.35 | bwd: 927.37 | bwd_inner: 924.78 | bwd_allreduce: 2.57 | step: 25.40
[2024-11-14 15:16:24,935] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:16:24,936] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.47 | bwd_microstep: 1147.02 | bwd_inner_microstep: 1143.96 | bwd_allreduce_microstep: 3.03 | step_microstep: 25.77
[2024-11-14 15:16:24,936] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.47 | bwd: 1147.02 | bwd_inner: 1143.96 | bwd_allreduce: 3.04 | step: 25.77
[2024-11-14 15:16:26,212] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:16:26,212] [INFO] [logging.py:96:log_dist] [Rank 0] step=510, skipped=2, lr=[0.00022806051771947236], mom=[(0.9, 0.95)]
[2024-11-14 15:16:26,212] [INFO] [timer.py:259:stop] epoch=0/micro_step=510/global_step=510, RunningAvgSamplesPerSec=773.6914742838547, CurrSamplesPerSec=802.7462805224764, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:16:26,212] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.05 | bwd_microstep: 927.39 | bwd_inner_microstep: 924.61 | bwd_allreduce_microstep: 2.75 | step_microstep: 26.42
[2024-11-14 15:16:26,213] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.04 | bwd: 927.40 | bwd_inner: 924.61 | bwd_allreduce: 2.77 | step: 26.42
[2024-11-14 15:16:27,488] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:16:27,488] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 927.07 | bwd_inner_microstep: 924.51 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.24
[2024-11-14 15:16:27,488] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.08 | bwd_inner: 924.51 | bwd_allreduce: 2.54 | step: 25.24
[2024-11-14 15:16:28,763] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:16:28,764] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 927.32 | bwd_inner_microstep: 924.75 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.26
[2024-11-14 15:16:28,764] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.27 | bwd: 927.33 | bwd_inner: 924.75 | bwd_allreduce: 2.55 | step: 25.26
[2024-11-14 15:16:30,039] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:16:30,039] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.23 | bwd_microstep: 926.97 | bwd_inner_microstep: 924.39 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.26
[2024-11-14 15:16:30,039] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.22 | bwd: 926.97 | bwd_inner: 924.39 | bwd_allreduce: 2.56 | step: 25.26
[2024-11-14 15:16:31,314] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:16:31,314] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 926.88 | bwd_inner_microstep: 924.32 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:16:31,314] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 926.88 | bwd_inner: 924.32 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:16:32,894] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:16:32,894] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.62 | bwd_microstep: 1147.54 | bwd_inner_microstep: 1144.57 | bwd_allreduce_microstep: 2.94 | step_microstep: 25.99
[2024-11-14 15:16:32,895] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.61 | bwd: 1147.55 | bwd_inner: 1144.57 | bwd_allreduce: 2.95 | step: 25.99
[2024-11-14 15:16:34,171] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:16:34,171] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.84 | bwd_microstep: 927.27 | bwd_inner_microstep: 924.35 | bwd_allreduce_microstep: 2.88 | step_microstep: 26.23
[2024-11-14 15:16:34,171] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.83 | bwd: 927.27 | bwd_inner: 924.35 | bwd_allreduce: 2.90 | step: 26.24
[2024-11-14 15:16:35,446] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:16:35,446] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 926.94 | bwd_inner_microstep: 924.37 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.31
[2024-11-14 15:16:35,446] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 926.95 | bwd_inner: 924.37 | bwd_allreduce: 2.56 | step: 25.31
[2024-11-14 15:16:37,026] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:16:37,026] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.49 | bwd_microstep: 1147.30 | bwd_inner_microstep: 1144.48 | bwd_allreduce_microstep: 2.79 | step_microstep: 25.96
[2024-11-14 15:16:37,026] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.48 | bwd: 1147.31 | bwd_inner: 1144.48 | bwd_allreduce: 2.80 | step: 25.96
[2024-11-14 15:16:38,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:16:38,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.01 | bwd_microstep: 928.00 | bwd_inner_microstep: 925.14 | bwd_allreduce_microstep: 2.83 | step_microstep: 26.06
[2024-11-14 15:16:38,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 928.01 | bwd_inner: 925.14 | bwd_allreduce: 2.84 | step: 26.06
[2024-11-14 15:16:39,579] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:16:39,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=520, skipped=2, lr=[0.00022868020515443563], mom=[(0.9, 0.95)]
[2024-11-14 15:16:39,579] [INFO] [timer.py:259:stop] epoch=0/micro_step=520/global_step=520, RunningAvgSamplesPerSec=773.5544520997433, CurrSamplesPerSec=803.0755955069305, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:16:39,579] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.70 | bwd_inner_microstep: 925.16 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.57
[2024-11-14 15:16:39,580] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 927.71 | bwd_inner: 925.16 | bwd_allreduce: 2.52 | step: 25.57
[2024-11-14 15:16:40,562] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:16:40,562] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.49 | bwd_microstep: 712.67 | bwd_inner_microstep: 710.14 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.90
[2024-11-14 15:16:40,563] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.49 | bwd: 712.67 | bwd_inner: 710.14 | bwd_allreduce: 2.51 | step: 25.90
[2024-11-14 15:16:41,838] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:16:41,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.68 | bwd_inner_microstep: 925.11 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.31
[2024-11-14 15:16:41,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.69 | bwd_inner: 925.11 | bwd_allreduce: 2.55 | step: 25.31
[2024-11-14 15:16:43,114] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:16:43,115] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 927.88 | bwd_inner_microstep: 925.30 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.34
[2024-11-14 15:16:43,115] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.09 | bwd: 927.89 | bwd_inner: 925.30 | bwd_allreduce: 2.56 | step: 25.34
[2024-11-14 15:16:44,390] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:16:44,390] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.14 | bwd_inner_microstep: 924.54 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.46
[2024-11-14 15:16:44,391] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 927.14 | bwd_inner: 924.54 | bwd_allreduce: 2.58 | step: 25.46
[2024-11-14 15:16:45,666] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:16:45,666] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.02 | bwd_microstep: 927.63 | bwd_inner_microstep: 924.99 | bwd_allreduce_microstep: 2.62 | step_microstep: 25.33
[2024-11-14 15:16:45,667] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.01 | bwd: 927.64 | bwd_inner: 924.99 | bwd_allreduce: 2.63 | step: 25.34
[2024-11-14 15:16:46,942] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:16:46,942] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.00 | bwd_inner_microstep: 924.45 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.24
[2024-11-14 15:16:46,942] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.00 | bwd_inner: 924.45 | bwd_allreduce: 2.53 | step: 25.24
[2024-11-14 15:16:48,217] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:16:48,217] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.01 | bwd_microstep: 926.92 | bwd_inner_microstep: 924.34 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.29
[2024-11-14 15:16:48,217] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 926.92 | bwd_inner: 924.34 | bwd_allreduce: 2.56 | step: 25.29
[2024-11-14 15:16:49,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:16:49,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.37 | bwd_microstep: 712.14 | bwd_inner_microstep: 709.50 | bwd_allreduce_microstep: 2.61 | step_microstep: 25.50
[2024-11-14 15:16:49,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.35 | bwd: 712.15 | bwd_inner: 709.50 | bwd_allreduce: 2.62 | step: 25.51
[2024-11-14 15:16:50,475] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:16:50,475] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.34 | bwd_microstep: 927.46 | bwd_inner_microstep: 924.90 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.35
[2024-11-14 15:16:50,475] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.34 | bwd: 927.47 | bwd_inner: 924.90 | bwd_allreduce: 2.55 | step: 25.35
[2024-11-14 15:16:51,751] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:16:51,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=530, skipped=2, lr=[0.00022928804315221289], mom=[(0.9, 0.95)]
[2024-11-14 15:16:51,751] [INFO] [timer.py:259:stop] epoch=0/micro_step=530/global_step=530, RunningAvgSamplesPerSec=774.7475635068481, CurrSamplesPerSec=803.4774733463462, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:16:51,751] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.14 | bwd_microstep: 927.00 | bwd_inner_microstep: 924.42 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.57
[2024-11-14 15:16:51,751] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 927.00 | bwd_inner: 924.42 | bwd_allreduce: 2.56 | step: 25.57
[2024-11-14 15:16:53,027] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:16:53,027] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.19 | bwd_microstep: 927.31 | bwd_inner_microstep: 924.70 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.43
[2024-11-14 15:16:53,028] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.32 | bwd_inner: 924.70 | bwd_allreduce: 2.59 | step: 25.43
[2024-11-14 15:16:54,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:16:54,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 927.17 | bwd_inner_microstep: 924.60 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.33
[2024-11-14 15:16:54,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.17 | bwd_inner: 924.60 | bwd_allreduce: 2.55 | step: 25.33
[2024-11-14 15:16:55,578] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:16:55,579] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.13 | bwd_microstep: 926.87 | bwd_inner_microstep: 924.31 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.49
[2024-11-14 15:16:55,579] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 926.88 | bwd_inner: 924.31 | bwd_allreduce: 2.54 | step: 25.50
[2024-11-14 15:16:56,855] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:16:56,855] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.32 | bwd_microstep: 927.55 | bwd_inner_microstep: 925.01 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:16:56,855] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.31 | bwd: 927.56 | bwd_inner: 925.01 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:16:58,130] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:16:58,131] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 927.56 | bwd_inner_microstep: 924.95 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.48
[2024-11-14 15:16:58,131] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 927.56 | bwd_inner: 924.95 | bwd_allreduce: 2.59 | step: 25.49
[2024-11-14 15:16:59,407] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:16:59,407] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.03 | bwd_microstep: 927.57 | bwd_inner_microstep: 925.02 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.64
[2024-11-14 15:16:59,407] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 927.58 | bwd_inner: 925.02 | bwd_allreduce: 2.54 | step: 25.64
[2024-11-14 15:17:00,684] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:00,684] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.24 | bwd_microstep: 928.61 | bwd_inner_microstep: 926.07 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.30
[2024-11-14 15:17:00,684] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.23 | bwd: 928.62 | bwd_inner: 926.07 | bwd_allreduce: 2.52 | step: 25.30
[2024-11-14 15:17:01,960] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:17:01,960] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.28 | bwd_inner_microstep: 924.71 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.32
[2024-11-14 15:17:01,960] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.29 | bwd_inner: 924.71 | bwd_allreduce: 2.55 | step: 25.32
[2024-11-14 15:17:03,842] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:17:03,842] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.78 | bwd_microstep: 1359.81 | bwd_inner_microstep: 1357.05 | bwd_allreduce_microstep: 2.73 | step_microstep: 26.23
[2024-11-14 15:17:03,842] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.77 | bwd: 1359.82 | bwd_inner: 1357.05 | bwd_allreduce: 2.74 | step: 26.23
[2024-11-14 15:17:04,826] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:04,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=540, skipped=2, lr=[0.00022988447638448275], mom=[(0.9, 0.95)]
[2024-11-14 15:17:04,826] [INFO] [timer.py:259:stop] epoch=0/micro_step=540/global_step=540, RunningAvgSamplesPerSec=774.9144947350654, CurrSamplesPerSec=1041.7721306912563, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:17:04,826] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.14 | bwd_microstep: 711.85 | bwd_inner_microstep: 709.14 | bwd_allreduce_microstep: 2.68 | step_microstep: 28.18
[2024-11-14 15:17:04,826] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.14 | bwd: 711.86 | bwd_inner: 709.14 | bwd_allreduce: 2.69 | step: 28.18
[2024-11-14 15:17:06,102] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:17:06,102] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 927.26 | bwd_inner_microstep: 924.66 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.40
[2024-11-14 15:17:06,102] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.27 | bwd_inner: 924.66 | bwd_allreduce: 2.58 | step: 25.40
[2024-11-14 15:17:07,377] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:17:07,377] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.04 | bwd_inner_microstep: 924.49 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:17:07,377] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 927.05 | bwd_inner: 924.49 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:17:09,257] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:09,258] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.72 | bwd_microstep: 1358.62 | bwd_inner_microstep: 1355.94 | bwd_allreduce_microstep: 2.65 | step_microstep: 26.01
[2024-11-14 15:17:09,258] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.71 | bwd: 1358.63 | bwd_inner: 1355.94 | bwd_allreduce: 2.67 | step: 26.01
[2024-11-14 15:17:10,836] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:17:10,836] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.28 | bwd_microstep: 1146.92 | bwd_inner_microstep: 1144.36 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.23
[2024-11-14 15:17:10,836] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.27 | bwd: 1146.93 | bwd_inner: 1144.36 | bwd_allreduce: 2.54 | step: 25.23
[2024-11-14 15:17:12,112] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:12,112] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.67 | bwd_microstep: 927.16 | bwd_inner_microstep: 924.49 | bwd_allreduce_microstep: 2.64 | step_microstep: 26.01
[2024-11-14 15:17:12,114] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.67 | bwd: 927.17 | bwd_inner: 924.49 | bwd_allreduce: 2.65 | step: 26.01
[2024-11-14 15:17:13,095] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:13,096] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.23 | bwd_microstep: 712.20 | bwd_inner_microstep: 709.61 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.33
[2024-11-14 15:17:13,096] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.22 | bwd: 712.20 | bwd_inner: 709.61 | bwd_allreduce: 2.57 | step: 25.33
[2024-11-14 15:17:14,371] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:17:14,371] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.03 | bwd_microstep: 926.96 | bwd_inner_microstep: 924.40 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:17:14,371] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 926.96 | bwd_inner: 924.40 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:17:15,646] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:17:15,646] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 927.06 | bwd_inner_microstep: 924.47 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.39
[2024-11-14 15:17:15,646] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 927.06 | bwd_inner: 924.47 | bwd_allreduce: 2.57 | step: 25.40
[2024-11-14 15:17:16,922] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:17:16,922] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 927.17 | bwd_inner_microstep: 924.59 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.38
[2024-11-14 15:17:16,922] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.17 | bwd_inner: 924.59 | bwd_allreduce: 2.56 | step: 25.38
[2024-11-14 15:17:18,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:17:18,199] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=2, lr=[0.00023046992495257], mom=[(0.9, 0.95)]
[2024-11-14 15:17:18,199] [INFO] [timer.py:259:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=774.7580520152163, CurrSamplesPerSec=802.7233256040137, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:17:18,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.19 | bwd_microstep: 928.10 | bwd_inner_microstep: 925.52 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.62
[2024-11-14 15:17:18,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.18 | bwd: 928.10 | bwd_inner: 925.52 | bwd_allreduce: 2.56 | step: 25.62
[2024-11-14 15:17:19,779] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:17:19,780] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.51 | bwd_microstep: 1147.79 | bwd_inner_microstep: 1144.97 | bwd_allreduce_microstep: 2.79 | step_microstep: 26.02
[2024-11-14 15:17:19,780] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.50 | bwd: 1147.80 | bwd_inner: 1144.97 | bwd_allreduce: 2.80 | step: 26.02
[2024-11-14 15:17:21,056] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:17:21,056] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.75 | bwd_microstep: 927.22 | bwd_inner_microstep: 924.45 | bwd_allreduce_microstep: 2.74 | step_microstep: 26.43
[2024-11-14 15:17:21,056] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.74 | bwd: 927.23 | bwd_inner: 924.45 | bwd_allreduce: 2.75 | step: 26.44
[2024-11-14 15:17:22,331] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:17:22,331] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.13 | bwd_microstep: 926.91 | bwd_inner_microstep: 924.39 | bwd_allreduce_microstep: 2.49 | step_microstep: 25.25
[2024-11-14 15:17:22,331] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.13 | bwd: 926.92 | bwd_inner: 924.39 | bwd_allreduce: 2.50 | step: 25.26
[2024-11-14 15:17:23,922] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:17:23,922] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.43 | bwd_microstep: 1147.01 | bwd_inner_microstep: 1144.23 | bwd_allreduce_microstep: 2.75 | step_microstep: 37.44
[2024-11-14 15:17:23,922] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.43 | bwd: 1147.02 | bwd_inner: 1144.23 | bwd_allreduce: 2.76 | step: 37.44
[2024-11-14 15:17:25,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:17:25,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.52 | bwd_microstep: 927.68 | bwd_inner_microstep: 924.80 | bwd_allreduce_microstep: 2.86 | step_microstep: 26.34
[2024-11-14 15:17:25,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.52 | bwd: 927.69 | bwd_inner: 924.80 | bwd_allreduce: 2.87 | step: 26.35
[2024-11-14 15:17:26,475] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:17:26,475] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.25 | bwd_microstep: 927.85 | bwd_inner_microstep: 925.24 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.56
[2024-11-14 15:17:26,476] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.24 | bwd: 927.86 | bwd_inner: 925.24 | bwd_allreduce: 2.59 | step: 25.56
[2024-11-14 15:17:27,752] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:17:27,752] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.80 | bwd_inner_microstep: 925.21 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.37
[2024-11-14 15:17:27,752] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.80 | bwd_inner: 925.21 | bwd_allreduce: 2.57 | step: 25.37
[2024-11-14 15:17:29,028] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:29,028] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.66 | bwd_inner_microstep: 924.99 | bwd_allreduce_microstep: 2.64 | step_microstep: 25.55
[2024-11-14 15:17:29,028] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 927.67 | bwd_inner: 924.99 | bwd_allreduce: 2.66 | step: 25.55
[2024-11-14 15:17:30,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:30,304] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.28 | bwd_inner_microstep: 924.64 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.40
[2024-11-14 15:17:30,304] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.28 | bwd_inner: 924.64 | bwd_allreduce: 2.62 | step: 25.40
[2024-11-14 15:17:31,579] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:17:31,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=560, skipped=2, lr=[0.00023104478616493772], mom=[(0.9, 0.95)]
[2024-11-14 15:17:31,579] [INFO] [timer.py:259:stop] epoch=0/micro_step=560/global_step=560, RunningAvgSamplesPerSec=774.597541642342, CurrSamplesPerSec=803.4113424393481, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:17:31,579] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.88 | bwd_microstep: 927.17 | bwd_inner_microstep: 924.55 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.78
[2024-11-14 15:17:31,580] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.86 | bwd: 927.18 | bwd_inner: 924.55 | bwd_allreduce: 2.61 | step: 25.78
[2024-11-14 15:17:32,856] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:17:32,856] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.72 | bwd_inner_microstep: 925.02 | bwd_allreduce_microstep: 2.66 | step_microstep: 25.65
[2024-11-14 15:17:32,856] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.72 | bwd_inner: 925.02 | bwd_allreduce: 2.68 | step: 25.65
[2024-11-14 15:17:34,132] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:17:34,133] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.46 | bwd_microstep: 927.87 | bwd_inner_microstep: 925.28 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.24
[2024-11-14 15:17:34,133] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.44 | bwd: 927.87 | bwd_inner: 925.28 | bwd_allreduce: 2.57 | step: 25.25
[2024-11-14 15:17:35,408] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:17:35,408] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.92 | bwd_microstep: 927.00 | bwd_inner_microstep: 924.39 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.31
[2024-11-14 15:17:35,408] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.91 | bwd: 927.00 | bwd_inner: 924.39 | bwd_allreduce: 2.58 | step: 25.31
[2024-11-14 15:17:36,683] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:17:36,683] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.90 | bwd_microstep: 926.74 | bwd_inner_microstep: 924.16 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.39
[2024-11-14 15:17:36,683] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.89 | bwd: 926.74 | bwd_inner: 924.16 | bwd_allreduce: 2.56 | step: 25.39
[2024-11-14 15:17:37,959] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:17:37,959] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.30 | bwd_microstep: 927.38 | bwd_inner_microstep: 924.84 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.24
[2024-11-14 15:17:37,959] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.29 | bwd: 927.39 | bwd_inner: 924.84 | bwd_allreduce: 2.52 | step: 25.24
[2024-11-14 15:17:39,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:17:39,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.40 | bwd_microstep: 927.58 | bwd_inner_microstep: 925.03 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:17:39,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.39 | bwd: 927.58 | bwd_inner: 925.03 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:17:40,511] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:40,511] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.68 | bwd_inner_microstep: 925.11 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.32
[2024-11-14 15:17:40,511] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.69 | bwd_inner: 925.11 | bwd_allreduce: 2.56 | step: 25.33
[2024-11-14 15:17:41,493] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:41,493] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.40 | bwd_microstep: 712.15 | bwd_inner_microstep: 709.60 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.36
[2024-11-14 15:17:41,499] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.39 | bwd: 712.16 | bwd_inner: 709.60 | bwd_allreduce: 2.54 | step: 25.36
[2024-11-14 15:17:43,380] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:17:43,380] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.69 | bwd_microstep: 1358.68 | bwd_inner_microstep: 1355.83 | bwd_allreduce_microstep: 2.82 | step_microstep: 26.31
[2024-11-14 15:17:43,380] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.68 | bwd: 1358.69 | bwd_inner: 1355.83 | bwd_allreduce: 2.83 | step: 26.31
[2024-11-14 15:17:44,362] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:17:44,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=570, skipped=2, lr=[0.00023160943615679438], mom=[(0.9, 0.95)]
[2024-11-14 15:17:44,363] [INFO] [timer.py:259:stop] epoch=0/micro_step=570/global_step=570, RunningAvgSamplesPerSec=775.0652672913384, CurrSamplesPerSec=1043.2357347763837, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:17:44,363] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.12 | bwd_microstep: 712.25 | bwd_inner_microstep: 709.24 | bwd_allreduce_microstep: 2.98 | step_microstep: 26.43
[2024-11-14 15:17:44,363] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.11 | bwd: 712.25 | bwd_inner: 709.24 | bwd_allreduce: 2.99 | step: 26.43
[2024-11-14 15:17:45,344] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:17:45,344] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.38 | bwd_microstep: 712.09 | bwd_inner_microstep: 709.49 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.46
[2024-11-14 15:17:45,345] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.37 | bwd: 712.10 | bwd_inner: 709.49 | bwd_allreduce: 2.58 | step: 25.46
[2024-11-14 15:17:46,620] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:46,621] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.37 | bwd_microstep: 927.57 | bwd_inner_microstep: 924.94 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.36
[2024-11-14 15:17:46,621] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.35 | bwd: 927.58 | bwd_inner: 924.94 | bwd_allreduce: 2.61 | step: 25.37
[2024-11-14 15:17:47,897] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:17:47,897] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.30 | bwd_microstep: 927.16 | bwd_inner_microstep: 924.59 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.36
[2024-11-14 15:17:47,897] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.29 | bwd: 927.17 | bwd_inner: 924.59 | bwd_allreduce: 2.56 | step: 25.36
[2024-11-14 15:17:49,173] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:49,173] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.00 | bwd_microstep: 926.87 | bwd_inner_microstep: 924.29 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.42
[2024-11-14 15:17:49,173] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.99 | bwd: 926.88 | bwd_inner: 924.29 | bwd_allreduce: 2.57 | step: 25.42
[2024-11-14 15:17:50,448] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:17:50,449] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 927.31 | bwd_inner_microstep: 924.76 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.23
[2024-11-14 15:17:50,449] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 927.31 | bwd_inner: 924.76 | bwd_allreduce: 2.53 | step: 25.23
[2024-11-14 15:17:51,724] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.52
[2024-11-14 15:17:51,724] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 926.83 | bwd_inner_microstep: 924.22 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.58
[2024-11-14 15:17:51,724] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 926.84 | bwd_inner: 924.22 | bwd_allreduce: 2.60 | step: 25.58
[2024-11-14 15:17:52,999] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:17:52,999] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.83 | bwd_microstep: 926.79 | bwd_inner_microstep: 924.22 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.41
[2024-11-14 15:17:53,000] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.82 | bwd: 926.79 | bwd_inner: 924.22 | bwd_allreduce: 2.55 | step: 25.41
[2024-11-14 15:17:54,275] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:17:54,275] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.53 | bwd_microstep: 927.12 | bwd_inner_microstep: 924.58 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.35
[2024-11-14 15:17:54,276] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.53 | bwd: 927.12 | bwd_inner: 924.58 | bwd_allreduce: 2.52 | step: 25.35
[2024-11-14 15:17:55,551] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:17:55,551] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 926.89 | bwd_inner_microstep: 924.36 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.30
[2024-11-14 15:17:55,551] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 926.89 | bwd_inner: 924.36 | bwd_allreduce: 2.51 | step: 25.30
[2024-11-14 15:17:57,130] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:57,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=580, skipped=2, lr=[0.00023216423136835168], mom=[(0.9, 0.95)]
[2024-11-14 15:17:57,131] [INFO] [timer.py:259:stop] epoch=0/micro_step=580/global_step=580, RunningAvgSamplesPerSec=775.5277452940521, CurrSamplesPerSec=648.6119854099843, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:17:57,131] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.43 | bwd_microstep: 1147.32 | bwd_inner_microstep: 1144.35 | bwd_allreduce_microstep: 2.93 | step_microstep: 26.25
[2024-11-14 15:17:57,131] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.42 | bwd: 1147.33 | bwd_inner: 1144.35 | bwd_allreduce: 2.95 | step: 26.25
[2024-11-14 15:17:58,406] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:17:58,406] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.64 | bwd_microstep: 927.16 | bwd_inner_microstep: 924.26 | bwd_allreduce_microstep: 2.87 | step_microstep: 25.81
[2024-11-14 15:17:58,407] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.63 | bwd: 927.17 | bwd_inner: 924.25 | bwd_allreduce: 2.88 | step: 25.81
[2024-11-14 15:17:59,388] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:17:59,388] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.28 | bwd_microstep: 712.01 | bwd_inner_microstep: 709.44 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.27
[2024-11-14 15:17:59,388] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.27 | bwd: 712.02 | bwd_inner: 709.44 | bwd_allreduce: 2.55 | step: 25.27
[2024-11-14 15:18:00,665] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:18:00,665] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.05 | bwd_microstep: 928.71 | bwd_inner_microstep: 926.12 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.48
[2024-11-14 15:18:00,665] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.04 | bwd: 928.72 | bwd_inner: 926.12 | bwd_allreduce: 2.57 | step: 25.48
[2024-11-14 15:18:01,940] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:18:01,940] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 926.97 | bwd_inner_microstep: 924.42 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:18:01,940] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 926.98 | bwd_inner: 924.42 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:18:03,215] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:18:03,215] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 926.85 | bwd_inner_microstep: 924.28 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.31
[2024-11-14 15:18:03,216] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.97 | bwd: 926.86 | bwd_inner: 924.28 | bwd_allreduce: 2.56 | step: 25.31
[2024-11-14 15:18:04,491] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:18:04,492] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.32 | bwd_microstep: 927.31 | bwd_inner_microstep: 924.72 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.30
[2024-11-14 15:18:04,492] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.31 | bwd: 927.31 | bwd_inner: 924.72 | bwd_allreduce: 2.57 | step: 25.30
[2024-11-14 15:18:06,071] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:18:06,071] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.39 | bwd_microstep: 1147.07 | bwd_inner_microstep: 1144.15 | bwd_allreduce_microstep: 2.89 | step_microstep: 26.31
[2024-11-14 15:18:06,072] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.38 | bwd: 1147.07 | bwd_inner: 1144.15 | bwd_allreduce: 2.90 | step: 26.31
[2024-11-14 15:18:07,951] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:18:07,951] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.81 | bwd_microstep: 1358.41 | bwd_inner_microstep: 1355.86 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.24
[2024-11-14 15:18:07,951] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.80 | bwd: 1358.42 | bwd_inner: 1355.86 | bwd_allreduce: 2.54 | step: 25.24
[2024-11-14 15:18:08,934] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:18:08,934] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.21 | bwd_microstep: 712.30 | bwd_inner_microstep: 709.49 | bwd_allreduce_microstep: 2.78 | step_microstep: 26.26
[2024-11-14 15:18:08,934] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.21 | bwd: 712.31 | bwd_inner: 709.49 | bwd_allreduce: 2.79 | step: 26.26
[2024-11-14 15:18:10,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:18:10,512] [INFO] [logging.py:96:log_dist] [Rank 0] step=590, skipped=2, lr=[0.00023270950989628218], mom=[(0.9, 0.95)]
[2024-11-14 15:18:10,512] [INFO] [timer.py:259:stop] epoch=0/micro_step=590/global_step=590, RunningAvgSamplesPerSec=775.3610616547537, CurrSamplesPerSec=649.2683347288148, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:18:10,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.22 | bwd_microstep: 1146.51 | bwd_inner_microstep: 1143.94 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.66
[2024-11-14 15:18:10,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.22 | bwd: 1146.52 | bwd_inner: 1143.94 | bwd_allreduce: 2.56 | step: 25.66
[2024-11-14 15:18:11,789] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.52
[2024-11-14 15:18:11,789] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.89 | bwd_microstep: 927.73 | bwd_inner_microstep: 924.82 | bwd_allreduce_microstep: 2.88 | step_microstep: 26.34
[2024-11-14 15:18:11,789] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.88 | bwd: 927.74 | bwd_inner: 924.82 | bwd_allreduce: 2.90 | step: 26.34
[2024-11-14 15:18:12,771] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:18:12,771] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.36 | bwd_microstep: 712.18 | bwd_inner_microstep: 709.61 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.40
[2024-11-14 15:18:12,771] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.35 | bwd: 712.18 | bwd_inner: 709.61 | bwd_allreduce: 2.55 | step: 25.40
[2024-11-14 15:18:14,046] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:18:14,046] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 927.40 | bwd_inner_microstep: 924.83 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.30
[2024-11-14 15:18:14,047] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.97 | bwd: 927.41 | bwd_inner: 924.84 | bwd_allreduce: 2.55 | step: 25.30
[2024-11-14 15:18:15,928] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:18:15,928] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.56 | bwd_microstep: 1358.62 | bwd_inner_microstep: 1355.86 | bwd_allreduce_microstep: 2.73 | step_microstep: 27.59
[2024-11-14 15:18:15,929] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.55 | bwd: 1358.63 | bwd_inner: 1355.86 | bwd_allreduce: 2.74 | step: 27.59
[2024-11-14 15:18:16,923] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.49
[2024-11-14 15:18:16,924] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.31 | bwd_microstep: 712.15 | bwd_inner_microstep: 709.40 | bwd_allreduce_microstep: 2.72 | step_microstep: 38.84
[2024-11-14 15:18:16,924] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.30 | bwd: 712.16 | bwd_inner: 709.40 | bwd_allreduce: 2.73 | step: 38.84
[2024-11-14 15:18:18,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:18:18,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.28 | bwd_inner_microstep: 924.70 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.28
[2024-11-14 15:18:18,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.29 | bwd_inner: 924.70 | bwd_allreduce: 2.56 | step: 25.29
[2024-11-14 15:18:19,181] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:18:19,181] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.32 | bwd_microstep: 712.16 | bwd_inner_microstep: 709.59 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.31
[2024-11-14 15:18:19,181] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.31 | bwd: 712.16 | bwd_inner: 709.59 | bwd_allreduce: 2.55 | step: 25.31
[2024-11-14 15:18:20,457] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:18:20,457] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.23 | bwd_inner_microstep: 924.68 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.26
[2024-11-14 15:18:20,457] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.24 | bwd_inner: 924.68 | bwd_allreduce: 2.54 | step: 25.26
[2024-11-14 15:18:21,732] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:18:21,733] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.04 | bwd_microstep: 927.35 | bwd_inner_microstep: 924.73 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.31
[2024-11-14 15:18:21,733] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.03 | bwd: 927.36 | bwd_inner: 924.73 | bwd_allreduce: 2.61 | step: 25.32
[2024-11-14 15:18:23,008] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:18:23,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=600, skipped=2, lr=[0.00023324559273120963], mom=[(0.9, 0.95)]
[2024-11-14 15:18:23,009] [INFO] [timer.py:259:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=776.0691281077859, CurrSamplesPerSec=803.2723527290277, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:18:23,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.34 | bwd_microstep: 927.20 | bwd_inner_microstep: 924.65 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.49
[2024-11-14 15:18:23,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.33 | bwd: 927.20 | bwd_inner: 924.65 | bwd_allreduce: 2.53 | step: 25.50
[2024-11-14 15:18:24,284] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.50
[2024-11-14 15:18:24,284] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.93 | bwd_microstep: 927.09 | bwd_inner_microstep: 924.48 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.62
[2024-11-14 15:18:24,284] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.92 | bwd: 927.10 | bwd_inner: 924.48 | bwd_allreduce: 2.60 | step: 25.62
[2024-11-14 15:18:24.284952][epoch 0][local 0: 600][global 600] train_loss: 0.3864487, 722.6 samples / 14453 tokens per sec
[2024-11-14 15:18:25,559] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:18:25,560] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 926.75 | bwd_inner_microstep: 924.21 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:18:25,560] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 926.76 | bwd_inner: 924.21 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:18:27,139] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:18:27,139] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.32 | bwd_microstep: 1146.76 | bwd_inner_microstep: 1143.99 | bwd_allreduce_microstep: 2.74 | step_microstep: 25.93
[2024-11-14 15:18:27,139] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.31 | bwd: 1146.77 | bwd_inner: 1143.99 | bwd_allreduce: 2.75 | step: 25.93
[2024-11-14 15:18:28,416] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:18:28,417] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 928.06 | bwd_inner_microstep: 925.21 | bwd_allreduce_microstep: 2.82 | step_microstep: 26.60
[2024-11-14 15:18:28,417] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 928.07 | bwd_inner: 925.21 | bwd_allreduce: 2.83 | step: 26.60
[2024-11-14 15:18:29,693] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:18:29,693] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 928.00 | bwd_inner_microstep: 925.42 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.33
[2024-11-14 15:18:29,693] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.27 | bwd: 928.01 | bwd_inner: 925.42 | bwd_allreduce: 2.56 | step: 25.33
[2024-11-14 15:18:31,273] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:18:31,273] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.40 | bwd_microstep: 1147.14 | bwd_inner_microstep: 1144.33 | bwd_allreduce_microstep: 2.78 | step_microstep: 26.33
[2024-11-14 15:18:31,273] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.40 | bwd: 1147.15 | bwd_inner: 1144.33 | bwd_allreduce: 2.79 | step: 26.33
[2024-11-14 15:18:32,549] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.51
[2024-11-14 15:18:32,549] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.72 | bwd_microstep: 927.13 | bwd_inner_microstep: 924.33 | bwd_allreduce_microstep: 2.76 | step_microstep: 26.47
[2024-11-14 15:18:32,549] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.72 | bwd: 927.13 | bwd_inner: 924.33 | bwd_allreduce: 2.78 | step: 26.47
[2024-11-14 15:18:33,825] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.48
[2024-11-14 15:18:33,826] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.41 | bwd_microstep: 927.47 | bwd_inner_microstep: 924.89 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.50
[2024-11-14 15:18:33,826] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.40 | bwd: 927.48 | bwd_inner: 924.89 | bwd_allreduce: 2.56 | step: 25.50
[2024-11-14 15:18:35,101] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:18:35,101] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.97 | bwd_microstep: 926.90 | bwd_inner_microstep: 924.25 | bwd_allreduce_microstep: 2.61 | step_microstep: 25.31
[2024-11-14 15:18:35,101] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.97 | bwd: 926.90 | bwd_inner: 924.25 | bwd_allreduce: 2.62 | step: 25.31
[2024-11-14 15:18:36,376] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:18:36,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=610, skipped=2, lr=[0.00023377278489257298], mom=[(0.9, 0.95)]
[2024-11-14 15:18:36,377] [INFO] [timer.py:259:stop] epoch=0/micro_step=610/global_step=610, RunningAvgSamplesPerSec=775.9119225985642, CurrSamplesPerSec=803.4462101062873, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:18:36,377] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 927.17 | bwd_inner_microstep: 924.59 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.57
[2024-11-14 15:18:36,377] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 927.17 | bwd_inner: 924.60 | bwd_allreduce: 2.55 | step: 25.58
[2024-11-14 15:18:37,962] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:18:37,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.27 | bwd_microstep: 1146.77 | bwd_inner_microstep: 1143.93 | bwd_allreduce_microstep: 2.80 | step_microstep: 32.95
[2024-11-14 15:18:37,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.26 | bwd: 1146.77 | bwd_inner: 1143.93 | bwd_allreduce: 2.82 | step: 32.95
[2024-11-14 15:18:39,240] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:18:39,240] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.05 | bwd_microstep: 927.89 | bwd_inner_microstep: 925.04 | bwd_allreduce_microstep: 2.81 | step_microstep: 26.47
[2024-11-14 15:18:39,240] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.04 | bwd: 927.90 | bwd_inner: 925.04 | bwd_allreduce: 2.82 | step: 26.47
[2024-11-14 15:18:40,222] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:18:40,222] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.36 | bwd_microstep: 712.48 | bwd_inner_microstep: 709.88 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.54
[2024-11-14 15:18:40,223] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.35 | bwd: 712.49 | bwd_inner: 709.88 | bwd_allreduce: 2.58 | step: 25.54
[2024-11-14 15:18:41,498] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:18:41,498] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.43 | bwd_inner_microstep: 924.90 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.22
[2024-11-14 15:18:41,498] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.43 | bwd_inner: 924.90 | bwd_allreduce: 2.51 | step: 25.22
[2024-11-14 15:18:42,479] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:18:42,479] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.31 | bwd_microstep: 711.54 | bwd_inner_microstep: 709.01 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.21
[2024-11-14 15:18:42,479] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.31 | bwd: 711.55 | bwd_inner: 709.01 | bwd_allreduce: 2.51 | step: 25.22
[2024-11-14 15:18:43,754] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:18:43,754] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.87 | bwd_microstep: 927.34 | bwd_inner_microstep: 924.79 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.20
[2024-11-14 15:18:43,755] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.86 | bwd: 927.35 | bwd_inner: 924.79 | bwd_allreduce: 2.54 | step: 25.20
[2024-11-14 15:18:45,334] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:18:45,334] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.10 | bwd_microstep: 1147.22 | bwd_inner_microstep: 1144.29 | bwd_allreduce_microstep: 2.90 | step_microstep: 26.07
[2024-11-14 15:18:45,334] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.09 | bwd: 1147.23 | bwd_inner: 1144.29 | bwd_allreduce: 2.91 | step: 26.07
[2024-11-14 15:18:46,610] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:18:46,610] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 927.28 | bwd_inner_microstep: 924.53 | bwd_allreduce_microstep: 2.72 | step_microstep: 26.01
[2024-11-14 15:18:46,610] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 927.29 | bwd_inner: 924.53 | bwd_allreduce: 2.73 | step: 26.02
[2024-11-14 15:18:47,886] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:18:47,886] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.46 | bwd_inner_microstep: 924.90 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:18:47,886] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 927.47 | bwd_inner: 924.91 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:18:49,160] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:18:49,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=620, skipped=2, lr=[0.00023429137647091122], mom=[(0.9, 0.95)]
[2024-11-14 15:18:49,161] [INFO] [timer.py:259:stop] epoch=0/micro_step=620/global_step=620, RunningAvgSamplesPerSec=776.3148696439553, CurrSamplesPerSec=803.9709429734518, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:18:49,161] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.78 | bwd_microstep: 926.61 | bwd_inner_microstep: 924.07 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.52
[2024-11-14 15:18:49,161] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.78 | bwd: 926.62 | bwd_inner: 924.07 | bwd_allreduce: 2.52 | step: 25.52
[2024-11-14 15:18:50,436] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:18:50,436] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.03 | bwd_inner_microstep: 924.41 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.38
[2024-11-14 15:18:50,436] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 927.03 | bwd_inner: 924.41 | bwd_allreduce: 2.60 | step: 25.38
[2024-11-14 15:18:51,713] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:18:51,713] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.48 | bwd_microstep: 927.81 | bwd_inner_microstep: 925.23 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.32
[2024-11-14 15:18:51,713] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.47 | bwd: 927.82 | bwd_inner: 925.23 | bwd_allreduce: 2.56 | step: 25.32
[2024-11-14 15:18:53,292] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:18:53,292] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.22 | bwd_microstep: 1146.93 | bwd_inner_microstep: 1144.01 | bwd_allreduce_microstep: 2.89 | step_microstep: 25.86
[2024-11-14 15:18:53,292] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.21 | bwd: 1146.94 | bwd_inner: 1144.01 | bwd_allreduce: 2.90 | step: 25.86
[2024-11-14 15:18:55,471] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:18:55,472] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 578.23 | bwd_microstep: 1574.83 | bwd_inner_microstep: 1571.95 | bwd_allreduce_microstep: 2.84 | step_microstep: 25.31
[2024-11-14 15:18:55,472] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 578.22 | bwd: 1574.83 | bwd_inner: 1571.95 | bwd_allreduce: 2.86 | step: 25.32
[2024-11-14 15:18:56,746] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:18:56,747] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.65 | bwd_microstep: 926.77 | bwd_inner_microstep: 924.15 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.35
[2024-11-14 15:18:56,747] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.65 | bwd: 926.78 | bwd_inner: 924.15 | bwd_allreduce: 2.60 | step: 25.35
[2024-11-14 15:18:57,728] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:18:57,728] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.46 | bwd_microstep: 712.12 | bwd_inner_microstep: 709.58 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.24
[2024-11-14 15:18:57,728] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.45 | bwd: 712.12 | bwd_inner: 709.58 | bwd_allreduce: 2.52 | step: 25.24
[2024-11-14 15:18:59,003] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:18:59,004] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 927.03 | bwd_inner_microstep: 924.48 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.22
[2024-11-14 15:18:59,004] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 927.04 | bwd_inner: 924.48 | bwd_allreduce: 2.53 | step: 25.23
[2024-11-14 15:19:00,280] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:19:00,281] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.19 | bwd_microstep: 928.33 | bwd_inner_microstep: 925.77 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.31
[2024-11-14 15:19:00,281] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.18 | bwd: 928.34 | bwd_inner: 925.77 | bwd_allreduce: 2.55 | step: 25.32
[2024-11-14 15:19:01,860] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:19:01,860] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.36 | bwd_microstep: 1146.82 | bwd_inner_microstep: 1144.05 | bwd_allreduce_microstep: 2.73 | step_microstep: 26.01
[2024-11-14 15:19:01,860] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.35 | bwd: 1146.82 | bwd_inner: 1144.05 | bwd_allreduce: 2.75 | step: 26.01
[2024-11-14 15:19:03,136] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:19:03,136] [INFO] [logging.py:96:log_dist] [Rank 0] step=630, skipped=2, lr=[0.00023480164358648687], mom=[(0.9, 0.95)]
[2024-11-14 15:19:03,136] [INFO] [timer.py:259:stop] epoch=0/micro_step=630/global_step=630, RunningAvgSamplesPerSec=775.5899612070571, CurrSamplesPerSec=802.9287663045756, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:19:03,136] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 927.41 | bwd_inner_microstep: 924.51 | bwd_allreduce_microstep: 2.86 | step_microstep: 26.00
[2024-11-14 15:19:03,136] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.41 | bwd_inner: 924.51 | bwd_allreduce: 2.87 | step: 26.00
[2024-11-14 15:19:04,411] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:19:04,411] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.96 | bwd_microstep: 926.75 | bwd_inner_microstep: 924.19 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.25
[2024-11-14 15:19:04,411] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.96 | bwd: 926.76 | bwd_inner: 924.19 | bwd_allreduce: 2.54 | step: 25.26
[2024-11-14 15:19:05,686] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:19:05,687] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.02 | bwd_microstep: 927.09 | bwd_inner_microstep: 924.38 | bwd_allreduce_microstep: 2.69 | step_microstep: 25.24
[2024-11-14 15:19:05,687] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 927.10 | bwd_inner: 924.38 | bwd_allreduce: 2.70 | step: 25.24
[2024-11-14 15:19:06,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:19:06,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 927.41 | bwd_inner_microstep: 924.79 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.39
[2024-11-14 15:19:06,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.41 | bwd_inner: 924.79 | bwd_allreduce: 2.60 | step: 25.39
[2024-11-14 15:19:08,238] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:19:08,238] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.97 | bwd_microstep: 927.08 | bwd_inner_microstep: 924.47 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.34
[2024-11-14 15:19:08,238] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.96 | bwd: 927.08 | bwd_inner: 924.47 | bwd_allreduce: 2.59 | step: 25.34
[2024-11-14 15:19:09,514] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:19:09,514] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.30 | bwd_microstep: 927.20 | bwd_inner_microstep: 924.64 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.35
[2024-11-14 15:19:09,514] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.29 | bwd: 927.20 | bwd_inner: 924.64 | bwd_allreduce: 2.54 | step: 25.35
[2024-11-14 15:19:10,789] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:19:10,789] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.13 | bwd_microstep: 926.86 | bwd_inner_microstep: 924.29 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.25
[2024-11-14 15:19:10,789] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 926.86 | bwd_inner: 924.29 | bwd_allreduce: 2.55 | step: 25.26
[2024-11-14 15:19:12,065] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:19:12,065] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 927.24 | bwd_inner_microstep: 924.66 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.45
[2024-11-14 15:19:12,065] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.27 | bwd: 927.25 | bwd_inner: 924.66 | bwd_allreduce: 2.56 | step: 25.45
[2024-11-14 15:19:13,643] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:19:13,644] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.58 | bwd_microstep: 1146.34 | bwd_inner_microstep: 1143.70 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.47
[2024-11-14 15:19:13,644] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.57 | bwd: 1146.35 | bwd_inner: 1143.70 | bwd_allreduce: 2.62 | step: 25.47
[2024-11-14 15:19:14,919] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:19:14,920] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.08 | bwd_microstep: 927.21 | bwd_inner_microstep: 924.46 | bwd_allreduce_microstep: 2.72 | step_microstep: 25.93
[2024-11-14 15:19:14,920] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.07 | bwd: 927.22 | bwd_inner: 924.46 | bwd_allreduce: 2.73 | step: 25.93
[2024-11-14 15:19:16,499] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:19:16,499] [INFO] [logging.py:96:log_dist] [Rank 0] step=640, skipped=2, lr=[0.00023530384927217854], mom=[(0.9, 0.95)]
[2024-11-14 15:19:16,499] [INFO] [timer.py:259:stop] epoch=0/micro_step=640/global_step=640, RunningAvgSamplesPerSec=775.4518720960626, CurrSamplesPerSec=648.677129547694, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:19:16,500] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.40 | bwd_microstep: 1147.06 | bwd_inner_microstep: 1144.21 | bwd_allreduce_microstep: 2.83 | step_microstep: 26.37
[2024-11-14 15:19:16,500] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.39 | bwd: 1147.07 | bwd_inner: 1144.21 | bwd_allreduce: 2.84 | step: 26.37
[2024-11-14 15:19:17,776] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:19:17,776] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.22 | bwd_microstep: 927.33 | bwd_inner_microstep: 924.59 | bwd_allreduce_microstep: 2.71 | step_microstep: 26.26
[2024-11-14 15:19:17,776] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.21 | bwd: 927.34 | bwd_inner: 924.59 | bwd_allreduce: 2.73 | step: 26.26
[2024-11-14 15:19:19,051] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:19:19,052] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.03 | bwd_inner_microstep: 924.46 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.32
[2024-11-14 15:19:19,052] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 927.04 | bwd_inner: 924.46 | bwd_allreduce: 2.56 | step: 25.32
[2024-11-14 15:19:20,327] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:19:20,327] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 926.92 | bwd_inner_microstep: 924.34 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.32
[2024-11-14 15:19:20,327] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 926.93 | bwd_inner: 924.34 | bwd_allreduce: 2.56 | step: 25.32
[2024-11-14 15:19:21,603] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:19:21,603] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.43 | bwd_microstep: 927.28 | bwd_inner_microstep: 924.70 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.40
[2024-11-14 15:19:21,603] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.43 | bwd: 927.28 | bwd_inner: 924.70 | bwd_allreduce: 2.56 | step: 25.41
[2024-11-14 15:19:22,879] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:19:22,879] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.25 | bwd_inner_microstep: 924.67 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.33
[2024-11-14 15:19:22,879] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.26 | bwd_inner: 924.67 | bwd_allreduce: 2.56 | step: 25.34
[2024-11-14 15:19:24,459] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:19:24,459] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.41 | bwd_microstep: 1147.33 | bwd_inner_microstep: 1144.36 | bwd_allreduce_microstep: 2.94 | step_microstep: 25.89
[2024-11-14 15:19:24,459] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.40 | bwd: 1147.34 | bwd_inner: 1144.36 | bwd_allreduce: 2.96 | step: 25.89
[2024-11-14 15:19:26,038] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:19:26,038] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.72 | bwd_microstep: 1147.02 | bwd_inner_microstep: 1144.50 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.28
[2024-11-14 15:19:26,038] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.71 | bwd: 1147.03 | bwd_inner: 1144.50 | bwd_allreduce: 2.51 | step: 25.29
[2024-11-14 15:19:27,314] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:19:27,315] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.23 | bwd_microstep: 927.60 | bwd_inner_microstep: 924.92 | bwd_allreduce_microstep: 2.65 | step_microstep: 25.87
[2024-11-14 15:19:27,315] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.22 | bwd: 927.60 | bwd_inner: 924.91 | bwd_allreduce: 2.66 | step: 25.88
[2024-11-14 15:19:28,590] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:19:28,590] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.09 | bwd_inner_microstep: 924.53 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.22
[2024-11-14 15:19:28,590] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 927.09 | bwd_inner: 924.53 | bwd_allreduce: 2.54 | step: 25.22
[2024-11-14 15:19:30,175] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:19:30,175] [INFO] [logging.py:96:log_dist] [Rank 0] step=650, skipped=2, lr=[0.00023579824428771086], mom=[(0.9, 0.95)]
[2024-11-14 15:19:30,176] [INFO] [timer.py:259:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=775.0348897730039, CurrSamplesPerSec=646.3120461175362, MemAllocated=3.75GB, MaxMemAllocated=15.4GB
[2024-11-14 15:19:30,176] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.64 | bwd_microstep: 1147.41 | bwd_inner_microstep: 1144.63 | bwd_allreduce_microstep: 2.74 | step_microstep: 31.56
[2024-11-14 15:19:30,176] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.63 | bwd: 1147.42 | bwd_inner: 1144.64 | bwd_allreduce: 2.76 | step: 31.56
[2024-11-14 15:19:31,157] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:19:31,157] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.14 | bwd_microstep: 711.76 | bwd_inner_microstep: 709.21 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.27
[2024-11-14 15:19:31,157] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.13 | bwd: 711.76 | bwd_inner: 709.22 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:19:32,433] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:19:32,433] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.46 | bwd_microstep: 927.33 | bwd_inner_microstep: 924.76 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.34
[2024-11-14 15:19:32,433] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.45 | bwd: 927.34 | bwd_inner: 924.76 | bwd_allreduce: 2.56 | step: 25.35
[2024-11-14 15:19:33,708] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:19:33,708] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.96 | bwd_microstep: 927.24 | bwd_inner_microstep: 924.68 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.43
[2024-11-14 15:19:33,709] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.95 | bwd: 927.25 | bwd_inner: 924.68 | bwd_allreduce: 2.55 | step: 25.43
[2024-11-14 15:19:34,690] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:19:34,690] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.38 | bwd_microstep: 712.00 | bwd_inner_microstep: 709.44 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:19:34,690] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.37 | bwd: 712.00 | bwd_inner: 709.45 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:19:36,268] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:19:36,269] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.34 | bwd_microstep: 1146.96 | bwd_inner_microstep: 1144.39 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.36
[2024-11-14 15:19:36,269] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.33 | bwd: 1146.97 | bwd_inner: 1144.39 | bwd_allreduce: 2.55 | step: 25.37
[2024-11-14 15:19:37,848] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:19:37,849] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.58 | bwd_microstep: 1147.28 | bwd_inner_microstep: 1144.49 | bwd_allreduce_microstep: 2.75 | step_microstep: 25.95
[2024-11-14 15:19:37,849] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.57 | bwd: 1147.29 | bwd_inner: 1144.49 | bwd_allreduce: 2.77 | step: 25.95
[2024-11-14 15:19:39,124] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:19:39,125] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.82 | bwd_microstep: 927.42 | bwd_inner_microstep: 924.68 | bwd_allreduce_microstep: 2.71 | step_microstep: 26.02
[2024-11-14 15:19:39,125] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.82 | bwd: 927.43 | bwd_inner: 924.68 | bwd_allreduce: 2.72 | step: 26.02
[2024-11-14 15:19:40,401] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.50
[2024-11-14 15:19:40,401] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.03 | bwd_microstep: 927.64 | bwd_inner_microstep: 925.05 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.70
[2024-11-14 15:19:40,401] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 927.65 | bwd_inner: 925.04 | bwd_allreduce: 2.58 | step: 25.70
[2024-11-14 15:19:41,677] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:19:41,677] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.38 | bwd_inner_microstep: 924.84 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.21
[2024-11-14 15:19:41,677] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.38 | bwd_inner: 924.84 | bwd_allreduce: 2.52 | step: 25.21
[2024-11-14 15:19:43,256] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:19:43,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=660, skipped=2, lr=[0.00023628506787153156], mom=[(0.9, 0.95)]
[2024-11-14 15:19:43,256] [INFO] [timer.py:259:stop] epoch=0/micro_step=660/global_step=660, RunningAvgSamplesPerSec=775.1612337393165, CurrSamplesPerSec=648.8093192894003, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:19:43,257] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.38 | bwd_microstep: 1146.93 | bwd_inner_microstep: 1144.21 | bwd_allreduce_microstep: 2.69 | step_microstep: 26.20
[2024-11-14 15:19:43,257] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.37 | bwd: 1146.94 | bwd_inner: 1144.21 | bwd_allreduce: 2.70 | step: 26.21
[2024-11-14 15:19:44,238] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:19:44,238] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.45 | bwd_microstep: 712.12 | bwd_inner_microstep: 709.54 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.31
[2024-11-14 15:19:44,238] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.44 | bwd: 712.12 | bwd_inner: 709.54 | bwd_allreduce: 2.55 | step: 25.32
[2024-11-14 15:19:45,514] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:19:45,514] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 927.04 | bwd_inner_microstep: 924.50 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:19:45,514] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 927.05 | bwd_inner: 924.50 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:19:46,788] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:19:46,789] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.90 | bwd_microstep: 926.65 | bwd_inner_microstep: 924.09 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.29
[2024-11-14 15:19:46,789] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.89 | bwd: 926.66 | bwd_inner: 924.09 | bwd_allreduce: 2.55 | step: 25.29
[2024-11-14 15:19:48,064] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:19:48,064] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.96 | bwd_microstep: 927.01 | bwd_inner_microstep: 924.45 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.39
[2024-11-14 15:19:48,064] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.95 | bwd: 927.01 | bwd_inner: 924.45 | bwd_allreduce: 2.54 | step: 25.39
[2024-11-14 15:19:49,339] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:19:49,340] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.38 | bwd_inner_microstep: 924.82 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.24
[2024-11-14 15:19:49,340] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 927.39 | bwd_inner: 924.82 | bwd_allreduce: 2.54 | step: 25.24
[2024-11-14 15:19:50,615] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:19:50,615] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.09 | bwd_inner_microstep: 924.55 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.24
[2024-11-14 15:19:50,615] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.10 | bwd_inner: 924.55 | bwd_allreduce: 2.52 | step: 25.24
[2024-11-14 15:19:51,890] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:19:51,891] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 927.27 | bwd_inner_microstep: 924.72 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.26
[2024-11-14 15:19:51,891] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.28 | bwd_inner: 924.72 | bwd_allreduce: 2.54 | step: 25.26
[2024-11-14 15:19:53,165] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:19:53,165] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.97 | bwd_microstep: 926.51 | bwd_inner_microstep: 923.97 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.33
[2024-11-14 15:19:53,165] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.96 | bwd: 926.52 | bwd_inner: 923.97 | bwd_allreduce: 2.52 | step: 25.33
[2024-11-14 15:19:54,441] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:19:54,441] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.19 | bwd_inner_microstep: 924.62 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.31
[2024-11-14 15:19:54,441] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 927.20 | bwd_inner: 924.62 | bwd_allreduce: 2.55 | step: 25.32
[2024-11-14 15:19:55,422] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:19:55,423] [INFO] [logging.py:96:log_dist] [Rank 0] step=670, skipped=2, lr=[0.00023676454843597896], mom=[(0.9, 0.95)]
[2024-11-14 15:19:55,423] [INFO] [timer.py:259:stop] epoch=0/micro_step=670/global_step=670, RunningAvgSamplesPerSec=776.0876728087098, CurrSamplesPerSec=1043.879512090146, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:19:55,423] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.40 | bwd_microstep: 712.30 | bwd_inner_microstep: 709.75 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.49
[2024-11-14 15:19:55,423] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.39 | bwd: 712.31 | bwd_inner: 709.75 | bwd_allreduce: 2.54 | step: 25.50
[2024-11-14 15:19:57,002] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:19:57,002] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.73 | bwd_microstep: 1147.08 | bwd_inner_microstep: 1144.52 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:19:57,002] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.72 | bwd: 1147.08 | bwd_inner: 1144.52 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:19:58,279] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:19:58,279] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.33 | bwd_microstep: 928.00 | bwd_inner_microstep: 925.19 | bwd_allreduce_microstep: 2.78 | step_microstep: 26.03
[2024-11-14 15:19:58,280] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.32 | bwd: 928.00 | bwd_inner: 925.19 | bwd_allreduce: 2.79 | step: 26.03
[2024-11-14 15:20:00,776] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:20:00,777] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 662.33 | bwd_microstep: 1808.19 | bwd_inner_microstep: 1805.61 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.21
[2024-11-14 15:20:00,777] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 662.33 | bwd: 1808.20 | bwd_inner: 1805.62 | bwd_allreduce: 2.56 | step: 25.22
[2024-11-14 15:20:02,052] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:20:02,052] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.07 | bwd_inner_microstep: 924.51 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.33
[2024-11-14 15:20:02,052] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 927.08 | bwd_inner: 924.51 | bwd_allreduce: 2.54 | step: 25.33
[2024-11-14 15:20:03,328] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:20:03,328] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.58 | bwd_microstep: 927.39 | bwd_inner_microstep: 924.85 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.29
[2024-11-14 15:20:03,328] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.57 | bwd: 927.39 | bwd_inner: 924.85 | bwd_allreduce: 2.52 | step: 25.29
[2024-11-14 15:20:04,604] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:20:04,604] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.13 | bwd_inner_microstep: 924.53 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.53
[2024-11-14 15:20:04,604] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.14 | bwd_inner: 924.53 | bwd_allreduce: 2.58 | step: 25.53
[2024-11-14 15:20:05,879] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:20:05,879] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.10 | bwd_microstep: 927.07 | bwd_inner_microstep: 924.33 | bwd_allreduce_microstep: 2.72 | step_microstep: 25.27
[2024-11-14 15:20:05,880] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.08 | bwd_inner: 924.32 | bwd_allreduce: 2.73 | step: 25.27
[2024-11-14 15:20:07,155] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:20:07,155] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.16 | bwd_inner_microstep: 924.58 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.37
[2024-11-14 15:20:07,155] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.11 | bwd: 927.17 | bwd_inner: 924.58 | bwd_allreduce: 2.56 | step: 25.37
[2024-11-14 15:20:08,735] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:20:08,735] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.64 | bwd_microstep: 1147.09 | bwd_inner_microstep: 1144.52 | bwd_allreduce_microstep: 2.54 | step_microstep: 26.34
[2024-11-14 15:20:08,735] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.63 | bwd: 1147.10 | bwd_inner: 1144.52 | bwd_allreduce: 2.56 | step: 26.34
[2024-11-14 15:20:10,614] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:20:10,614] [INFO] [logging.py:96:log_dist] [Rank 0] step=680, skipped=2, lr=[0.00023723690421079686], mom=[(0.9, 0.95)]
[2024-11-14 15:20:10,615] [INFO] [timer.py:259:stop] epoch=0/micro_step=680/global_step=680, RunningAvgSamplesPerSec=774.3680659315896, CurrSamplesPerSec=545.2114757626869, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:20:10,615] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.53 | bwd_microstep: 1358.45 | bwd_inner_microstep: 1355.90 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.42
[2024-11-14 15:20:10,615] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.53 | bwd: 1358.46 | bwd_inner: 1355.90 | bwd_allreduce: 2.53 | step: 25.43
[2024-11-14 15:20:11,889] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:20:11,890] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.92 | bwd_microstep: 926.78 | bwd_inner_microstep: 924.26 | bwd_allreduce_microstep: 2.49 | step_microstep: 25.23
[2024-11-14 15:20:11,890] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.91 | bwd: 926.79 | bwd_inner: 924.26 | bwd_allreduce: 2.50 | step: 25.23
[2024-11-14 15:20:13,165] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:20:13,165] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.32 | bwd_microstep: 927.16 | bwd_inner_microstep: 924.60 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.27
[2024-11-14 15:20:13,165] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.31 | bwd: 927.17 | bwd_inner: 924.60 | bwd_allreduce: 2.55 | step: 25.27
[2024-11-14 15:20:14,441] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:20:14,442] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.31 | bwd_microstep: 927.36 | bwd_inner_microstep: 924.76 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.54
[2024-11-14 15:20:14,442] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.30 | bwd: 927.37 | bwd_inner: 924.76 | bwd_allreduce: 2.58 | step: 25.54
[2024-11-14 15:20:16,021] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:20:16,021] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.12 | bwd_microstep: 1146.67 | bwd_inner_microstep: 1143.73 | bwd_allreduce_microstep: 2.90 | step_microstep: 26.34
[2024-11-14 15:20:16,021] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.11 | bwd: 1146.67 | bwd_inner: 1143.72 | bwd_allreduce: 2.92 | step: 26.34
[2024-11-14 15:20:18,518] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:20:18,518] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 663.02 | bwd_microstep: 1807.45 | bwd_inner_microstep: 1804.89 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.26
[2024-11-14 15:20:18,518] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 663.01 | bwd: 1807.45 | bwd_inner: 1804.89 | bwd_allreduce: 2.54 | step: 25.26
[2024-11-14 15:20:20,097] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:20:20,097] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.36 | bwd_microstep: 1147.10 | bwd_inner_microstep: 1144.51 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.56
[2024-11-14 15:20:20,097] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.36 | bwd: 1147.11 | bwd_inner: 1144.51 | bwd_allreduce: 2.57 | step: 25.56
[2024-11-14 15:20:21,374] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:20:21,374] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.13 | bwd_microstep: 927.43 | bwd_inner_microstep: 924.61 | bwd_allreduce_microstep: 2.79 | step_microstep: 25.96
[2024-11-14 15:20:21,374] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 927.44 | bwd_inner: 924.61 | bwd_allreduce: 2.81 | step: 25.96
[2024-11-14 15:20:22,649] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:20:22,649] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.23 | bwd_inner_microstep: 924.69 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.24
[2024-11-14 15:20:22,650] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.23 | bwd_inner: 924.69 | bwd_allreduce: 2.52 | step: 25.24
[2024-11-14 15:20:23,925] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:20:23,925] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.44 | bwd_inner_microstep: 924.87 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.34
[2024-11-14 15:20:23,925] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.45 | bwd_inner: 924.87 | bwd_allreduce: 2.55 | step: 25.35
[2024-11-14 15:20:25,201] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:20:25,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=690, skipped=2, lr=[0.0002377023438395347], mom=[(0.9, 0.95)]
[2024-11-14 15:20:25,202] [INFO] [timer.py:259:stop] epoch=0/micro_step=690/global_step=690, RunningAvgSamplesPerSec=773.2187537155517, CurrSamplesPerSec=802.9509824088663, MemAllocated=3.75GB, MaxMemAllocated=15.4GB
[2024-11-14 15:20:25,202] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.45 | bwd_microstep: 927.48 | bwd_inner_microstep: 924.92 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.60
[2024-11-14 15:20:25,202] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.45 | bwd: 927.49 | bwd_inner: 924.92 | bwd_allreduce: 2.55 | step: 25.60
[2024-11-14 15:20:26,477] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:20:26,478] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.35 | bwd_microstep: 927.30 | bwd_inner_microstep: 924.76 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.24
[2024-11-14 15:20:26,478] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.34 | bwd: 927.31 | bwd_inner: 924.76 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:20:27,752] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:20:27,752] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.97 | bwd_microstep: 926.66 | bwd_inner_microstep: 924.10 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:20:27,753] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.96 | bwd: 926.67 | bwd_inner: 924.10 | bwd_allreduce: 2.54 | step: 25.30
[2024-11-14 15:20:29,027] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:20:29,028] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 926.94 | bwd_inner_microstep: 924.40 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.33
[2024-11-14 15:20:29,028] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.99 | bwd: 926.95 | bwd_inner: 924.40 | bwd_allreduce: 2.53 | step: 25.33
[2024-11-14 15:20:30,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:20:30,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.20 | bwd_inner_microstep: 924.66 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:20:30,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.21 | bwd_inner: 924.66 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:20:31,578] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:20:31,579] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 926.98 | bwd_inner_microstep: 924.40 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.36
[2024-11-14 15:20:31,579] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.97 | bwd: 926.99 | bwd_inner: 924.40 | bwd_allreduce: 2.56 | step: 25.36
[2024-11-14 15:20:33,459] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:20:33,460] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.66 | bwd_microstep: 1359.11 | bwd_inner_microstep: 1356.36 | bwd_allreduce_microstep: 2.72 | step_microstep: 25.96
[2024-11-14 15:20:33,460] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.65 | bwd: 1359.12 | bwd_inner: 1356.36 | bwd_allreduce: 2.73 | step: 25.96
[2024-11-14 15:20:34,734] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:20:34,735] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.75 | bwd_microstep: 927.00 | bwd_inner_microstep: 924.45 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.23
[2024-11-14 15:20:34,735] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.74 | bwd: 927.01 | bwd_inner: 924.45 | bwd_allreduce: 2.53 | step: 25.23
[2024-11-14 15:20:36,314] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:20:36,314] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.47 | bwd_microstep: 1147.50 | bwd_inner_microstep: 1144.40 | bwd_allreduce_microstep: 3.07 | step_microstep: 25.81
[2024-11-14 15:20:36,314] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.46 | bwd: 1147.51 | bwd_inner: 1144.40 | bwd_allreduce: 3.08 | step: 25.81
[2024-11-14 15:20:37,591] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:20:37,591] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 927.73 | bwd_inner_microstep: 925.04 | bwd_allreduce_microstep: 2.67 | step_microstep: 25.91
[2024-11-14 15:20:37,591] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.97 | bwd: 927.74 | bwd_inner: 925.04 | bwd_allreduce: 2.68 | step: 25.91
[2024-11-14 15:20:39,170] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:20:39,170] [INFO] [logging.py:96:log_dist] [Rank 0] step=700, skipped=2, lr=[0.00023816106693291255], mom=[(0.9, 0.95)]
[2024-11-14 15:20:39,170] [INFO] [timer.py:259:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=772.6209940324665, CurrSamplesPerSec=648.7270005941673, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:20:39,171] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.30 | bwd_microstep: 1147.30 | bwd_inner_microstep: 1144.55 | bwd_allreduce_microstep: 2.72 | step_microstep: 26.12
[2024-11-14 15:20:39,171] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.29 | bwd: 1147.31 | bwd_inner: 1144.55 | bwd_allreduce: 2.73 | step: 26.12
[2024-11-14 15:20:40,152] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:20:40,153] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.47 | bwd_microstep: 712.19 | bwd_inner_microstep: 709.60 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.50
[2024-11-14 15:20:40,153] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.46 | bwd: 712.20 | bwd_inner: 709.60 | bwd_allreduce: 2.57 | step: 25.50
[2024-11-14 15:20:40.153217][epoch 0][local 0: 700][global 700] train_loss: 0.3027331, 726.9 samples / 14538 tokens per sec
[2024-11-14 15:20:41,731] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:20:41,732] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.51 | bwd_microstep: 1146.96 | bwd_inner_microstep: 1144.40 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:20:41,733] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.50 | bwd: 1146.97 | bwd_inner: 1144.40 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:20:43,612] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:20:43,613] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.58 | bwd_microstep: 1357.90 | bwd_inner_microstep: 1355.35 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.54
[2024-11-14 15:20:43,613] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.57 | bwd: 1357.91 | bwd_inner: 1355.35 | bwd_allreduce: 2.54 | step: 25.54
[2024-11-14 15:20:44,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:20:44,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.36 | bwd_microstep: 712.39 | bwd_inner_microstep: 709.70 | bwd_allreduce_microstep: 2.66 | step_microstep: 26.17
[2024-11-14 15:20:44,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.35 | bwd: 712.39 | bwd_inner: 709.70 | bwd_allreduce: 2.67 | step: 26.18
[2024-11-14 15:20:45,871] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:20:45,871] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.28 | bwd_inner_microstep: 924.69 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.37
[2024-11-14 15:20:45,871] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 927.28 | bwd_inner: 924.69 | bwd_allreduce: 2.57 | step: 25.38
[2024-11-14 15:20:47,147] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:20:47,147] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.95 | bwd_microstep: 927.71 | bwd_inner_microstep: 925.16 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:20:47,149] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.95 | bwd: 927.71 | bwd_inner: 925.16 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:20:48,424] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:20:48,425] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 927.22 | bwd_inner_microstep: 924.66 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.31
[2024-11-14 15:20:48,425] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.23 | bwd_inner: 924.66 | bwd_allreduce: 2.55 | step: 25.31
[2024-11-14 15:20:49,699] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:20:49,700] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.93 | bwd_microstep: 926.79 | bwd_inner_microstep: 924.24 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.30
[2024-11-14 15:20:49,700] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.92 | bwd: 926.80 | bwd_inner: 924.24 | bwd_allreduce: 2.53 | step: 25.31
[2024-11-14 15:20:50,975] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:20:50,975] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 926.89 | bwd_inner_microstep: 924.32 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.35
[2024-11-14 15:20:50,975] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 926.89 | bwd_inner: 924.32 | bwd_allreduce: 2.55 | step: 25.36
[2024-11-14 15:20:52,250] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:20:52,250] [INFO] [logging.py:96:log_dist] [Rank 0] step=710, skipped=2, lr=[0.0002386132645828249], mom=[(0.9, 0.95)]
[2024-11-14 15:20:52,250] [INFO] [timer.py:259:stop] epoch=0/micro_step=710/global_step=710, RunningAvgSamplesPerSec=772.775732952497, CurrSamplesPerSec=803.5434648064523, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:20:52,251] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.08 | bwd_microstep: 926.90 | bwd_inner_microstep: 924.32 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.61
[2024-11-14 15:20:52,251] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 926.90 | bwd_inner: 924.32 | bwd_allreduce: 2.55 | step: 25.61
[2024-11-14 15:20:53,526] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.49
[2024-11-14 15:20:53,527] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.47 | bwd_microstep: 927.15 | bwd_inner_microstep: 924.59 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.43
[2024-11-14 15:20:53,527] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.47 | bwd: 927.16 | bwd_inner: 924.59 | bwd_allreduce: 2.55 | step: 25.43
[2024-11-14 15:20:54,508] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:20:54,508] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.45 | bwd_microstep: 712.12 | bwd_inner_microstep: 709.57 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.29
[2024-11-14 15:20:54,508] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.44 | bwd: 712.13 | bwd_inner: 709.57 | bwd_allreduce: 2.53 | step: 25.30
[2024-11-14 15:20:55,784] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:20:55,784] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.25 | bwd_microstep: 927.26 | bwd_inner_microstep: 924.70 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.30
[2024-11-14 15:20:55,784] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.24 | bwd: 927.26 | bwd_inner: 924.70 | bwd_allreduce: 2.54 | step: 25.31
[2024-11-14 15:20:57,060] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:20:57,060] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 927.17 | bwd_inner_microstep: 924.62 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:20:57,060] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.27 | bwd: 927.18 | bwd_inner: 924.62 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:20:58,334] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:20:58,335] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.86 | bwd_microstep: 926.81 | bwd_inner_microstep: 924.24 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.32
[2024-11-14 15:20:58,335] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.86 | bwd: 926.82 | bwd_inner: 924.24 | bwd_allreduce: 2.56 | step: 25.32
[2024-11-14 15:20:59,610] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:20:59,610] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.05 | bwd_microstep: 926.99 | bwd_inner_microstep: 924.44 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:20:59,610] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.04 | bwd: 926.99 | bwd_inner: 924.44 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:21:00,592] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:00,592] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.44 | bwd_microstep: 712.63 | bwd_inner_microstep: 710.07 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:21:00,592] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.44 | bwd: 712.64 | bwd_inner: 710.07 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:21:01,867] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:21:01,868] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 927.14 | bwd_inner_microstep: 924.59 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:21:01,868] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 927.15 | bwd_inner: 924.59 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:21:03,143] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:03,144] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.39 | bwd_microstep: 927.33 | bwd_inner_microstep: 924.78 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.24
[2024-11-14 15:21:03,144] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.39 | bwd: 927.34 | bwd_inner: 924.78 | bwd_allreduce: 2.53 | step: 25.24
[2024-11-14 15:21:04,124] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.75 | optimizer_step: 9.50
[2024-11-14 15:21:04,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=720, skipped=2, lr=[0.0002390591198402953], mom=[(0.9, 0.95)]
[2024-11-14 15:21:04,125] [INFO] [timer.py:259:stop] epoch=0/micro_step=720/global_step=720, RunningAvgSamplesPerSec=773.9034859699351, CurrSamplesPerSec=1044.817820322487, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:21:04,125] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.12 | bwd_microstep: 711.70 | bwd_inner_microstep: 709.15 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.50
[2024-11-14 15:21:04,125] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.11 | bwd: 711.70 | bwd_inner: 709.15 | bwd_allreduce: 2.53 | step: 25.50
[2024-11-14 15:21:05,400] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:05,400] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.05 | bwd_microstep: 927.19 | bwd_inner_microstep: 924.64 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.31
[2024-11-14 15:21:05,400] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.04 | bwd: 927.20 | bwd_inner: 924.64 | bwd_allreduce: 2.54 | step: 25.31
[2024-11-14 15:21:06,381] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:21:06,382] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.19 | bwd_microstep: 711.82 | bwd_inner_microstep: 709.12 | bwd_allreduce_microstep: 2.67 | step_microstep: 25.28
[2024-11-14 15:21:06,382] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.18 | bwd: 711.83 | bwd_inner: 709.12 | bwd_allreduce: 2.68 | step: 25.28
[2024-11-14 15:21:07,657] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:21:07,657] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.01 | bwd_microstep: 927.16 | bwd_inner_microstep: 924.61 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.32
[2024-11-14 15:21:07,657] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 927.17 | bwd_inner: 924.61 | bwd_allreduce: 2.54 | step: 25.32
[2024-11-14 15:21:08,932] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:21:08,932] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.00 | bwd_microstep: 926.87 | bwd_inner_microstep: 924.31 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:21:08,932] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 926.87 | bwd_inner: 924.31 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:21:09,914] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:09,914] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.44 | bwd_microstep: 712.12 | bwd_inner_microstep: 709.55 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.40
[2024-11-14 15:21:09,914] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.43 | bwd: 712.13 | bwd_inner: 709.55 | bwd_allreduce: 2.56 | step: 25.40
[2024-11-14 15:21:11,189] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:21:11,190] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.25 | bwd_microstep: 927.20 | bwd_inner_microstep: 924.64 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.32
[2024-11-14 15:21:11,190] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.24 | bwd: 927.20 | bwd_inner: 924.64 | bwd_allreduce: 2.54 | step: 25.32
[2024-11-14 15:21:12,465] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:21:12,466] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.34 | bwd_microstep: 927.46 | bwd_inner_microstep: 924.90 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.25
[2024-11-14 15:21:12,466] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.33 | bwd: 927.47 | bwd_inner: 924.90 | bwd_allreduce: 2.55 | step: 25.25
[2024-11-14 15:21:13,741] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:21:13,741] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.22 | bwd_microstep: 927.31 | bwd_inner_microstep: 924.77 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.26
[2024-11-14 15:21:13,741] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.21 | bwd: 927.32 | bwd_inner: 924.77 | bwd_allreduce: 2.52 | step: 25.26
[2024-11-14 15:21:15,016] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:21:15,017] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.19 | bwd_microstep: 926.80 | bwd_inner_microstep: 924.25 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:21:15,017] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.18 | bwd: 926.81 | bwd_inner: 924.26 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:21:16,292] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:21:16,292] [INFO] [logging.py:96:log_dist] [Rank 0] step=730, skipped=2, lr=[0.00023949880816037455], mom=[(0.9, 0.95)]
[2024-11-14 15:21:16,293] [INFO] [timer.py:259:stop] epoch=0/micro_step=730/global_step=730, RunningAvgSamplesPerSec=774.7670214575448, CurrSamplesPerSec=803.2299892146053, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:21:16,293] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.25 | bwd_microstep: 927.21 | bwd_inner_microstep: 924.64 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.63
[2024-11-14 15:21:16,293] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.24 | bwd: 927.21 | bwd_inner: 924.64 | bwd_allreduce: 2.55 | step: 25.63
[2024-11-14 15:21:17,568] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:21:17,568] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 927.21 | bwd_inner_microstep: 924.66 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:21:17,569] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.21 | bwd_inner: 924.66 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:21:18,843] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:18,844] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 926.92 | bwd_inner_microstep: 924.37 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:21:18,844] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 926.93 | bwd_inner: 924.37 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:21:20,119] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:21:20,119] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.21 | bwd_inner_microstep: 924.66 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.31
[2024-11-14 15:21:20,119] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.22 | bwd_inner: 924.66 | bwd_allreduce: 2.53 | step: 25.31
[2024-11-14 15:21:22,000] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:21:22,000] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.76 | bwd_microstep: 1358.91 | bwd_inner_microstep: 1356.01 | bwd_allreduce_microstep: 2.87 | step_microstep: 26.34
[2024-11-14 15:21:22,001] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.75 | bwd: 1358.92 | bwd_inner: 1356.01 | bwd_allreduce: 2.88 | step: 26.34
[2024-11-14 15:21:23,276] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:21:23,276] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.17 | bwd_inner_microstep: 924.62 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.24
[2024-11-14 15:21:23,276] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.17 | bwd_inner: 924.62 | bwd_allreduce: 2.53 | step: 25.24
[2024-11-14 15:21:24,552] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:21:24,552] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 927.32 | bwd_inner_microstep: 924.76 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.33
[2024-11-14 15:21:24,552] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.28 | bwd: 927.33 | bwd_inner: 924.76 | bwd_allreduce: 2.54 | step: 25.33
[2024-11-14 15:21:25,827] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:25,827] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.01 | bwd_microstep: 926.83 | bwd_inner_microstep: 924.28 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:21:25,827] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.01 | bwd: 926.83 | bwd_inner: 924.28 | bwd_allreduce: 2.53 | step: 25.29
[2024-11-14 15:21:27,102] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:21:27,102] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.14 | bwd_microstep: 926.88 | bwd_inner_microstep: 924.32 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:21:27,102] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.13 | bwd: 926.89 | bwd_inner: 924.32 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:21:28,983] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:21:28,983] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.77 | bwd_microstep: 1358.69 | bwd_inner_microstep: 1355.85 | bwd_allreduce_microstep: 2.80 | step_microstep: 26.34
[2024-11-14 15:21:28,983] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.77 | bwd: 1358.69 | bwd_inner: 1355.85 | bwd_allreduce: 2.82 | step: 26.34
[2024-11-14 15:21:30,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:21:30,259] [INFO] [logging.py:96:log_dist] [Rank 0] step=740, skipped=2, lr=[0.00023993249781668755], mom=[(0.9, 0.95)]
[2024-11-14 15:21:30,259] [INFO] [timer.py:259:stop] epoch=0/micro_step=740/global_step=740, RunningAvgSamplesPerSec=774.1802836862248, CurrSamplesPerSec=803.1747130503034, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:21:30,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.47 | bwd_inner_microstep: 924.92 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.49
[2024-11-14 15:21:30,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 927.48 | bwd_inner: 924.92 | bwd_allreduce: 2.54 | step: 25.50
[2024-11-14 15:21:31,535] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:21:31,535] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.32 | bwd_inner_microstep: 924.76 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.46
[2024-11-14 15:21:31,535] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.33 | bwd_inner: 924.76 | bwd_allreduce: 2.54 | step: 25.46
[2024-11-14 15:21:32,811] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:21:32,811] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.11 | bwd_inner_microstep: 924.52 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.36
[2024-11-14 15:21:32,811] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 927.11 | bwd_inner: 924.52 | bwd_allreduce: 2.56 | step: 25.36
[2024-11-14 15:21:34,391] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:21:34,391] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.43 | bwd_microstep: 1147.26 | bwd_inner_microstep: 1144.48 | bwd_allreduce_microstep: 2.75 | step_microstep: 26.21
[2024-11-14 15:21:34,391] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.42 | bwd: 1147.27 | bwd_inner: 1144.48 | bwd_allreduce: 2.76 | step: 26.21
[2024-11-14 15:21:35,970] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:21:35,970] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.39 | bwd_microstep: 1147.18 | bwd_inner_microstep: 1144.63 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:21:35,970] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.38 | bwd: 1147.18 | bwd_inner: 1144.63 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:21:37,245] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:21:37,246] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 926.99 | bwd_inner_microstep: 924.32 | bwd_allreduce_microstep: 2.63 | step_microstep: 25.88
[2024-11-14 15:21:37,246] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.97 | bwd: 926.99 | bwd_inner: 924.32 | bwd_allreduce: 2.65 | step: 25.88
[2024-11-14 15:21:38,227] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:38,228] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.46 | bwd_microstep: 712.24 | bwd_inner_microstep: 709.70 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:21:38,228] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.46 | bwd: 712.25 | bwd_inner: 709.70 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:21:39,208] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:21:39,208] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.18 | bwd_microstep: 711.60 | bwd_inner_microstep: 709.05 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:21:39,208] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.17 | bwd: 711.61 | bwd_inner: 709.05 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:21:40,787] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:40,787] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.57 | bwd_microstep: 1147.06 | bwd_inner_microstep: 1144.51 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.36
[2024-11-14 15:21:40,787] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.56 | bwd: 1147.07 | bwd_inner: 1144.51 | bwd_allreduce: 2.53 | step: 25.36
[2024-11-14 15:21:42,064] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:21:42,064] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.27 | bwd_microstep: 927.65 | bwd_inner_microstep: 924.90 | bwd_allreduce_microstep: 2.73 | step_microstep: 26.09
[2024-11-14 15:21:42,065] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.26 | bwd: 927.66 | bwd_inner: 924.90 | bwd_allreduce: 2.74 | step: 26.09
[2024-11-14 15:21:43,341] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:21:43,341] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=2, lr=[0.0002403603502880816], mom=[(0.9, 0.95)]
[2024-11-14 15:21:43,341] [INFO] [timer.py:259:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=774.3018607512508, CurrSamplesPerSec=802.7957956007511, MemAllocated=3.75GB, MaxMemAllocated=15.4GB
[2024-11-14 15:21:43,341] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.41 | bwd_microstep: 927.81 | bwd_inner_microstep: 925.24 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.56
[2024-11-14 15:21:43,341] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.40 | bwd: 927.81 | bwd_inner: 925.24 | bwd_allreduce: 2.55 | step: 25.56
[2024-11-14 15:21:44,617] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:44,617] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 927.74 | bwd_inner_microstep: 925.19 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.31
[2024-11-14 15:21:44,618] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.75 | bwd_inner: 925.19 | bwd_allreduce: 2.53 | step: 25.31
[2024-11-14 15:21:45,599] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:21:45,599] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.22 | bwd_microstep: 712.15 | bwd_inner_microstep: 709.61 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.23
[2024-11-14 15:21:45,599] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.21 | bwd: 712.16 | bwd_inner: 709.61 | bwd_allreduce: 2.52 | step: 25.23
[2024-11-14 15:21:46,581] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:46,581] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.45 | bwd_microstep: 712.36 | bwd_inner_microstep: 709.81 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:21:46,581] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.44 | bwd: 712.37 | bwd_inner: 709.81 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:21:47,858] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:21:47,858] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.69 | bwd_microstep: 928.09 | bwd_inner_microstep: 925.53 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:21:47,858] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.69 | bwd: 928.10 | bwd_inner: 925.53 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:21:49,133] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:21:49,134] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 927.40 | bwd_inner_microstep: 924.86 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.29
[2024-11-14 15:21:49,134] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.11 | bwd: 927.41 | bwd_inner: 924.86 | bwd_allreduce: 2.53 | step: 25.29
[2024-11-14 15:21:50,115] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:50,115] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.17 | bwd_microstep: 712.48 | bwd_inner_microstep: 709.94 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:21:50,116] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.16 | bwd: 712.49 | bwd_inner: 709.94 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:21:51,098] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:51,098] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.57 | bwd_microstep: 712.68 | bwd_inner_microstep: 710.13 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.17
[2024-11-14 15:21:51,098] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.57 | bwd: 712.69 | bwd_inner: 710.13 | bwd_allreduce: 2.53 | step: 25.17
[2024-11-14 15:21:52,374] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:52,374] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 927.68 | bwd_inner_microstep: 925.14 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:21:52,374] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.69 | bwd_inner: 925.14 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:21:53,650] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:21:53,650] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.25 | bwd_microstep: 927.81 | bwd_inner_microstep: 925.24 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.22
[2024-11-14 15:21:53,650] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.24 | bwd: 927.82 | bwd_inner: 925.24 | bwd_allreduce: 2.55 | step: 25.22
[2024-11-14 15:21:54,926] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:21:54,927] [INFO] [logging.py:96:log_dist] [Rank 0] step=760, skipped=2, lr=[0.00024078252061959766], mom=[(0.9, 0.95)]
[2024-11-14 15:21:54,927] [INFO] [timer.py:259:stop] epoch=0/micro_step=760/global_step=760, RunningAvgSamplesPerSec=775.5774293919775, CurrSamplesPerSec=802.7459804497141, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:21:54,927] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.32 | bwd_microstep: 927.68 | bwd_inner_microstep: 925.11 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.87
[2024-11-14 15:21:54,927] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.31 | bwd: 927.69 | bwd_inner: 925.11 | bwd_allreduce: 2.56 | step: 25.87
[2024-11-14 15:21:56,203] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:21:56,203] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.32 | bwd_microstep: 927.59 | bwd_inner_microstep: 925.03 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:21:56,203] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.31 | bwd: 927.59 | bwd_inner: 925.03 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:21:57,479] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:21:57,479] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 927.72 | bwd_inner_microstep: 925.12 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.55
[2024-11-14 15:21:57,480] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 927.72 | bwd_inner: 925.12 | bwd_allreduce: 2.58 | step: 25.56
[2024-11-14 15:21:58,755] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:21:58,755] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.04 | bwd_microstep: 927.40 | bwd_inner_microstep: 924.85 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:21:58,755] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.04 | bwd: 927.40 | bwd_inner: 924.85 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:22:00,032] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:22:00,032] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.31 | bwd_microstep: 928.35 | bwd_inner_microstep: 925.35 | bwd_allreduce_microstep: 2.98 | step_microstep: 25.31
[2024-11-14 15:22:00,032] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.30 | bwd: 928.36 | bwd_inner: 925.35 | bwd_allreduce: 2.99 | step: 25.31
[2024-11-14 15:22:01,308] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:22:01,308] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.19 | bwd_microstep: 927.67 | bwd_inner_microstep: 925.13 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.30
[2024-11-14 15:22:01,308] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.18 | bwd: 927.68 | bwd_inner: 925.13 | bwd_allreduce: 2.53 | step: 25.30
[2024-11-14 15:22:02,583] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:22:02,583] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.00 | bwd_microstep: 926.84 | bwd_inner_microstep: 924.30 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.22
[2024-11-14 15:22:02,583] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.99 | bwd: 926.85 | bwd_inner: 924.30 | bwd_allreduce: 2.53 | step: 25.22
[2024-11-14 15:22:03,859] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:22:03,859] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 927.64 | bwd_inner_microstep: 925.06 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.37
[2024-11-14 15:22:03,859] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 927.65 | bwd_inner: 925.06 | bwd_allreduce: 2.57 | step: 25.37
[2024-11-14 15:22:05,135] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:22:05,136] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.42 | bwd_microstep: 927.71 | bwd_inner_microstep: 925.16 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:22:05,136] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.41 | bwd: 927.72 | bwd_inner: 925.16 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:22:06,412] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:22:06,412] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.31 | bwd_microstep: 927.62 | bwd_inner_microstep: 924.88 | bwd_allreduce_microstep: 2.71 | step_microstep: 25.28
[2024-11-14 15:22:06,412] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.30 | bwd: 927.63 | bwd_inner: 924.89 | bwd_allreduce: 2.72 | step: 25.28
[2024-11-14 15:22:07,688] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:22:07,688] [INFO] [logging.py:96:log_dist] [Rank 0] step=770, skipped=2, lr=[0.0002411991577597853], mom=[(0.9, 0.95)]
[2024-11-14 15:22:07,688] [INFO] [timer.py:259:stop] epoch=0/micro_step=770/global_step=770, RunningAvgSamplesPerSec=775.923499894181, CurrSamplesPerSec=803.0760459858722, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:22:07,688] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.67 | bwd_inner_microstep: 925.10 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.61
[2024-11-14 15:22:07,688] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 927.68 | bwd_inner: 925.10 | bwd_allreduce: 2.55 | step: 25.61
[2024-11-14 15:22:08,670] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:22:08,670] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.44 | bwd_microstep: 712.59 | bwd_inner_microstep: 710.04 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:22:08,670] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.43 | bwd: 712.60 | bwd_inner: 710.04 | bwd_allreduce: 2.53 | step: 25.26
[2024-11-14 15:22:09,946] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:22:09,946] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 927.69 | bwd_inner_microstep: 925.13 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:22:09,946] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 927.70 | bwd_inner: 925.13 | bwd_allreduce: 2.54 | step: 25.30
[2024-11-14 15:22:11,222] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:22:11,222] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 927.65 | bwd_inner_microstep: 925.09 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.33
[2024-11-14 15:22:11,222] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 927.65 | bwd_inner: 925.09 | bwd_allreduce: 2.54 | step: 25.33
[2024-11-14 15:22:12,498] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:22:12,498] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.29 | bwd_microstep: 927.31 | bwd_inner_microstep: 924.75 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.34
[2024-11-14 15:22:12,498] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.29 | bwd: 927.32 | bwd_inner: 924.75 | bwd_allreduce: 2.54 | step: 25.34
[2024-11-14 15:22:14,077] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:22:14,078] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.32 | bwd_microstep: 1146.49 | bwd_inner_microstep: 1143.92 | bwd_allreduce_microstep: 2.54 | step_microstep: 26.37
[2024-11-14 15:22:14,078] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.31 | bwd: 1146.50 | bwd_inner: 1143.92 | bwd_allreduce: 2.56 | step: 26.37
[2024-11-14 15:22:15,354] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.52
[2024-11-14 15:22:15,354] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.00 | bwd_microstep: 927.68 | bwd_inner_microstep: 924.75 | bwd_allreduce_microstep: 2.90 | step_microstep: 26.01
[2024-11-14 15:22:15,354] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 927.69 | bwd_inner: 924.75 | bwd_allreduce: 2.91 | step: 26.01
[2024-11-14 15:22:17,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:22:17,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.55 | bwd_microstep: 1358.98 | bwd_inner_microstep: 1356.20 | bwd_allreduce_microstep: 2.76 | step_microstep: 26.28
[2024-11-14 15:22:17,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.54 | bwd: 1358.99 | bwd_inner: 1356.20 | bwd_allreduce: 2.77 | step: 26.29
[2024-11-14 15:22:18,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:22:18,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 928.29 | bwd_inner_microstep: 925.74 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.29
[2024-11-14 15:22:18,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 928.30 | bwd_inner: 925.74 | bwd_allreduce: 2.53 | step: 25.29
[2024-11-14 15:22:19,787] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:22:19,787] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.05 | bwd_microstep: 926.70 | bwd_inner_microstep: 924.12 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.34
[2024-11-14 15:22:19,787] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.04 | bwd: 926.71 | bwd_inner: 924.12 | bwd_allreduce: 2.57 | step: 25.34
[2024-11-14 15:22:21,368] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:22:21,368] [INFO] [logging.py:96:log_dist] [Rank 0] step=780, skipped=2, lr=[0.00024161040487619693], mom=[(0.9, 0.95)]
[2024-11-14 15:22:21,368] [INFO] [timer.py:259:stop] epoch=0/micro_step=780/global_step=780, RunningAvgSamplesPerSec=775.5665445589543, CurrSamplesPerSec=648.203100872122, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:22:21,368] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.55 | bwd_microstep: 1147.86 | bwd_inner_microstep: 1145.06 | bwd_allreduce_microstep: 2.77 | step_microstep: 26.58
[2024-11-14 15:22:21,368] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.54 | bwd: 1147.87 | bwd_inner: 1145.06 | bwd_allreduce: 2.78 | step: 26.58
[2024-11-14 15:22:22,645] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:22:22,646] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 927.88 | bwd_inner_microstep: 925.07 | bwd_allreduce_microstep: 2.77 | step_microstep: 26.38
[2024-11-14 15:22:22,646] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 927.88 | bwd_inner: 925.07 | bwd_allreduce: 2.79 | step: 26.38
[2024-11-14 15:22:23,921] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:22:23,921] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.14 | bwd_inner_microstep: 924.55 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.34
[2024-11-14 15:22:23,921] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.18 | bwd: 927.14 | bwd_inner: 924.55 | bwd_allreduce: 2.57 | step: 25.34
[2024-11-14 15:22:25,501] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:22:25,502] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.44 | bwd_microstep: 1146.52 | bwd_inner_microstep: 1143.82 | bwd_allreduce_microstep: 2.67 | step_microstep: 27.38
[2024-11-14 15:22:25,502] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.43 | bwd: 1146.52 | bwd_inner: 1143.82 | bwd_allreduce: 2.68 | step: 27.38
[2024-11-14 15:22:26,483] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:22:26,483] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.42 | bwd_microstep: 712.24 | bwd_inner_microstep: 709.49 | bwd_allreduce_microstep: 2.73 | step_microstep: 25.30
[2024-11-14 15:22:26,483] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.41 | bwd: 712.25 | bwd_inner: 709.49 | bwd_allreduce: 2.74 | step: 25.30
[2024-11-14 15:22:27,760] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:22:27,760] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.78 | bwd_microstep: 927.51 | bwd_inner_microstep: 924.95 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.32
[2024-11-14 15:22:27,760] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.77 | bwd: 927.52 | bwd_inner: 924.95 | bwd_allreduce: 2.54 | step: 25.32
[2024-11-14 15:22:29,341] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:22:29,342] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.74 | bwd_microstep: 1147.48 | bwd_inner_microstep: 1144.74 | bwd_allreduce_microstep: 2.71 | step_microstep: 27.47
[2024-11-14 15:22:29,342] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.73 | bwd: 1147.48 | bwd_inner: 1144.74 | bwd_allreduce: 2.72 | step: 27.47
[2024-11-14 15:22:30,620] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:22:30,620] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.00 | bwd_microstep: 927.81 | bwd_inner_microstep: 925.06 | bwd_allreduce_microstep: 2.72 | step_microstep: 27.58
[2024-11-14 15:22:30,620] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 927.82 | bwd_inner: 925.06 | bwd_allreduce: 2.73 | step: 27.59
[2024-11-14 15:22:32,202] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:22:32,202] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.58 | bwd_microstep: 1147.92 | bwd_inner_microstep: 1145.22 | bwd_allreduce_microstep: 2.67 | step_microstep: 27.52
[2024-11-14 15:22:32,202] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.56 | bwd: 1147.93 | bwd_inner: 1145.22 | bwd_allreduce: 2.68 | step: 27.53
[2024-11-14 15:22:33,480] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:22:33,481] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.02 | bwd_microstep: 928.07 | bwd_inner_microstep: 925.34 | bwd_allreduce_microstep: 2.70 | step_microstep: 27.54
[2024-11-14 15:22:33,481] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.01 | bwd: 928.08 | bwd_inner: 925.34 | bwd_allreduce: 2.71 | step: 27.54
[2024-11-14 15:22:34,756] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:22:34,756] [INFO] [logging.py:96:log_dist] [Rank 0] step=790, skipped=2, lr=[0.00024201639965073406], mom=[(0.9, 0.95)]
[2024-11-14 15:22:34,757] [INFO] [timer.py:259:stop] epoch=0/micro_step=790/global_step=790, RunningAvgSamplesPerSec=775.4362040855275, CurrSamplesPerSec=803.3350048394609, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:22:34,757] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 927.30 | bwd_inner_microstep: 924.75 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.53
[2024-11-14 15:22:34,757] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.30 | bwd_inner: 924.75 | bwd_allreduce: 2.53 | step: 25.53
[2024-11-14 15:22:36,033] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:22:36,033] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 927.90 | bwd_inner_microstep: 925.35 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.26
[2024-11-14 15:22:36,033] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.90 | bwd_inner: 925.34 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:22:37,309] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:22:37,309] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.62 | bwd_inner_microstep: 924.99 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.37
[2024-11-14 15:22:37,309] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 927.62 | bwd_inner: 924.99 | bwd_allreduce: 2.61 | step: 25.37
[2024-11-14 15:22:38,586] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:22:38,586] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.31 | bwd_microstep: 927.85 | bwd_inner_microstep: 925.26 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.42
[2024-11-14 15:22:38,586] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.30 | bwd: 927.85 | bwd_inner: 925.26 | bwd_allreduce: 2.57 | step: 25.42
[2024-11-14 15:22:39,861] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:22:39,861] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.00 | bwd_microstep: 927.35 | bwd_inner_microstep: 924.80 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.25
[2024-11-14 15:22:39,862] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.99 | bwd: 927.36 | bwd_inner: 924.80 | bwd_allreduce: 2.54 | step: 25.26
[2024-11-14 15:22:41,138] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:22:41,138] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.46 | bwd_microstep: 927.73 | bwd_inner_microstep: 925.16 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.27
[2024-11-14 15:22:41,138] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.45 | bwd: 927.74 | bwd_inner: 925.17 | bwd_allreduce: 2.55 | step: 25.27
[2024-11-14 15:22:42,413] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:22:42,414] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 927.42 | bwd_inner_microstep: 924.86 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.36
[2024-11-14 15:22:42,414] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 927.43 | bwd_inner: 924.86 | bwd_allreduce: 2.54 | step: 25.36
[2024-11-14 15:22:43,396] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:22:43,396] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.38 | bwd_microstep: 712.49 | bwd_inner_microstep: 709.92 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.48
[2024-11-14 15:22:43,396] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.37 | bwd: 712.50 | bwd_inner: 709.91 | bwd_allreduce: 2.56 | step: 25.48
[2024-11-14 15:22:44,672] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:22:44,673] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.45 | bwd_microstep: 927.98 | bwd_inner_microstep: 925.40 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.35
[2024-11-14 15:22:44,673] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.44 | bwd: 927.99 | bwd_inner: 925.40 | bwd_allreduce: 2.56 | step: 25.35
[2024-11-14 15:22:46,253] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.52
[2024-11-14 15:22:46,253] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.56 | bwd_microstep: 1147.95 | bwd_inner_microstep: 1145.14 | bwd_allreduce_microstep: 2.78 | step_microstep: 26.00
[2024-11-14 15:22:46,253] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.55 | bwd: 1147.96 | bwd_inner: 1145.14 | bwd_allreduce: 2.80 | step: 26.00
[2024-11-14 15:22:47,530] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:22:47,530] [INFO] [logging.py:96:log_dist] [Rank 0] step=800, skipped=2, lr=[0.00024241727455636978], mom=[(0.9, 0.95)]
[2024-11-14 15:22:47,530] [INFO] [timer.py:259:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=775.7618410120449, CurrSamplesPerSec=802.6529687064458, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:22:47,530] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.95 | bwd_microstep: 927.88 | bwd_inner_microstep: 925.13 | bwd_allreduce_microstep: 2.72 | step_microstep: 26.17
[2024-11-14 15:22:47,530] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.94 | bwd: 927.89 | bwd_inner: 925.13 | bwd_allreduce: 2.74 | step: 26.17
[2024-11-14 15:22:48,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:22:48,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.34 | bwd_microstep: 712.47 | bwd_inner_microstep: 709.82 | bwd_allreduce_microstep: 2.62 | step_microstep: 25.50
[2024-11-14 15:22:48,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.33 | bwd: 712.48 | bwd_inner: 709.82 | bwd_allreduce: 2.64 | step: 25.50
[2024-11-14 15:22:48.512833][epoch 0][local 0: 800][global 800] train_loss: 0.2584194, 735.1 samples / 14701 tokens per sec
[2024-11-14 15:22:49,788] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:22:49,788] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.10 | bwd_microstep: 927.49 | bwd_inner_microstep: 924.93 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.22
[2024-11-14 15:22:49,788] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.09 | bwd: 927.50 | bwd_inner: 924.93 | bwd_allreduce: 2.54 | step: 25.22
[2024-11-14 15:22:51,064] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:22:51,064] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.47 | bwd_inner_microstep: 924.90 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.28
[2024-11-14 15:22:51,064] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 927.48 | bwd_inner: 924.90 | bwd_allreduce: 2.56 | step: 25.28
[2024-11-14 15:22:52,340] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:22:52,340] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 927.26 | bwd_inner_microstep: 924.69 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.30
[2024-11-14 15:22:52,340] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 927.26 | bwd_inner: 924.69 | bwd_allreduce: 2.55 | step: 25.30
[2024-11-14 15:22:53,920] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:22:53,920] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.53 | bwd_microstep: 1147.92 | bwd_inner_microstep: 1145.15 | bwd_allreduce_microstep: 2.73 | step_microstep: 25.98
[2024-11-14 15:22:53,920] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.52 | bwd: 1147.92 | bwd_inner: 1145.15 | bwd_allreduce: 2.74 | step: 25.99
[2024-11-14 15:22:55,197] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:22:55,197] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.74 | bwd_microstep: 927.79 | bwd_inner_microstep: 925.07 | bwd_allreduce_microstep: 2.69 | step_microstep: 25.96
[2024-11-14 15:22:55,197] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.74 | bwd: 927.80 | bwd_inner: 925.07 | bwd_allreduce: 2.71 | step: 25.96
[2024-11-14 15:22:56,778] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:22:56,778] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.73 | bwd_microstep: 1148.35 | bwd_inner_microstep: 1145.28 | bwd_allreduce_microstep: 3.04 | step_microstep: 25.83
[2024-11-14 15:22:56,778] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.72 | bwd: 1148.36 | bwd_inner: 1145.28 | bwd_allreduce: 3.05 | step: 25.84
[2024-11-14 15:22:58,053] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:22:58,053] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.68 | bwd_microstep: 927.04 | bwd_inner_microstep: 924.33 | bwd_allreduce_microstep: 2.68 | step_microstep: 25.91
[2024-11-14 15:22:58,053] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.67 | bwd: 927.04 | bwd_inner: 924.33 | bwd_allreduce: 2.69 | step: 25.91
[2024-11-14 15:22:59,329] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:22:59,330] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.38 | bwd_inner_microstep: 924.81 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.74
[2024-11-14 15:22:59,330] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 927.39 | bwd_inner: 924.81 | bwd_allreduce: 2.55 | step: 25.75
[2024-11-14 15:23:00,607] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:23:00,607] [INFO] [logging.py:96:log_dist] [Rank 0] step=810, skipped=2, lr=[0.00024281315711663912], mom=[(0.9, 0.95)]
[2024-11-14 15:23:00,607] [INFO] [timer.py:259:stop] epoch=0/micro_step=810/global_step=810, RunningAvgSamplesPerSec=775.859031143556, CurrSamplesPerSec=802.3547264657971, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:23:00,607] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 928.96 | bwd_inner_microstep: 926.37 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.58
[2024-11-14 15:23:00,607] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 928.97 | bwd_inner: 926.37 | bwd_allreduce: 2.58 | step: 25.58
[2024-11-14 15:23:02,203] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:23:02,204] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.30 | bwd_microstep: 1148.00 | bwd_inner_microstep: 1144.86 | bwd_allreduce_microstep: 3.09 | step_microstep: 42.25
[2024-11-14 15:23:02,204] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.29 | bwd: 1148.01 | bwd_inner: 1144.86 | bwd_allreduce: 3.12 | step: 42.24
[2024-11-14 15:23:03,185] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:23:03,185] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.22 | bwd_microstep: 712.13 | bwd_inner_microstep: 709.56 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.27
[2024-11-14 15:23:03,185] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.21 | bwd: 712.14 | bwd_inner: 709.56 | bwd_allreduce: 2.55 | step: 25.28
[2024-11-14 15:23:04,765] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:23:04,765] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.78 | bwd_microstep: 1147.80 | bwd_inner_microstep: 1145.20 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.38
[2024-11-14 15:23:04,765] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.77 | bwd: 1147.81 | bwd_inner: 1145.20 | bwd_allreduce: 2.58 | step: 25.38
[2024-11-14 15:23:06,043] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:23:06,043] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.88 | bwd_microstep: 927.47 | bwd_inner_microstep: 924.52 | bwd_allreduce_microstep: 2.93 | step_microstep: 27.50
[2024-11-14 15:23:06,043] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.87 | bwd: 927.47 | bwd_inner: 924.52 | bwd_allreduce: 2.94 | step: 27.51
[2024-11-14 15:23:07,319] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:23:07,319] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.27 | bwd_microstep: 927.21 | bwd_inner_microstep: 924.66 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:23:07,319] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.26 | bwd: 927.22 | bwd_inner: 924.66 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:23:08,594] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:23:08,594] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.88 | bwd_microstep: 926.92 | bwd_inner_microstep: 924.34 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.24
[2024-11-14 15:23:08,594] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.87 | bwd: 926.93 | bwd_inner: 924.34 | bwd_allreduce: 2.56 | step: 25.24
[2024-11-14 15:23:09,870] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:23:09,870] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.45 | bwd_microstep: 927.13 | bwd_inner_microstep: 924.56 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.40
[2024-11-14 15:23:09,870] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.43 | bwd: 927.14 | bwd_inner: 924.56 | bwd_allreduce: 2.55 | step: 25.41
[2024-11-14 15:23:11,145] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:23:11,146] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 927.11 | bwd_inner_microstep: 924.56 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:23:11,146] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.12 | bwd_inner: 924.56 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:23:12,422] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:23:12,422] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 927.83 | bwd_inner_microstep: 925.22 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.60
[2024-11-14 15:23:12,422] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.83 | bwd_inner: 925.22 | bwd_allreduce: 2.59 | step: 25.60
[2024-11-14 15:23:13,698] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:23:13,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=820, skipped=2, lr=[0.00024320417014917007], mom=[(0.9, 0.95)]
[2024-11-14 15:23:13,699] [INFO] [timer.py:259:stop] epoch=0/micro_step=820/global_step=820, RunningAvgSamplesPerSec=775.9430950123127, CurrSamplesPerSec=802.8234066605881, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:23:13,699] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 927.73 | bwd_inner_microstep: 925.14 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.86
[2024-11-14 15:23:13,699] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 927.74 | bwd_inner: 925.14 | bwd_allreduce: 2.57 | step: 25.86
[2024-11-14 15:23:15,279] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:23:15,279] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.36 | bwd_microstep: 1147.37 | bwd_inner_microstep: 1144.56 | bwd_allreduce_microstep: 2.78 | step_microstep: 26.27
[2024-11-14 15:23:15,279] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.35 | bwd: 1147.38 | bwd_inner: 1144.56 | bwd_allreduce: 2.79 | step: 26.27
[2024-11-14 15:23:16,865] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:23:16,866] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.48 | bwd_microstep: 1147.95 | bwd_inner_microstep: 1144.89 | bwd_allreduce_microstep: 3.03 | step_microstep: 32.03
[2024-11-14 15:23:16,866] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.47 | bwd: 1147.95 | bwd_inner: 1144.89 | bwd_allreduce: 3.04 | step: 32.03
[2024-11-14 15:23:18,142] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:23:18,143] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.93 | bwd_microstep: 927.96 | bwd_inner_microstep: 925.15 | bwd_allreduce_microstep: 2.78 | step_microstep: 26.12
[2024-11-14 15:23:18,143] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 927.97 | bwd_inner: 925.15 | bwd_allreduce: 2.79 | step: 26.12
[2024-11-14 15:23:19,419] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:23:19,419] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.37 | bwd_microstep: 927.90 | bwd_inner_microstep: 925.34 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.26
[2024-11-14 15:23:19,419] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.36 | bwd: 927.90 | bwd_inner: 925.34 | bwd_allreduce: 2.54 | step: 25.26
[2024-11-14 15:23:21,299] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:23:21,299] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.60 | bwd_microstep: 1358.47 | bwd_inner_microstep: 1355.92 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.64
[2024-11-14 15:23:21,299] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.59 | bwd: 1358.48 | bwd_inner: 1355.92 | bwd_allreduce: 2.53 | step: 25.64
[2024-11-14 15:23:24,075] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:23:24,075] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 743.57 | bwd_microstep: 2003.97 | bwd_inner_microstep: 2001.37 | bwd_allreduce_microstep: 2.57 | step_microstep: 26.81
[2024-11-14 15:23:24,075] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 743.56 | bwd: 2003.98 | bwd_inner: 2001.37 | bwd_allreduce: 2.58 | step: 26.82
[2024-11-14 15:23:25,349] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:23:25,350] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.57 | bwd_microstep: 926.62 | bwd_inner_microstep: 924.04 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.40
[2024-11-14 15:23:25,350] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.56 | bwd: 926.63 | bwd_inner: 924.04 | bwd_allreduce: 2.57 | step: 25.40
[2024-11-14 15:23:26,624] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:23:26,624] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.87 | bwd_microstep: 926.75 | bwd_inner_microstep: 924.20 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:23:26,625] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.86 | bwd: 926.75 | bwd_inner: 924.20 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:23:28,504] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:23:28,504] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.67 | bwd_microstep: 1358.37 | bwd_inner_microstep: 1355.51 | bwd_allreduce_microstep: 2.82 | step_microstep: 25.79
[2024-11-14 15:23:28,504] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.66 | bwd: 1358.38 | bwd_inner: 1355.51 | bwd_allreduce: 2.84 | step: 25.79
[2024-11-14 15:23:29,487] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:23:29,487] [INFO] [logging.py:96:log_dist] [Rank 0] step=830, skipped=2, lr=[0.00024359043199441717], mom=[(0.9, 0.95)]
[2024-11-14 15:23:29,487] [INFO] [timer.py:259:stop] epoch=0/micro_step=830/global_step=830, RunningAvgSamplesPerSec=774.1152650498622, CurrSamplesPerSec=1043.0462266893037, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:23:29,487] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.34 | bwd_microstep: 712.49 | bwd_inner_microstep: 709.49 | bwd_allreduce_microstep: 2.97 | step_microstep: 26.15
[2024-11-14 15:23:29,487] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.33 | bwd: 712.50 | bwd_inner: 709.49 | bwd_allreduce: 2.99 | step: 26.15
[2024-11-14 15:23:30,763] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:23:30,763] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.23 | bwd_microstep: 927.46 | bwd_inner_microstep: 924.93 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.24
[2024-11-14 15:23:30,763] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.22 | bwd: 927.47 | bwd_inner: 924.93 | bwd_allreduce: 2.51 | step: 25.25
[2024-11-14 15:23:31,744] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:23:31,744] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.20 | bwd_microstep: 711.72 | bwd_inner_microstep: 709.16 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.33
[2024-11-14 15:23:31,744] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.19 | bwd: 711.73 | bwd_inner: 709.16 | bwd_allreduce: 2.54 | step: 25.33
[2024-11-14 15:23:33,019] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:23:33,020] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.04 | bwd_microstep: 926.91 | bwd_inner_microstep: 924.33 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.49
[2024-11-14 15:23:33,020] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.03 | bwd: 926.92 | bwd_inner: 924.33 | bwd_allreduce: 2.56 | step: 25.49
[2024-11-14 15:23:34,295] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:23:34,295] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 926.91 | bwd_inner_microstep: 924.31 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.38
[2024-11-14 15:23:34,295] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 926.91 | bwd_inner: 924.31 | bwd_allreduce: 2.57 | step: 25.39
[2024-11-14 15:23:35,571] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:23:35,571] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.10 | bwd_microstep: 927.44 | bwd_inner_microstep: 924.85 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.39
[2024-11-14 15:23:35,571] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.09 | bwd: 927.45 | bwd_inner: 924.85 | bwd_allreduce: 2.57 | step: 25.39
[2024-11-14 15:23:36,847] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:23:36,848] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.43 | bwd_microstep: 928.08 | bwd_inner_microstep: 925.53 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.30
[2024-11-14 15:23:36,848] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.42 | bwd: 928.08 | bwd_inner: 925.53 | bwd_allreduce: 2.53 | step: 25.30
[2024-11-14 15:23:38,123] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:23:38,124] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.92 | bwd_microstep: 927.59 | bwd_inner_microstep: 925.01 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.51
[2024-11-14 15:23:38,124] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.92 | bwd: 927.60 | bwd_inner: 925.01 | bwd_allreduce: 2.56 | step: 25.51
[2024-11-14 15:23:39,400] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:23:39,400] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 927.82 | bwd_inner_microstep: 925.27 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:23:39,400] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.11 | bwd: 927.83 | bwd_inner: 925.27 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:23:40,676] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:23:40,676] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.27 | bwd_microstep: 927.49 | bwd_inner_microstep: 924.91 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.43
[2024-11-14 15:23:40,676] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.26 | bwd: 927.50 | bwd_inner: 924.91 | bwd_allreduce: 2.57 | step: 25.43
[2024-11-14 15:23:41,952] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:23:41,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=840, skipped=2, lr=[0.00024397205673066532], mom=[(0.9, 0.95)]
[2024-11-14 15:23:41,952] [INFO] [timer.py:259:stop] epoch=0/micro_step=840/global_step=840, RunningAvgSamplesPerSec=774.6556549421078, CurrSamplesPerSec=803.2809161099557, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:23:41,952] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.27 | bwd_microstep: 927.21 | bwd_inner_microstep: 924.67 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.54
[2024-11-14 15:23:41,952] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.26 | bwd: 927.22 | bwd_inner: 924.67 | bwd_allreduce: 2.52 | step: 25.54
[2024-11-14 15:23:43,228] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:23:43,228] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 927.29 | bwd_inner_microstep: 924.69 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.38
[2024-11-14 15:23:43,228] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 927.30 | bwd_inner: 924.69 | bwd_allreduce: 2.58 | step: 25.39
[2024-11-14 15:23:44,209] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:23:44,209] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.33 | bwd_microstep: 712.00 | bwd_inner_microstep: 709.45 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:23:44,210] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.32 | bwd: 712.00 | bwd_inner: 709.45 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:23:45,486] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:23:45,486] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.59 | bwd_microstep: 927.43 | bwd_inner_microstep: 924.87 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:23:45,486] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.59 | bwd: 927.44 | bwd_inner: 924.87 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:23:46,761] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:23:46,761] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.08 | bwd_microstep: 926.94 | bwd_inner_microstep: 924.37 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.28
[2024-11-14 15:23:46,761] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.07 | bwd: 926.95 | bwd_inner: 924.37 | bwd_allreduce: 2.55 | step: 25.28
[2024-11-14 15:23:48,037] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:23:48,038] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.23 | bwd_microstep: 927.81 | bwd_inner_microstep: 925.18 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.58
[2024-11-14 15:23:48,038] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.22 | bwd: 927.81 | bwd_inner: 925.18 | bwd_allreduce: 2.61 | step: 25.59
[2024-11-14 15:23:49,313] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:23:49,314] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.19 | bwd_microstep: 927.53 | bwd_inner_microstep: 924.99 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.23
[2024-11-14 15:23:49,314] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.18 | bwd: 927.54 | bwd_inner: 924.99 | bwd_allreduce: 2.53 | step: 25.24
[2024-11-14 15:23:50,589] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:23:50,589] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.85 | bwd_microstep: 927.37 | bwd_inner_microstep: 924.78 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.39
[2024-11-14 15:23:50,589] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.85 | bwd: 927.38 | bwd_inner: 924.78 | bwd_allreduce: 2.57 | step: 25.39
[2024-11-14 15:23:51,866] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:23:51,866] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 927.96 | bwd_inner_microstep: 925.42 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.73
[2024-11-14 15:23:51,866] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.27 | bwd: 927.97 | bwd_inner: 925.42 | bwd_allreduce: 2.53 | step: 25.73
[2024-11-14 15:23:53,142] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:23:53,142] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.18 | bwd_inner_microstep: 924.64 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.74
[2024-11-14 15:23:53,142] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.19 | bwd_inner: 924.64 | bwd_allreduce: 2.52 | step: 25.74
[2024-11-14 15:23:54,418] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:23:54,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=850, skipped=2, lr=[0.00024434915437628014], mom=[(0.9, 0.95)]
[2024-11-14 15:23:54,418] [INFO] [timer.py:259:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=775.1833151895767, CurrSamplesPerSec=803.3072083325752, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:23:54,418] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.23 | bwd_microstep: 927.20 | bwd_inner_microstep: 924.65 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.54
[2024-11-14 15:23:54,418] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.22 | bwd: 927.20 | bwd_inner: 924.65 | bwd_allreduce: 2.53 | step: 25.54
[2024-11-14 15:23:55,400] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:23:55,400] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.48 | bwd_microstep: 712.13 | bwd_inner_microstep: 709.53 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.36
[2024-11-14 15:23:55,400] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.47 | bwd: 712.14 | bwd_inner: 709.53 | bwd_allreduce: 2.58 | step: 25.36
[2024-11-14 15:23:56,980] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:23:56,980] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.72 | bwd_microstep: 1147.29 | bwd_inner_microstep: 1144.53 | bwd_allreduce_microstep: 2.73 | step_microstep: 25.31
[2024-11-14 15:23:56,980] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.71 | bwd: 1147.30 | bwd_inner: 1144.53 | bwd_allreduce: 2.74 | step: 25.31
[2024-11-14 15:23:57,962] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:23:57,962] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.45 | bwd_microstep: 712.63 | bwd_inner_microstep: 710.07 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.25
[2024-11-14 15:23:57,962] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.44 | bwd: 712.63 | bwd_inner: 710.07 | bwd_allreduce: 2.54 | step: 25.26
[2024-11-14 15:23:59,238] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:23:59,239] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.40 | bwd_microstep: 927.93 | bwd_inner_microstep: 925.38 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.24
[2024-11-14 15:23:59,239] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.39 | bwd: 927.93 | bwd_inner: 925.38 | bwd_allreduce: 2.53 | step: 25.24
[2024-11-14 15:24:00,515] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:24:00,515] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 928.49 | bwd_inner_microstep: 925.93 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.21
[2024-11-14 15:24:00,515] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.97 | bwd: 928.49 | bwd_inner: 925.93 | bwd_allreduce: 2.54 | step: 25.21
[2024-11-14 15:24:01,497] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:24:01,497] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.25 | bwd_microstep: 712.47 | bwd_inner_microstep: 709.93 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.29
[2024-11-14 15:24:01,497] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.24 | bwd: 712.47 | bwd_inner: 709.93 | bwd_allreduce: 2.52 | step: 25.29
[2024-11-14 15:24:02,773] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:24:02,774] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.39 | bwd_microstep: 927.92 | bwd_inner_microstep: 925.38 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.32
[2024-11-14 15:24:02,774] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.39 | bwd: 927.93 | bwd_inner: 925.38 | bwd_allreduce: 2.53 | step: 25.32
[2024-11-14 15:24:04,050] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:24:04,050] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.36 | bwd_microstep: 927.83 | bwd_inner_microstep: 925.25 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.42
[2024-11-14 15:24:04,050] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.35 | bwd: 927.83 | bwd_inner: 925.25 | bwd_allreduce: 2.56 | step: 25.42
[2024-11-14 15:24:05,326] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:24:05,326] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.01 | bwd_microstep: 927.42 | bwd_inner_microstep: 924.88 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.31
[2024-11-14 15:24:05,326] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 927.43 | bwd_inner: 924.88 | bwd_allreduce: 2.53 | step: 25.31
[2024-11-14 15:24:06,602] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:24:06,603] [INFO] [logging.py:96:log_dist] [Rank 0] step=860, skipped=2, lr=[0.000244721831080102], mom=[(0.9, 0.95)]
[2024-11-14 15:24:06,603] [INFO] [timer.py:259:stop] epoch=0/micro_step=860/global_step=860, RunningAvgSamplesPerSec=775.8924467614571, CurrSamplesPerSec=803.0077291202158, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:24:06,603] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.05 | bwd_microstep: 927.82 | bwd_inner_microstep: 925.26 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.58
[2024-11-14 15:24:06,603] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.04 | bwd: 927.83 | bwd_inner: 925.26 | bwd_allreduce: 2.54 | step: 25.58
[2024-11-14 15:24:07,879] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:24:07,879] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.19 | bwd_microstep: 927.77 | bwd_inner_microstep: 925.22 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:24:07,879] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 927.78 | bwd_inner: 925.22 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:24:09,156] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:24:09,156] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.42 | bwd_microstep: 927.80 | bwd_inner_microstep: 925.25 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:24:09,156] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.41 | bwd: 927.81 | bwd_inner: 925.25 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:24:10,431] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:24:10,432] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.93 | bwd_microstep: 927.37 | bwd_inner_microstep: 924.81 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.44
[2024-11-14 15:24:10,432] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.92 | bwd: 927.38 | bwd_inner: 924.81 | bwd_allreduce: 2.55 | step: 25.44
[2024-11-14 15:24:12,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:24:12,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.52 | bwd_microstep: 1148.17 | bwd_inner_microstep: 1145.29 | bwd_allreduce_microstep: 2.84 | step_microstep: 26.21
[2024-11-14 15:24:12,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.51 | bwd: 1148.18 | bwd_inner: 1145.29 | bwd_allreduce: 2.86 | step: 26.21
[2024-11-14 15:24:13,290] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.52
[2024-11-14 15:24:13,290] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.29 | bwd_microstep: 928.30 | bwd_inner_microstep: 925.42 | bwd_allreduce_microstep: 2.85 | step_microstep: 25.93
[2024-11-14 15:24:13,291] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.28 | bwd: 928.31 | bwd_inner: 925.42 | bwd_allreduce: 2.87 | step: 25.94
[2024-11-14 15:24:14,566] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:24:14,566] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.71 | bwd_inner_microstep: 925.14 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.25
[2024-11-14 15:24:14,567] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 927.72 | bwd_inner: 925.14 | bwd_allreduce: 2.55 | step: 25.26
[2024-11-14 15:24:15,548] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:24:15,548] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.30 | bwd_microstep: 712.28 | bwd_inner_microstep: 709.73 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.30
[2024-11-14 15:24:15,548] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.29 | bwd: 712.29 | bwd_inner: 709.73 | bwd_allreduce: 2.54 | step: 25.30
[2024-11-14 15:24:16,530] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:24:16,530] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.50 | bwd_microstep: 712.40 | bwd_inner_microstep: 709.83 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.24
[2024-11-14 15:24:16,530] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.49 | bwd: 712.41 | bwd_inner: 709.83 | bwd_allreduce: 2.56 | step: 25.24
[2024-11-14 15:24:17,806] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:24:17,807] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.29 | bwd_microstep: 927.79 | bwd_inner_microstep: 925.23 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.33
[2024-11-14 15:24:17,807] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.28 | bwd: 927.80 | bwd_inner: 925.23 | bwd_allreduce: 2.54 | step: 25.33
[2024-11-14 15:24:19,083] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:24:19,083] [INFO] [logging.py:96:log_dist] [Rank 0] step=870, skipped=2, lr=[0.00024509018930080886], mom=[(0.9, 0.95)]
[2024-11-14 15:24:19,083] [INFO] [timer.py:259:stop] epoch=0/micro_step=870/global_step=870, RunningAvgSamplesPerSec=776.3857766116455, CurrSamplesPerSec=802.8138025982706, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:24:19,083] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.42 | bwd_microstep: 927.78 | bwd_inner_microstep: 925.23 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.55
[2024-11-14 15:24:19,083] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.41 | bwd: 927.79 | bwd_inner: 925.23 | bwd_allreduce: 2.54 | step: 25.55
[2024-11-14 15:24:20,664] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:24:20,664] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.38 | bwd_microstep: 1147.75 | bwd_inner_microstep: 1144.78 | bwd_allreduce_microstep: 2.94 | step_microstep: 26.57
[2024-11-14 15:24:20,664] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.37 | bwd: 1147.76 | bwd_inner: 1144.78 | bwd_allreduce: 2.95 | step: 26.57
[2024-11-14 15:24:21,940] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:24:21,940] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.81 | bwd_microstep: 927.49 | bwd_inner_microstep: 924.92 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.46
[2024-11-14 15:24:21,940] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.80 | bwd: 927.50 | bwd_inner: 924.92 | bwd_allreduce: 2.56 | step: 25.46
[2024-11-14 15:24:23,216] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:24:23,216] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.41 | bwd_microstep: 927.66 | bwd_inner_microstep: 925.09 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.38
[2024-11-14 15:24:23,216] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.40 | bwd: 927.67 | bwd_inner: 925.09 | bwd_allreduce: 2.55 | step: 25.38
[2024-11-14 15:24:24,198] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:24:24,198] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.37 | bwd_microstep: 712.21 | bwd_inner_microstep: 709.66 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.20
[2024-11-14 15:24:24,198] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.36 | bwd: 712.21 | bwd_inner: 709.66 | bwd_allreduce: 2.53 | step: 25.20
[2024-11-14 15:24:25,777] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:24:25,777] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.28 | bwd_microstep: 1146.90 | bwd_inner_microstep: 1144.33 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.33
[2024-11-14 15:24:25,777] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.27 | bwd: 1146.90 | bwd_inner: 1144.33 | bwd_allreduce: 2.56 | step: 25.33
[2024-11-14 15:24:27,058] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:24:27,058] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.22 | bwd_microstep: 927.65 | bwd_inner_microstep: 924.74 | bwd_allreduce_microstep: 2.89 | step_microstep: 30.56
[2024-11-14 15:24:27,059] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.21 | bwd: 927.66 | bwd_inner: 924.74 | bwd_allreduce: 2.90 | step: 30.56
[2024-11-14 15:24:28,638] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:24:28,638] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.28 | bwd_microstep: 1147.23 | bwd_inner_microstep: 1144.34 | bwd_allreduce_microstep: 2.86 | step_microstep: 26.23
[2024-11-14 15:24:28,638] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.27 | bwd: 1147.24 | bwd_inner: 1144.34 | bwd_allreduce: 2.87 | step: 26.23
[2024-11-14 15:24:29,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:24:29,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 927.41 | bwd_inner_microstep: 924.62 | bwd_allreduce_microstep: 2.76 | step_microstep: 26.47
[2024-11-14 15:24:29,916] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.41 | bwd_inner: 924.62 | bwd_allreduce: 2.77 | step: 26.47
[2024-11-14 15:24:31,190] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:24:31,191] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 926.93 | bwd_inner_microstep: 924.37 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.21
[2024-11-14 15:24:31,191] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 926.93 | bwd_inner: 924.37 | bwd_allreduce: 2.54 | step: 25.22
[2024-11-14 15:24:32,466] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:24:32,466] [INFO] [logging.py:96:log_dist] [Rank 0] step=880, skipped=2, lr=[0.00024545432797600517], mom=[(0.9, 0.95)]
[2024-11-14 15:24:32,466] [INFO] [timer.py:259:stop] epoch=0/micro_step=880/global_step=880, RunningAvgSamplesPerSec=776.2631045982881, CurrSamplesPerSec=803.2690476132929, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:24:32,467] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.24 | bwd_microstep: 927.24 | bwd_inner_microstep: 924.68 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.55
[2024-11-14 15:24:32,467] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.23 | bwd: 927.25 | bwd_inner: 924.68 | bwd_allreduce: 2.54 | step: 25.55
[2024-11-14 15:24:33,743] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:24:33,743] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 927.27 | bwd_inner_microstep: 924.70 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.75
[2024-11-14 15:24:33,743] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.28 | bwd: 927.28 | bwd_inner: 924.70 | bwd_allreduce: 2.56 | step: 25.75
[2024-11-14 15:24:35,019] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:24:35,019] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 927.35 | bwd_inner_microstep: 924.81 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.67
[2024-11-14 15:24:35,019] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.36 | bwd_inner: 924.81 | bwd_allreduce: 2.53 | step: 25.67
[2024-11-14 15:24:36,294] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:24:36,294] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.03 | bwd_microstep: 926.83 | bwd_inner_microstep: 924.28 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.31
[2024-11-14 15:24:36,294] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.03 | bwd: 926.83 | bwd_inner: 924.28 | bwd_allreduce: 2.53 | step: 25.31
[2024-11-14 15:24:37,569] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:24:37,569] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.82 | bwd_microstep: 926.90 | bwd_inner_microstep: 924.34 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.30
[2024-11-14 15:24:37,569] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.81 | bwd: 926.90 | bwd_inner: 924.34 | bwd_allreduce: 2.54 | step: 25.30
[2024-11-14 15:24:38,551] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:24:38,551] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.51 | bwd_microstep: 712.25 | bwd_inner_microstep: 709.67 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.36
[2024-11-14 15:24:38,551] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.50 | bwd: 712.26 | bwd_inner: 709.67 | bwd_allreduce: 2.56 | step: 25.36
[2024-11-14 15:24:39,533] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:24:39,533] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.31 | bwd_microstep: 712.05 | bwd_inner_microstep: 709.46 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.43
[2024-11-14 15:24:39,533] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.30 | bwd: 712.05 | bwd_inner: 709.46 | bwd_allreduce: 2.57 | step: 25.43
[2024-11-14 15:24:40,809] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:24:40,809] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.41 | bwd_microstep: 927.43 | bwd_inner_microstep: 924.89 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.25
[2024-11-14 15:24:40,809] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.40 | bwd: 927.44 | bwd_inner: 924.89 | bwd_allreduce: 2.52 | step: 25.26
[2024-11-14 15:24:42,085] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:24:42,085] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.30 | bwd_inner_microstep: 924.73 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.25
[2024-11-14 15:24:42,085] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 927.31 | bwd_inner: 924.73 | bwd_allreduce: 2.55 | step: 25.25
[2024-11-14 15:24:43,361] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:24:43,361] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.25 | bwd_inner_microstep: 924.69 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.72
[2024-11-14 15:24:43,361] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.26 | bwd_inner: 924.69 | bwd_allreduce: 2.54 | step: 25.72
[2024-11-14 15:24:44,636] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:24:44,636] [INFO] [logging.py:96:log_dist] [Rank 0] step=890, skipped=2, lr=[0.0002458143426817355], mom=[(0.9, 0.95)]
[2024-11-14 15:24:44,637] [INFO] [timer.py:259:stop] epoch=0/micro_step=890/global_step=890, RunningAvgSamplesPerSec=776.9471174017987, CurrSamplesPerSec=803.3147207123121, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:24:44,637] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.01 | bwd_microstep: 926.77 | bwd_inner_microstep: 924.21 | bwd_allreduce_microstep: 2.53 | step_microstep: 26.16
[2024-11-14 15:24:44,637] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 926.78 | bwd_inner: 924.21 | bwd_allreduce: 2.54 | step: 26.16
[2024-11-14 15:24:45,912] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:24:45,912] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.14 | bwd_microstep: 926.77 | bwd_inner_microstep: 924.22 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.68
[2024-11-14 15:24:45,912] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.13 | bwd: 926.77 | bwd_inner: 924.22 | bwd_allreduce: 2.53 | step: 25.68
[2024-11-14 15:24:47,187] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:24:47,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 927.05 | bwd_inner_microstep: 924.36 | bwd_allreduce_microstep: 2.66 | step_microstep: 25.26
[2024-11-14 15:24:47,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.05 | bwd_inner: 924.36 | bwd_allreduce: 2.67 | step: 25.26
[2024-11-14 15:24:48,463] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:24:48,463] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.08 | bwd_inner_microstep: 924.52 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.32
[2024-11-14 15:24:48,463] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.09 | bwd_inner: 924.52 | bwd_allreduce: 2.54 | step: 25.33
[2024-11-14 15:24:50,043] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:24:50,043] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.18 | bwd_microstep: 1147.01 | bwd_inner_microstep: 1143.96 | bwd_allreduce_microstep: 3.00 | step_microstep: 26.28
[2024-11-14 15:24:50,043] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.17 | bwd: 1147.02 | bwd_inner: 1143.96 | bwd_allreduce: 3.02 | step: 26.28
[2024-11-14 15:24:51,623] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:24:51,623] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.60 | bwd_microstep: 1147.13 | bwd_inner_microstep: 1144.30 | bwd_allreduce_microstep: 2.80 | step_microstep: 26.19
[2024-11-14 15:24:51,623] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.59 | bwd: 1147.14 | bwd_inner: 1144.30 | bwd_allreduce: 2.81 | step: 26.20
[2024-11-14 15:24:52,899] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:24:52,900] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 927.49 | bwd_inner_microstep: 924.58 | bwd_allreduce_microstep: 2.88 | step_microstep: 26.26
[2024-11-14 15:24:52,900] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.50 | bwd_inner: 924.58 | bwd_allreduce: 2.89 | step: 26.26
[2024-11-14 15:24:54,175] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:24:54,175] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.19 | bwd_microstep: 927.01 | bwd_inner_microstep: 924.45 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.33
[2024-11-14 15:24:54,175] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.18 | bwd: 927.02 | bwd_inner: 924.45 | bwd_allreduce: 2.54 | step: 25.33
[2024-11-14 15:24:55,451] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:24:55,451] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.29 | bwd_microstep: 927.29 | bwd_inner_microstep: 924.73 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.40
[2024-11-14 15:24:55,451] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.28 | bwd: 927.30 | bwd_inner: 924.73 | bwd_allreduce: 2.55 | step: 25.41
[2024-11-14 15:24:56,727] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:24:56,728] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.44 | bwd_microstep: 927.66 | bwd_inner_microstep: 925.10 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.33
[2024-11-14 15:24:56,728] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.43 | bwd: 927.67 | bwd_inner: 925.10 | bwd_allreduce: 2.55 | step: 25.34
[2024-11-14 15:24:58,003] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:24:58,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=900, skipped=2, lr=[0.00024617032578306674], mom=[(0.9, 0.95)]
[2024-11-14 15:24:58,004] [INFO] [timer.py:259:stop] epoch=0/micro_step=900/global_step=900, RunningAvgSamplesPerSec=776.831177046929, CurrSamplesPerSec=803.2942873680973, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:24:58,004] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.27 | bwd_microstep: 927.23 | bwd_inner_microstep: 924.68 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.50
[2024-11-14 15:24:58,004] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.24 | bwd_inner: 924.68 | bwd_allreduce: 2.53 | step: 25.50
[2024-11-14 15:24:59,279] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:24:59,280] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.17 | bwd_inner_microstep: 924.58 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.52
[2024-11-14 15:24:59,280] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.18 | bwd_inner: 924.58 | bwd_allreduce: 2.57 | step: 25.53
[2024-11-14 15:24:59.280144][epoch 0][local 0: 900][global 900] train_loss: 0.2112604, 740.1 samples / 14802 tokens per sec
[2024-11-14 15:25:01,778] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:25:01,778] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 662.42 | bwd_microstep: 1809.18 | bwd_inner_microstep: 1806.62 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.25
[2024-11-14 15:25:01,778] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 662.42 | bwd: 1809.19 | bwd_inner: 1806.62 | bwd_allreduce: 2.54 | step: 25.25
[2024-11-14 15:25:03,052] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:25:03,052] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.52 | bwd_microstep: 926.47 | bwd_inner_microstep: 923.93 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.25
[2024-11-14 15:25:03,052] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.51 | bwd: 926.48 | bwd_inner: 923.93 | bwd_allreduce: 2.52 | step: 25.26
[2024-11-14 15:25:04,328] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:25:04,328] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.44 | bwd_microstep: 927.25 | bwd_inner_microstep: 924.67 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.34
[2024-11-14 15:25:04,328] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.43 | bwd: 927.25 | bwd_inner: 924.67 | bwd_allreduce: 2.56 | step: 25.35
[2024-11-14 15:25:05,603] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:25:05,603] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.14 | bwd_microstep: 926.82 | bwd_inner_microstep: 924.25 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.35
[2024-11-14 15:25:05,603] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.13 | bwd: 926.82 | bwd_inner: 924.25 | bwd_allreduce: 2.55 | step: 25.35
[2024-11-14 15:25:07,183] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:25:07,183] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.33 | bwd_microstep: 1147.00 | bwd_inner_microstep: 1144.10 | bwd_allreduce_microstep: 2.87 | step_microstep: 26.29
[2024-11-14 15:25:07,183] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.32 | bwd: 1147.01 | bwd_inner: 1144.10 | bwd_allreduce: 2.88 | step: 26.29
[2024-11-14 15:25:08,164] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:25:08,164] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.38 | bwd_microstep: 712.01 | bwd_inner_microstep: 709.47 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:25:08,165] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.37 | bwd: 712.02 | bwd_inner: 709.47 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:25:09,146] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:25:09,146] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.35 | bwd_microstep: 712.14 | bwd_inner_microstep: 709.54 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.25
[2024-11-14 15:25:09,146] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.34 | bwd: 712.15 | bwd_inner: 709.54 | bwd_allreduce: 2.58 | step: 25.26
[2024-11-14 15:25:10,421] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:25:10,421] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.77 | bwd_microstep: 926.67 | bwd_inner_microstep: 923.85 | bwd_allreduce_microstep: 2.78 | step_microstep: 25.92
[2024-11-14 15:25:10,421] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.76 | bwd: 926.68 | bwd_inner: 923.85 | bwd_allreduce: 2.80 | step: 25.92
[2024-11-14 15:25:11,697] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.50
[2024-11-14 15:25:11,697] [INFO] [logging.py:96:log_dist] [Rank 0] step=910, skipped=2, lr=[0.0002465223665763311], mom=[(0.9, 0.95)]
[2024-11-14 15:25:11,698] [INFO] [timer.py:259:stop] epoch=0/micro_step=910/global_step=910, RunningAvgSamplesPerSec=776.5054980433016, CurrSamplesPerSec=802.991364827581, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:25:11,698] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.24 | bwd_microstep: 927.26 | bwd_inner_microstep: 924.51 | bwd_allreduce_microstep: 2.72 | step_microstep: 25.99
[2024-11-14 15:25:11,698] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.23 | bwd: 927.27 | bwd_inner: 924.51 | bwd_allreduce: 2.73 | step: 25.99
[2024-11-14 15:25:13,278] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:25:13,278] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.29 | bwd_microstep: 1146.84 | bwd_inner_microstep: 1143.99 | bwd_allreduce_microstep: 2.82 | step_microstep: 26.49
[2024-11-14 15:25:13,278] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.28 | bwd: 1146.85 | bwd_inner: 1143.99 | bwd_allreduce: 2.84 | step: 26.49
[2024-11-14 15:25:14,554] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:25:14,555] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 927.47 | bwd_inner_microstep: 924.62 | bwd_allreduce_microstep: 2.82 | step_microstep: 26.20
[2024-11-14 15:25:14,555] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 927.48 | bwd_inner: 924.62 | bwd_allreduce: 2.83 | step: 26.21
[2024-11-14 15:25:15,831] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:25:15,831] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.37 | bwd_microstep: 927.41 | bwd_inner_microstep: 924.83 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.36
[2024-11-14 15:25:15,831] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.37 | bwd: 927.41 | bwd_inner: 924.83 | bwd_allreduce: 2.56 | step: 25.36
[2024-11-14 15:25:17,106] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:25:17,106] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.01 | bwd_microstep: 926.84 | bwd_inner_microstep: 924.27 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.34
[2024-11-14 15:25:17,106] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.99 | bwd: 926.85 | bwd_inner: 924.27 | bwd_allreduce: 2.56 | step: 25.34
[2024-11-14 15:25:18,686] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:25:18,687] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.59 | bwd_microstep: 1148.06 | bwd_inner_microstep: 1145.18 | bwd_allreduce_microstep: 2.85 | step_microstep: 25.92
[2024-11-14 15:25:18,687] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.59 | bwd: 1148.06 | bwd_inner: 1145.18 | bwd_allreduce: 2.86 | step: 25.93
[2024-11-14 15:25:19,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:25:19,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 927.49 | bwd_inner_microstep: 924.71 | bwd_allreduce_microstep: 2.75 | step_microstep: 25.79
[2024-11-14 15:25:19,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.50 | bwd_inner: 924.71 | bwd_allreduce: 2.76 | step: 25.80
[2024-11-14 15:25:20,945] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:25:20,945] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.55 | bwd_microstep: 712.33 | bwd_inner_microstep: 709.77 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.68
[2024-11-14 15:25:20,945] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.55 | bwd: 712.34 | bwd_inner: 709.77 | bwd_allreduce: 2.54 | step: 25.68
[2024-11-14 15:25:22,221] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:25:22,221] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.13 | bwd_microstep: 927.02 | bwd_inner_microstep: 924.46 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:25:22,221] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 927.02 | bwd_inner: 924.46 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:25:24,401] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:25:24,401] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 578.34 | bwd_microstep: 1575.24 | bwd_inner_microstep: 1572.70 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.30
[2024-11-14 15:25:24,401] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 578.33 | bwd: 1575.25 | bwd_inner: 1572.70 | bwd_allreduce: 2.52 | step: 25.30
[2024-11-14 15:25:25,676] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:25:25,677] [INFO] [logging.py:96:log_dist] [Rank 0] step=920, skipped=2, lr=[0.0002468705514235796], mom=[(0.9, 0.95)]
[2024-11-14 15:25:25,677] [INFO] [timer.py:259:stop] epoch=0/micro_step=920/global_step=920, RunningAvgSamplesPerSec=776.0048429309214, CurrSamplesPerSec=803.2676955283314, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:25:25,677] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 927.17 | bwd_inner_microstep: 924.63 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.88
[2024-11-14 15:25:25,677] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 927.17 | bwd_inner: 924.63 | bwd_allreduce: 2.52 | step: 25.88
[2024-11-14 15:25:26,952] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:25:26,952] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 927.05 | bwd_inner_microstep: 924.50 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.24
[2024-11-14 15:25:26,952] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.11 | bwd: 927.06 | bwd_inner: 924.50 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:25:28,228] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:25:28,229] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.24 | bwd_microstep: 927.17 | bwd_inner_microstep: 924.54 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.55
[2024-11-14 15:25:28,229] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.23 | bwd: 927.17 | bwd_inner: 924.54 | bwd_allreduce: 2.61 | step: 25.55
[2024-11-14 15:25:29,809] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:25:29,809] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.15 | bwd_microstep: 1146.46 | bwd_inner_microstep: 1143.59 | bwd_allreduce_microstep: 2.83 | step_microstep: 27.45
[2024-11-14 15:25:29,809] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.14 | bwd: 1146.46 | bwd_inner: 1143.59 | bwd_allreduce: 2.84 | step: 27.46
[2024-11-14 15:25:31,087] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:25:31,087] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.25 | bwd_microstep: 927.67 | bwd_inner_microstep: 924.79 | bwd_allreduce_microstep: 2.85 | step_microstep: 27.14
[2024-11-14 15:25:31,087] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.24 | bwd: 927.67 | bwd_inner: 924.79 | bwd_allreduce: 2.86 | step: 27.15
[2024-11-14 15:25:32,363] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:25:32,363] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 927.51 | bwd_inner_microstep: 924.95 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.22
[2024-11-14 15:25:32,363] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.07 | bwd: 927.52 | bwd_inner: 924.95 | bwd_allreduce: 2.54 | step: 25.22
[2024-11-14 15:25:33,638] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.49
[2024-11-14 15:25:33,638] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.89 | bwd_microstep: 926.75 | bwd_inner_microstep: 924.16 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.56
[2024-11-14 15:25:33,638] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.88 | bwd: 926.75 | bwd_inner: 924.16 | bwd_allreduce: 2.57 | step: 25.56
[2024-11-14 15:25:34,914] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:25:34,914] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 927.23 | bwd_inner_microstep: 924.69 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.25
[2024-11-14 15:25:34,914] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.27 | bwd: 927.24 | bwd_inner: 924.69 | bwd_allreduce: 2.52 | step: 25.25
[2024-11-14 15:25:36,190] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:25:36,190] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.25 | bwd_inner_microstep: 924.69 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.65
[2024-11-14 15:25:36,190] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.26 | bwd_inner: 924.69 | bwd_allreduce: 2.54 | step: 25.66
[2024-11-14 15:25:37,770] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:25:37,770] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.49 | bwd_microstep: 1147.31 | bwd_inner_microstep: 1144.54 | bwd_allreduce_microstep: 2.74 | step_microstep: 26.39
[2024-11-14 15:25:37,770] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.48 | bwd: 1147.32 | bwd_inner: 1144.54 | bwd_allreduce: 2.75 | step: 26.39
[2024-11-14 15:25:39,649] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:25:39,649] [INFO] [logging.py:96:log_dist] [Rank 0] step=930, skipped=2, lr=[0.0002472149638797509], mom=[(0.9, 0.95)]
[2024-11-14 15:25:39,649] [INFO] [timer.py:259:stop] epoch=0/micro_step=930/global_step=930, RunningAvgSamplesPerSec=775.5200710482476, CurrSamplesPerSec=545.2841561620827, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:25:39,649] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.50 | bwd_microstep: 1358.17 | bwd_inner_microstep: 1355.63 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.49
[2024-11-14 15:25:39,650] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.49 | bwd: 1358.17 | bwd_inner: 1355.63 | bwd_allreduce: 2.52 | step: 25.49
[2024-11-14 15:25:40,924] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:25:40,924] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.92 | bwd_microstep: 926.86 | bwd_inner_microstep: 924.30 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.20
[2024-11-14 15:25:40,924] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.91 | bwd: 926.86 | bwd_inner: 924.30 | bwd_allreduce: 2.54 | step: 25.20
[2024-11-14 15:25:42,200] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:25:42,200] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 927.24 | bwd_inner_microstep: 924.67 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.26
[2024-11-14 15:25:42,200] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.25 | bwd_inner: 924.67 | bwd_allreduce: 2.55 | step: 25.26
[2024-11-14 15:25:43,475] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:25:43,475] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 926.82 | bwd_inner_microstep: 924.26 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:25:43,475] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 926.83 | bwd_inner: 924.26 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:25:44,751] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:25:44,751] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.37 | bwd_microstep: 927.31 | bwd_inner_microstep: 924.76 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.45
[2024-11-14 15:25:44,751] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.36 | bwd: 927.31 | bwd_inner: 924.76 | bwd_allreduce: 2.52 | step: 25.45
[2024-11-14 15:25:46,027] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:25:46,028] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.30 | bwd_microstep: 927.25 | bwd_inner_microstep: 924.66 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.68
[2024-11-14 15:25:46,028] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.29 | bwd: 927.25 | bwd_inner: 924.66 | bwd_allreduce: 2.57 | step: 25.68
[2024-11-14 15:25:47,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:25:47,010] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.41 | bwd_microstep: 712.29 | bwd_inner_microstep: 709.75 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.28
[2024-11-14 15:25:47,010] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.40 | bwd: 712.30 | bwd_inner: 709.75 | bwd_allreduce: 2.52 | step: 25.29
[2024-11-14 15:25:47,991] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:25:47,992] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.53 | bwd_microstep: 712.37 | bwd_inner_microstep: 709.82 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.24
[2024-11-14 15:25:47,992] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.52 | bwd: 712.38 | bwd_inner: 709.82 | bwd_allreduce: 2.53 | step: 25.24
[2024-11-14 15:25:49,872] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:25:49,873] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.79 | bwd_microstep: 1358.92 | bwd_inner_microstep: 1356.00 | bwd_allreduce_microstep: 2.89 | step_microstep: 26.36
[2024-11-14 15:25:49,873] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.78 | bwd: 1358.93 | bwd_inner: 1356.00 | bwd_allreduce: 2.90 | step: 26.36
[2024-11-14 15:25:51,149] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:25:51,149] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.30 | bwd_microstep: 927.93 | bwd_inner_microstep: 925.36 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.31
[2024-11-14 15:25:51,149] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.30 | bwd: 927.94 | bwd_inner: 925.36 | bwd_allreduce: 2.56 | step: 25.31
[2024-11-14 15:25:52,424] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:25:52,424] [INFO] [logging.py:96:log_dist] [Rank 0] step=940, skipped=2, lr=[0.00024755568481302524], mom=[(0.9, 0.95)]
[2024-11-14 15:25:52,425] [INFO] [timer.py:259:stop] epoch=0/micro_step=940/global_step=940, RunningAvgSamplesPerSec=775.7949525615887, CurrSamplesPerSec=803.5321898712415, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:25:52,425] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.92 | bwd_microstep: 927.14 | bwd_inner_microstep: 924.58 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.54
[2024-11-14 15:25:52,425] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.91 | bwd: 927.15 | bwd_inner: 924.58 | bwd_allreduce: 2.55 | step: 25.54
[2024-11-14 15:25:54,005] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:25:54,005] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.61 | bwd_microstep: 1147.65 | bwd_inner_microstep: 1144.76 | bwd_allreduce_microstep: 2.86 | step_microstep: 26.02
[2024-11-14 15:25:54,005] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.60 | bwd: 1147.66 | bwd_inner: 1144.76 | bwd_allreduce: 2.88 | step: 26.02
[2024-11-14 15:25:55,584] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:25:55,584] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.53 | bwd_microstep: 1146.98 | bwd_inner_microstep: 1144.42 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.24
[2024-11-14 15:25:55,584] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.52 | bwd: 1146.99 | bwd_inner: 1144.42 | bwd_allreduce: 2.55 | step: 25.24
[2024-11-14 15:25:56,860] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:25:56,860] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.00 | bwd_microstep: 927.12 | bwd_inner_microstep: 924.29 | bwd_allreduce_microstep: 2.80 | step_microstep: 26.20
[2024-11-14 15:25:56,860] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.99 | bwd: 927.13 | bwd_inner: 924.29 | bwd_allreduce: 2.81 | step: 26.20
[2024-11-14 15:25:58,135] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:25:58,135] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.89 | bwd_microstep: 926.69 | bwd_inner_microstep: 924.13 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.33
[2024-11-14 15:25:58,135] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.89 | bwd: 926.70 | bwd_inner: 924.13 | bwd_allreduce: 2.55 | step: 25.34
[2024-11-14 15:25:59,716] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:25:59,717] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.70 | bwd_microstep: 1147.40 | bwd_inner_microstep: 1144.63 | bwd_allreduce_microstep: 2.74 | step_microstep: 27.63
[2024-11-14 15:25:59,717] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.70 | bwd: 1147.41 | bwd_inner: 1144.63 | bwd_allreduce: 2.75 | step: 27.63
[2024-11-14 15:26:01,297] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.53
[2024-11-14 15:26:01,297] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 406.79 | bwd_microstep: 1147.52 | bwd_inner_microstep: 1144.97 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.26
[2024-11-14 15:26:01,297] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 406.78 | bwd: 1147.53 | bwd_inner: 1144.97 | bwd_allreduce: 2.54 | step: 25.26
[2024-11-14 15:26:02,876] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:26:02,876] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.44 | bwd_microstep: 1146.92 | bwd_inner_microstep: 1144.37 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.46
[2024-11-14 15:26:02,877] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.43 | bwd: 1146.93 | bwd_inner: 1144.37 | bwd_allreduce: 2.53 | step: 25.46
[2024-11-14 15:26:04,155] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:26:04,155] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.85 | bwd_inner_microstep: 925.12 | bwd_allreduce_microstep: 2.71 | step_microstep: 27.34
[2024-11-14 15:26:04,157] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 927.86 | bwd_inner: 925.12 | bwd_allreduce: 2.72 | step: 27.34
[2024-11-14 15:26:05,433] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:05,433] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.59 | bwd_inner_microstep: 925.05 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.28
[2024-11-14 15:26:05,433] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.59 | bwd_inner: 925.05 | bwd_allreduce: 2.52 | step: 25.28
[2024-11-14 15:26:06,709] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:06,709] [INFO] [logging.py:96:log_dist] [Rank 0] step=950, skipped=2, lr=[0.000247892792518796], mom=[(0.9, 0.95)]
[2024-11-14 15:26:06,709] [INFO] [timer.py:259:stop] epoch=0/micro_step=950/global_step=950, RunningAvgSamplesPerSec=775.1307121215328, CurrSamplesPerSec=803.0620813736833, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:26:06,709] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.01 | bwd_microstep: 927.81 | bwd_inner_microstep: 925.26 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.53
[2024-11-14 15:26:06,709] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.00 | bwd: 927.82 | bwd_inner: 925.26 | bwd_allreduce: 2.54 | step: 25.54
[2024-11-14 15:26:07,986] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:26:07,986] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.33 | bwd_microstep: 928.06 | bwd_inner_microstep: 925.50 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.38
[2024-11-14 15:26:07,986] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.32 | bwd: 928.07 | bwd_inner: 925.50 | bwd_allreduce: 2.54 | step: 25.38
[2024-11-14 15:26:08,968] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:08,968] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.38 | bwd_microstep: 712.47 | bwd_inner_microstep: 709.91 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.24
[2024-11-14 15:26:08,968] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.37 | bwd: 712.48 | bwd_inner: 709.91 | bwd_allreduce: 2.54 | step: 25.25
[2024-11-14 15:26:10,243] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:10,244] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.44 | bwd_inner_microstep: 924.90 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:26:10,244] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 927.45 | bwd_inner: 924.90 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:26:11,520] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:26:11,520] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.37 | bwd_microstep: 927.81 | bwd_inner_microstep: 925.23 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.39
[2024-11-14 15:26:11,520] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.37 | bwd: 927.81 | bwd_inner: 925.23 | bwd_allreduce: 2.56 | step: 25.39
[2024-11-14 15:26:14,015] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:14,016] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 662.39 | bwd_microstep: 1806.64 | bwd_inner_microstep: 1804.07 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:26:14,016] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 662.39 | bwd: 1806.64 | bwd_inner: 1804.07 | bwd_allreduce: 2.55 | step: 25.29
[2024-11-14 15:26:15,291] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.53
[2024-11-14 15:26:15,292] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.74 | bwd_microstep: 927.61 | bwd_inner_microstep: 924.96 | bwd_allreduce_microstep: 2.62 | step_microstep: 25.76
[2024-11-14 15:26:15,292] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.74 | bwd: 927.61 | bwd_inner: 924.96 | bwd_allreduce: 2.63 | step: 25.76
[2024-11-14 15:26:16,568] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:26:16,568] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.38 | bwd_microstep: 927.85 | bwd_inner_microstep: 925.25 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.33
[2024-11-14 15:26:16,568] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.37 | bwd: 927.85 | bwd_inner: 925.25 | bwd_allreduce: 2.58 | step: 25.33
[2024-11-14 15:26:17,550] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:17,551] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.58 | bwd_microstep: 712.44 | bwd_inner_microstep: 709.91 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.28
[2024-11-14 15:26:17,551] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.57 | bwd: 712.45 | bwd_inner: 709.91 | bwd_allreduce: 2.52 | step: 25.28
[2024-11-14 15:26:18,827] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:26:18,827] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.23 | bwd_microstep: 927.79 | bwd_inner_microstep: 925.20 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.34
[2024-11-14 15:26:18,827] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.22 | bwd: 927.80 | bwd_inner: 925.20 | bwd_allreduce: 2.57 | step: 25.34
[2024-11-14 15:26:20,104] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:26:20,104] [INFO] [logging.py:96:log_dist] [Rank 0] step=960, skipped=2, lr=[0.00024822636282766195], mom=[(0.9, 0.95)]
[2024-11-14 15:26:20,104] [INFO] [timer.py:259:stop] epoch=0/micro_step=960/global_step=960, RunningAvgSamplesPerSec=775.0244304178883, CurrSamplesPerSec=802.7795899936291, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:26:20,104] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.32 | bwd_microstep: 927.84 | bwd_inner_microstep: 925.26 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.66
[2024-11-14 15:26:20,104] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.31 | bwd: 927.84 | bwd_inner: 925.25 | bwd_allreduce: 2.56 | step: 25.66
[2024-11-14 15:26:21,380] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:26:21,380] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.93 | bwd_microstep: 927.58 | bwd_inner_microstep: 924.97 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.41
[2024-11-14 15:26:21,380] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.91 | bwd: 927.59 | bwd_inner: 924.97 | bwd_allreduce: 2.60 | step: 25.41
[2024-11-14 15:26:22,656] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:26:22,656] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.04 | bwd_microstep: 927.61 | bwd_inner_microstep: 925.07 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.32
[2024-11-14 15:26:22,658] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 927.62 | bwd_inner: 925.06 | bwd_allreduce: 2.53 | step: 25.32
[2024-11-14 15:26:23,934] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.50
[2024-11-14 15:26:23,935] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.32 | bwd_microstep: 927.94 | bwd_inner_microstep: 925.25 | bwd_allreduce_microstep: 2.65 | step_microstep: 25.58
[2024-11-14 15:26:23,935] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.31 | bwd: 927.94 | bwd_inner: 925.25 | bwd_allreduce: 2.67 | step: 25.59
[2024-11-14 15:26:25,816] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:26:25,816] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.98 | bwd_microstep: 1359.56 | bwd_inner_microstep: 1356.99 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.23
[2024-11-14 15:26:25,816] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.97 | bwd: 1359.56 | bwd_inner: 1356.99 | bwd_allreduce: 2.55 | step: 25.23
[2024-11-14 15:26:27,395] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:27,395] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.54 | bwd_microstep: 1147.81 | bwd_inner_microstep: 1145.02 | bwd_allreduce_microstep: 2.76 | step_microstep: 25.22
[2024-11-14 15:26:27,395] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.54 | bwd: 1147.82 | bwd_inner: 1145.02 | bwd_allreduce: 2.78 | step: 25.22
[2024-11-14 15:26:28,377] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:26:28,377] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.17 | bwd_microstep: 712.04 | bwd_inner_microstep: 709.47 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.32
[2024-11-14 15:26:28,377] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.16 | bwd: 712.05 | bwd_inner: 709.47 | bwd_allreduce: 2.56 | step: 25.32
[2024-11-14 15:26:29,652] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:26:29,653] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 927.30 | bwd_inner_microstep: 924.75 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.48
[2024-11-14 15:26:29,653] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.11 | bwd: 927.30 | bwd_inner: 924.75 | bwd_allreduce: 2.53 | step: 25.48
[2024-11-14 15:26:30,929] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:26:30,929] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 927.42 | bwd_inner_microstep: 924.88 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.35
[2024-11-14 15:26:30,929] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.43 | bwd_inner: 924.88 | bwd_allreduce: 2.53 | step: 25.35
[2024-11-14 15:26:32,508] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:26:32,509] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.20 | bwd_microstep: 1146.85 | bwd_inner_microstep: 1143.93 | bwd_allreduce_microstep: 2.89 | step_microstep: 26.59
[2024-11-14 15:26:32,509] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.19 | bwd: 1146.86 | bwd_inner: 1143.93 | bwd_allreduce: 2.91 | step: 26.59
[2024-11-14 15:26:34,688] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:26:34,688] [INFO] [logging.py:96:log_dist] [Rank 0] step=970, skipped=2, lr=[0.00024855646920781153], mom=[(0.9, 0.95)]
[2024-11-14 15:26:34,688] [INFO] [timer.py:259:stop] epoch=0/micro_step=970/global_step=970, RunningAvgSamplesPerSec=774.2019896729239, CurrSamplesPerSec=470.11786581433495, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:26:34,688] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 578.30 | bwd_microstep: 1574.51 | bwd_inner_microstep: 1571.94 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.60
[2024-11-14 15:26:34,688] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 578.29 | bwd: 1574.52 | bwd_inner: 1571.94 | bwd_allreduce: 2.56 | step: 25.61
[2024-11-14 15:26:35,964] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:35,964] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.97 | bwd_microstep: 927.50 | bwd_inner_microstep: 924.96 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.21
[2024-11-14 15:26:35,964] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.96 | bwd: 927.51 | bwd_inner: 924.96 | bwd_allreduce: 2.52 | step: 25.22
[2024-11-14 15:26:37,545] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:37,545] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.70 | bwd_microstep: 1147.82 | bwd_inner_microstep: 1144.82 | bwd_allreduce_microstep: 2.97 | step_microstep: 26.13
[2024-11-14 15:26:37,545] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.69 | bwd: 1147.83 | bwd_inner: 1144.82 | bwd_allreduce: 2.98 | step: 26.13
[2024-11-14 15:26:38,821] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:26:38,821] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.03 | bwd_microstep: 927.46 | bwd_inner_microstep: 924.60 | bwd_allreduce_microstep: 2.82 | step_microstep: 25.98
[2024-11-14 15:26:38,822] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 927.46 | bwd_inner: 924.60 | bwd_allreduce: 2.83 | step: 25.98
[2024-11-14 15:26:40,096] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:26:40,097] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 926.88 | bwd_inner_microstep: 924.34 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.25
[2024-11-14 15:26:40,097] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 926.88 | bwd_inner: 924.34 | bwd_allreduce: 2.52 | step: 25.25
[2024-11-14 15:26:41,676] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:26:41,677] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.56 | bwd_microstep: 1147.27 | bwd_inner_microstep: 1144.42 | bwd_allreduce_microstep: 2.81 | step_microstep: 26.14
[2024-11-14 15:26:41,677] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.55 | bwd: 1147.28 | bwd_inner: 1144.42 | bwd_allreduce: 2.83 | step: 26.14
[2024-11-14 15:26:43,255] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:26:43,256] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.60 | bwd_microstep: 1146.95 | bwd_inner_microstep: 1144.41 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:26:43,256] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.60 | bwd: 1146.96 | bwd_inner: 1144.41 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:26:44,834] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:44,835] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.37 | bwd_microstep: 1147.36 | bwd_inner_microstep: 1144.79 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.25
[2024-11-14 15:26:44,835] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.36 | bwd: 1147.37 | bwd_inner: 1144.79 | bwd_allreduce: 2.56 | step: 25.25
[2024-11-14 15:26:44.835168][end of epoch 1][local 0: 976][global 976] Trained with 19988480.0 tokens! Saving ckp and logs!
Model dir ./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1/epoch_1
./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1/epoch_1/global_step977
created, continue ...
[2024-11-14 15:26:44,835] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step977 is about to be saved!
[2024-11-14 15:26:44,838] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1/epoch_1/global_step977/mp_rank_00_model_states.pt
[2024-11-14 15:26:44,839] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1/epoch_1/global_step977/mp_rank_00_model_states.pt...
[2024-11-14 15:26:45,195] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1/epoch_1/global_step977/mp_rank_00_model_states.pt.
[2024-11-14 15:26:45,196] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1/epoch_1/global_step977/zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-14 15:26:47,950] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1/epoch_1/global_step977/zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-14 15:26:47,951] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved ./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1/epoch_1/global_step977/zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-14 15:26:47,951] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step977 is ready now!
Model saved in ./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1/epoch_1 using deepspeed API.
log saved in ./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1/log.csv!
[2024-11-14 15:26:47.952006][input_id] shape: torch.Size([1024, 48, 13])
[2024-11-14 15:26:48,936] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:26:48,936] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 246.64 | bwd_microstep: 711.41 | bwd_inner_microstep: 708.86 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.24
[2024-11-14 15:26:48,936] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 246.62 | bwd: 711.42 | bwd_inner: 708.86 | bwd_allreduce: 2.54 | step: 25.24
[2024-11-14 15:26:50,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:26:50,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 404.86 | bwd_microstep: 1145.26 | bwd_inner_microstep: 1142.72 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.23
[2024-11-14 15:26:50,512] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 404.85 | bwd: 1145.27 | bwd_inner: 1142.72 | bwd_allreduce: 2.53 | step: 25.23
[2024-11-14 15:26:51,493] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:26:51,493] [INFO] [logging.py:96:log_dist] [Rank 0] step=980, skipped=2, lr=[0.0002488831828621461], mom=[(0.9, 0.95)]
[2024-11-14 15:26:51,493] [INFO] [timer.py:259:stop] epoch=0/micro_step=980/global_step=980, RunningAvgSamplesPerSec=773.9321957183308, CurrSamplesPerSec=1044.7263277686725, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:26:51,494] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.09 | bwd_microstep: 711.30 | bwd_inner_microstep: 708.75 | bwd_allreduce_microstep: 2.53 | step_microstep: 26.00
[2024-11-14 15:26:51,494] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.08 | bwd: 711.31 | bwd_inner: 708.75 | bwd_allreduce: 2.54 | step: 26.00
[2024-11-14 15:26:52,769] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:52,769] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.70 | bwd_microstep: 926.92 | bwd_inner_microstep: 924.38 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.79
[2024-11-14 15:26:52,769] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.69 | bwd: 926.93 | bwd_inner: 924.38 | bwd_allreduce: 2.52 | step: 25.80
[2024-11-14 15:26:54,044] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:54,044] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.84 | bwd_microstep: 926.76 | bwd_inner_microstep: 924.20 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.22
[2024-11-14 15:26:54,044] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.82 | bwd: 926.77 | bwd_inner: 924.20 | bwd_allreduce: 2.54 | step: 25.23
[2024-11-14 15:26:55,320] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:26:55,320] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.31 | bwd_inner_microstep: 924.73 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.32
[2024-11-14 15:26:55,320] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.32 | bwd_inner: 924.73 | bwd_allreduce: 2.56 | step: 25.32
[2024-11-14 15:26:56,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:26:56,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.95 | bwd_microstep: 927.05 | bwd_inner_microstep: 924.48 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.32
[2024-11-14 15:26:56,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.94 | bwd: 927.05 | bwd_inner: 924.48 | bwd_allreduce: 2.55 | step: 25.32
[2024-11-14 15:26:58,476] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:26:58,476] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.45 | bwd_microstep: 1358.48 | bwd_inner_microstep: 1355.65 | bwd_allreduce_microstep: 2.81 | step_microstep: 27.09
[2024-11-14 15:26:58,477] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.44 | bwd: 1358.49 | bwd_inner: 1355.65 | bwd_allreduce: 2.82 | step: 27.09
[2024-11-14 15:26:59,752] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.48
[2024-11-14 15:26:59,752] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.92 | bwd_microstep: 927.22 | bwd_inner_microstep: 924.68 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:26:59,752] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.91 | bwd: 927.23 | bwd_inner: 924.68 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:27:01,028] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:27:01,028] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.92 | bwd_microstep: 926.62 | bwd_inner_microstep: 924.06 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.68
[2024-11-14 15:27:01,028] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.91 | bwd: 926.62 | bwd_inner: 924.06 | bwd_allreduce: 2.54 | step: 25.69
[2024-11-14 15:27:02,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:27:02,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 927.00 | bwd_inner_microstep: 924.45 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.23
[2024-11-14 15:27:02,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.93 | bwd: 927.01 | bwd_inner: 924.45 | bwd_allreduce: 2.54 | step: 25.23
[2024-11-14 15:27:03,284] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:27:03,285] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.25 | bwd_microstep: 711.95 | bwd_inner_microstep: 709.40 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.30
[2024-11-14 15:27:03,285] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.24 | bwd: 711.96 | bwd_inner: 709.40 | bwd_allreduce: 2.53 | step: 25.30
[2024-11-14 15:27:04,559] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:27:04,559] [INFO] [logging.py:96:log_dist] [Rank 0] step=990, skipped=2, lr=[0.0002492065728204621], mom=[(0.9, 0.95)]
[2024-11-14 15:27:04,560] [INFO] [timer.py:259:stop] epoch=0/micro_step=990/global_step=990, RunningAvgSamplesPerSec=774.0361614172394, CurrSamplesPerSec=803.7442116087161, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:27:04,560] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.87 | bwd_microstep: 926.83 | bwd_inner_microstep: 924.27 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.57
[2024-11-14 15:27:04,560] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.87 | bwd: 926.84 | bwd_inner: 924.27 | bwd_allreduce: 2.55 | step: 25.57
[2024-11-14 15:27:05,835] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:27:05,835] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.00 | bwd_microstep: 927.12 | bwd_inner_microstep: 924.57 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.31
[2024-11-14 15:27:05,835] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.99 | bwd: 927.13 | bwd_inner: 924.57 | bwd_allreduce: 2.54 | step: 25.31
[2024-11-14 15:27:07,110] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:27:07,111] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 927.11 | bwd_inner_microstep: 924.54 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.30
[2024-11-14 15:27:07,111] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 927.11 | bwd_inner: 924.54 | bwd_allreduce: 2.55 | step: 25.30
[2024-11-14 15:27:08,386] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:27:08,386] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.13 | bwd_inner_microstep: 924.56 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.28
[2024-11-14 15:27:08,386] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.19 | bwd: 927.14 | bwd_inner: 924.56 | bwd_allreduce: 2.55 | step: 25.28
[2024-11-14 15:27:09,965] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:27:09,966] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.14 | bwd_microstep: 1146.66 | bwd_inner_microstep: 1143.81 | bwd_allreduce_microstep: 2.82 | step_microstep: 26.39
[2024-11-14 15:27:09,966] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.14 | bwd: 1146.67 | bwd_inner: 1143.82 | bwd_allreduce: 2.83 | step: 26.39
[2024-11-14 15:27:11,242] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:27:11,242] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.06 | bwd_microstep: 927.26 | bwd_inner_microstep: 924.45 | bwd_allreduce_microstep: 2.78 | step_microstep: 26.07
[2024-11-14 15:27:11,242] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.05 | bwd: 927.27 | bwd_inner: 924.45 | bwd_allreduce: 2.79 | step: 26.08
[2024-11-14 15:27:12,519] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:27:12,519] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.52 | bwd_microstep: 927.65 | bwd_inner_microstep: 925.08 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.66
[2024-11-14 15:27:12,519] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.51 | bwd: 927.66 | bwd_inner: 925.08 | bwd_allreduce: 2.56 | step: 25.67
[2024-11-14 15:27:13,501] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:27:13,501] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.49 | bwd_microstep: 712.22 | bwd_inner_microstep: 709.66 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.66
[2024-11-14 15:27:13,501] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.48 | bwd: 712.23 | bwd_inner: 709.66 | bwd_allreduce: 2.54 | step: 25.66
[2024-11-14 15:27:14,483] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:27:14,483] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.31 | bwd_microstep: 712.15 | bwd_inner_microstep: 709.56 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.40
[2024-11-14 15:27:14,483] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.30 | bwd: 712.16 | bwd_inner: 709.56 | bwd_allreduce: 2.57 | step: 25.41
[2024-11-14 15:27:15,758] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:27:15,758] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.00 | bwd_inner_microstep: 924.45 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.25
[2024-11-14 15:27:15,758] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.01 | bwd_inner: 924.45 | bwd_allreduce: 2.54 | step: 25.25
[2024-11-14 15:27:17,337] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:27:17,337] [INFO] [logging.py:96:log_dist] [Rank 0] step=1000, skipped=2, lr=[0.0002495267060269923], mom=[(0.9, 0.95)]
[2024-11-14 15:27:17,338] [INFO] [timer.py:259:stop] epoch=0/micro_step=1000/global_step=1000, RunningAvgSamplesPerSec=774.3068608335867, CurrSamplesPerSec=648.8099073552252, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:27:17,338] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.66 | bwd_microstep: 1147.19 | bwd_inner_microstep: 1144.61 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.66
[2024-11-14 15:27:17,338] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.65 | bwd: 1147.20 | bwd_inner: 1144.61 | bwd_allreduce: 2.57 | step: 25.66
[2024-11-14 15:27:18,614] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:27:18,614] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.86 | bwd_microstep: 927.19 | bwd_inner_microstep: 924.44 | bwd_allreduce_microstep: 2.72 | step_microstep: 26.23
[2024-11-14 15:27:18,614] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.86 | bwd: 927.20 | bwd_inner: 924.44 | bwd_allreduce: 2.73 | step: 26.23
[2024-11-14 15:27:18.614595][epoch 1][local 0: 1000][global 1000] train_loss: 0.202056, 739.6 samples / 14792 tokens per sec
[2024-11-14 15:27:19,890] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:27:19,890] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.24 | bwd_microstep: 927.44 | bwd_inner_microstep: 924.88 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.29
[2024-11-14 15:27:19,890] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.23 | bwd: 927.45 | bwd_inner: 924.88 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:27:21,165] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:27:21,166] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.10 | bwd_inner_microstep: 924.47 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.37
[2024-11-14 15:27:21,166] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.11 | bwd_inner: 924.47 | bwd_allreduce: 2.61 | step: 25.38
[2024-11-14 15:27:22,440] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:27:22,440] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.93 | bwd_microstep: 926.62 | bwd_inner_microstep: 924.05 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.31
[2024-11-14 15:27:22,440] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.92 | bwd: 926.62 | bwd_inner: 924.05 | bwd_allreduce: 2.55 | step: 25.31
[2024-11-14 15:27:23,715] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:27:23,716] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.92 | bwd_microstep: 926.92 | bwd_inner_microstep: 924.37 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.37
[2024-11-14 15:27:23,716] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.91 | bwd: 926.93 | bwd_inner: 924.37 | bwd_allreduce: 2.54 | step: 25.37
[2024-11-14 15:27:24,698] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:27:24,698] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.51 | bwd_microstep: 712.39 | bwd_inner_microstep: 709.79 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.52
[2024-11-14 15:27:24,698] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.50 | bwd: 712.40 | bwd_inner: 709.79 | bwd_allreduce: 2.59 | step: 25.52
[2024-11-14 15:27:25,973] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:27:25,974] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.04 | bwd_inner_microstep: 924.45 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.35
[2024-11-14 15:27:25,974] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.04 | bwd_inner: 924.45 | bwd_allreduce: 2.56 | step: 25.35
[2024-11-14 15:27:26,956] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:27:26,956] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.45 | bwd_microstep: 712.40 | bwd_inner_microstep: 709.84 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:27:26,956] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.44 | bwd: 712.40 | bwd_inner: 709.84 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:27:28,231] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:27:28,232] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.31 | bwd_inner_microstep: 924.71 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.34
[2024-11-14 15:27:28,232] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.32 | bwd_inner: 924.71 | bwd_allreduce: 2.58 | step: 25.34
[2024-11-14 15:27:29,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:27:29,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=1010, skipped=2, lr=[0.00024984364742358206], mom=[(0.9, 0.95)]
[2024-11-14 15:27:29,507] [INFO] [timer.py:259:stop] epoch=0/micro_step=1010/global_step=1010, RunningAvgSamplesPerSec=774.9262578702732, CurrSamplesPerSec=803.5153532237026, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:27:29,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 926.95 | bwd_inner_microstep: 924.37 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.58
[2024-11-14 15:27:29,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 926.95 | bwd_inner: 924.37 | bwd_allreduce: 2.56 | step: 25.58
[2024-11-14 15:27:30,782] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.51
[2024-11-14 15:27:30,783] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 926.74 | bwd_inner_microstep: 924.15 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.80
[2024-11-14 15:27:30,783] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.11 | bwd: 926.75 | bwd_inner: 924.15 | bwd_allreduce: 2.57 | step: 25.80
[2024-11-14 15:27:32,664] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.52
[2024-11-14 15:27:32,664] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.76 | bwd_microstep: 1358.82 | bwd_inner_microstep: 1355.92 | bwd_allreduce_microstep: 2.87 | step_microstep: 26.61
[2024-11-14 15:27:32,664] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.75 | bwd: 1358.83 | bwd_inner: 1355.92 | bwd_allreduce: 2.88 | step: 26.61
[2024-11-14 15:27:33,940] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:27:33,940] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.02 | bwd_microstep: 927.17 | bwd_inner_microstep: 924.61 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.27
[2024-11-14 15:27:33,940] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 927.17 | bwd_inner: 924.61 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:27:35,215] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:27:35,215] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.10 | bwd_microstep: 926.99 | bwd_inner_microstep: 924.41 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.30
[2024-11-14 15:27:35,215] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 927.00 | bwd_inner: 924.41 | bwd_allreduce: 2.56 | step: 25.31
[2024-11-14 15:27:36,196] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:27:36,197] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.37 | bwd_microstep: 712.01 | bwd_inner_microstep: 709.47 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:27:36,197] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.37 | bwd: 712.02 | bwd_inner: 709.47 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:27:37,472] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:27:37,473] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.31 | bwd_microstep: 927.36 | bwd_inner_microstep: 924.80 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.30
[2024-11-14 15:27:37,473] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.30 | bwd: 927.37 | bwd_inner: 924.80 | bwd_allreduce: 2.54 | step: 25.31
[2024-11-14 15:27:38,748] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:27:38,748] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.33 | bwd_microstep: 927.40 | bwd_inner_microstep: 924.85 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.27
[2024-11-14 15:27:38,749] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.32 | bwd: 927.40 | bwd_inner: 924.85 | bwd_allreduce: 2.53 | step: 25.27
[2024-11-14 15:27:40,023] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:27:40,024] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 926.80 | bwd_inner_microstep: 924.26 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.21
[2024-11-14 15:27:40,024] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 926.81 | bwd_inner: 924.26 | bwd_allreduce: 2.52 | step: 25.22
[2024-11-14 15:27:41,300] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:27:41,300] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.37 | bwd_microstep: 927.46 | bwd_inner_microstep: 924.91 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.23
[2024-11-14 15:27:41,300] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.36 | bwd: 927.47 | bwd_inner: 924.91 | bwd_allreduce: 2.53 | step: 25.23
[2024-11-14 15:27:42,576] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:27:42,576] [INFO] [logging.py:96:log_dist] [Rank 0] step=1020, skipped=2, lr=[0.00025015746002876], mom=[(0.9, 0.95)]
[2024-11-14 15:27:42,576] [INFO] [timer.py:259:stop] epoch=0/micro_step=1020/global_step=1020, RunningAvgSamplesPerSec=775.0160434082114, CurrSamplesPerSec=803.1675036767105, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:27:42,576] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.38 | bwd_microstep: 927.26 | bwd_inner_microstep: 924.72 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.53
[2024-11-14 15:27:42,576] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.37 | bwd: 927.27 | bwd_inner: 924.72 | bwd_allreduce: 2.53 | step: 25.53
[2024-11-14 15:27:43,851] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:27:43,851] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.98 | bwd_microstep: 926.89 | bwd_inner_microstep: 924.34 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.21
[2024-11-14 15:27:43,851] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 926.90 | bwd_inner: 924.34 | bwd_allreduce: 2.54 | step: 25.21
[2024-11-14 15:27:45,126] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:27:45,126] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.00 | bwd_microstep: 926.63 | bwd_inner_microstep: 924.08 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:27:45,126] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.99 | bwd: 926.63 | bwd_inner: 924.08 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:27:46,401] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:27:46,401] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.10 | bwd_microstep: 926.99 | bwd_inner_microstep: 924.39 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.32
[2024-11-14 15:27:46,401] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.09 | bwd: 927.00 | bwd_inner: 924.39 | bwd_allreduce: 2.58 | step: 25.33
[2024-11-14 15:27:47,981] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:27:47,981] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.56 | bwd_microstep: 1147.58 | bwd_inner_microstep: 1144.54 | bwd_allreduce_microstep: 3.01 | step_microstep: 25.86
[2024-11-14 15:27:47,981] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.56 | bwd: 1147.59 | bwd_inner: 1144.54 | bwd_allreduce: 3.03 | step: 25.87
[2024-11-14 15:27:49,562] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:27:49,563] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 406.02 | bwd_microstep: 1147.56 | bwd_inner_microstep: 1144.64 | bwd_allreduce_microstep: 2.89 | step_microstep: 26.60
[2024-11-14 15:27:49,563] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 406.02 | bwd: 1147.56 | bwd_inner: 1144.64 | bwd_allreduce: 2.90 | step: 26.61
[2024-11-14 15:27:50,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:27:50,840] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.56 | bwd_inner_microstep: 924.54 | bwd_allreduce_microstep: 2.98 | step_microstep: 26.18
[2024-11-14 15:27:50,840] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 927.57 | bwd_inner: 924.54 | bwd_allreduce: 3.00 | step: 26.19
[2024-11-14 15:27:52,115] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:27:52,116] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.31 | bwd_microstep: 927.32 | bwd_inner_microstep: 924.73 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.30
[2024-11-14 15:27:52,122] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.30 | bwd: 927.33 | bwd_inner: 924.73 | bwd_allreduce: 2.57 | step: 25.30
[2024-11-14 15:27:53,397] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:27:53,398] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.22 | bwd_microstep: 927.32 | bwd_inner_microstep: 924.76 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.34
[2024-11-14 15:27:53,398] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.21 | bwd: 927.33 | bwd_inner: 924.76 | bwd_allreduce: 2.54 | step: 25.34
[2024-11-14 15:27:54,379] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:27:54,379] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.30 | bwd_microstep: 712.11 | bwd_inner_microstep: 709.54 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.30
[2024-11-14 15:27:54,379] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.29 | bwd: 712.12 | bwd_inner: 709.54 | bwd_allreduce: 2.55 | step: 25.30
[2024-11-14 15:27:55,655] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:27:55,655] [INFO] [logging.py:96:log_dist] [Rank 0] step=1030, skipped=2, lr=[0.0002504682050129446], mom=[(0.9, 0.95)]
[2024-11-14 15:27:55,655] [INFO] [timer.py:259:stop] epoch=0/micro_step=1030/global_step=1030, RunningAvgSamplesPerSec=775.1015184979262, CurrSamplesPerSec=803.1260522900573, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:27:55,655] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.15 | bwd_microstep: 927.57 | bwd_inner_microstep: 925.01 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.53
[2024-11-14 15:27:55,655] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 927.58 | bwd_inner: 925.01 | bwd_allreduce: 2.54 | step: 25.53
[2024-11-14 15:27:56,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:27:56,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.22 | bwd_microstep: 927.20 | bwd_inner_microstep: 924.66 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.35
[2024-11-14 15:27:56,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.21 | bwd: 927.21 | bwd_inner: 924.66 | bwd_allreduce: 2.53 | step: 25.35
[2024-11-14 15:27:57,913] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:27:57,913] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.42 | bwd_microstep: 711.97 | bwd_inner_microstep: 709.41 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.40
[2024-11-14 15:27:57,913] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.41 | bwd: 711.97 | bwd_inner: 709.41 | bwd_allreduce: 2.54 | step: 25.40
[2024-11-14 15:28:00,095] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:28:00,095] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 578.35 | bwd_microstep: 1576.44 | bwd_inner_microstep: 1573.58 | bwd_allreduce_microstep: 2.82 | step_microstep: 26.18
[2024-11-14 15:28:00,095] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 578.34 | bwd: 1576.45 | bwd_inner: 1573.58 | bwd_allreduce: 2.84 | step: 26.18
[2024-11-14 15:28:01,673] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:28:01,674] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.36 | bwd_microstep: 1146.86 | bwd_inner_microstep: 1144.31 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.23
[2024-11-14 15:28:01,674] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.35 | bwd: 1146.86 | bwd_inner: 1144.31 | bwd_allreduce: 2.53 | step: 25.23
[2024-11-14 15:28:02,950] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:28:02,950] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.88 | bwd_microstep: 927.37 | bwd_inner_microstep: 924.58 | bwd_allreduce_microstep: 2.76 | step_microstep: 26.28
[2024-11-14 15:28:02,950] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.88 | bwd: 927.37 | bwd_inner: 924.58 | bwd_allreduce: 2.77 | step: 26.28
[2024-11-14 15:28:04,530] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:28:04,530] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.22 | bwd_microstep: 1146.79 | bwd_inner_microstep: 1143.87 | bwd_allreduce_microstep: 2.89 | step_microstep: 26.89
[2024-11-14 15:28:04,530] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.22 | bwd: 1146.80 | bwd_inner: 1143.87 | bwd_allreduce: 2.90 | step: 26.89
[2024-11-14 15:28:05,807] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:28:05,807] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.02 | bwd_microstep: 927.45 | bwd_inner_microstep: 924.51 | bwd_allreduce_microstep: 2.91 | step_microstep: 26.34
[2024-11-14 15:28:05,807] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 927.46 | bwd_inner: 924.51 | bwd_allreduce: 2.92 | step: 26.34
[2024-11-14 15:28:07,386] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:28:07,387] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.47 | bwd_microstep: 1147.20 | bwd_inner_microstep: 1144.37 | bwd_allreduce_microstep: 2.81 | step_microstep: 26.06
[2024-11-14 15:28:07,387] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.46 | bwd: 1147.21 | bwd_inner: 1144.37 | bwd_allreduce: 2.82 | step: 26.06
[2024-11-14 15:28:08,661] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:28:08,662] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.77 | bwd_microstep: 926.75 | bwd_inner_microstep: 924.17 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.46
[2024-11-14 15:28:08,662] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.76 | bwd: 926.76 | bwd_inner: 924.17 | bwd_allreduce: 2.57 | step: 25.46
[2024-11-14 15:28:10,241] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:28:10,242] [INFO] [logging.py:96:log_dist] [Rank 0] step=1040, skipped=2, lr=[0.00025077594177000937], mom=[(0.9, 0.95)]
[2024-11-14 15:28:10,242] [INFO] [timer.py:259:stop] epoch=0/micro_step=1040/global_step=1040, RunningAvgSamplesPerSec=774.3309960886482, CurrSamplesPerSec=648.5170845152621, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:28:10,242] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.51 | bwd_microstep: 1147.46 | bwd_inner_microstep: 1144.64 | bwd_allreduce_microstep: 2.79 | step_microstep: 26.25
[2024-11-14 15:28:10,242] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.51 | bwd: 1147.47 | bwd_inner: 1144.64 | bwd_allreduce: 2.80 | step: 26.25
[2024-11-14 15:28:11,518] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:28:11,518] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.89 | bwd_microstep: 927.24 | bwd_inner_microstep: 924.40 | bwd_allreduce_microstep: 2.81 | step_microstep: 26.46
[2024-11-14 15:28:11,518] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.88 | bwd: 927.25 | bwd_inner: 924.40 | bwd_allreduce: 2.82 | step: 26.47
[2024-11-14 15:28:12,794] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:28:12,794] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.13 | bwd_microstep: 927.01 | bwd_inner_microstep: 924.43 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.30
[2024-11-14 15:28:12,794] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 927.02 | bwd_inner: 924.43 | bwd_allreduce: 2.57 | step: 25.30
[2024-11-14 15:28:14,069] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:28:14,069] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 926.95 | bwd_inner_microstep: 924.37 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.35
[2024-11-14 15:28:14,070] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 926.96 | bwd_inner: 924.37 | bwd_allreduce: 2.56 | step: 25.36
[2024-11-14 15:28:15,344] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:28:15,345] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.03 | bwd_microstep: 926.63 | bwd_inner_microstep: 924.01 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.47
[2024-11-14 15:28:15,345] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 926.64 | bwd_inner: 924.01 | bwd_allreduce: 2.60 | step: 25.47
[2024-11-14 15:28:16,619] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:28:16,619] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.54 | bwd_microstep: 926.63 | bwd_inner_microstep: 924.08 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.30
[2024-11-14 15:28:16,619] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.54 | bwd: 926.63 | bwd_inner: 924.08 | bwd_allreduce: 2.53 | step: 25.30
[2024-11-14 15:28:17,600] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:28:17,600] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.19 | bwd_microstep: 711.87 | bwd_inner_microstep: 709.32 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.23
[2024-11-14 15:28:17,601] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.18 | bwd: 711.88 | bwd_inner: 709.32 | bwd_allreduce: 2.53 | step: 25.23
[2024-11-14 15:28:18,876] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:28:18,876] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.14 | bwd_microstep: 927.31 | bwd_inner_microstep: 924.70 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.31
[2024-11-14 15:28:18,876] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.13 | bwd: 927.32 | bwd_inner: 924.70 | bwd_allreduce: 2.59 | step: 25.31
[2024-11-14 15:28:20,152] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:28:20,152] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.22 | bwd_microstep: 927.33 | bwd_inner_microstep: 924.72 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.42
[2024-11-14 15:28:20,152] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.21 | bwd: 927.34 | bwd_inner: 924.72 | bwd_allreduce: 2.59 | step: 25.42
[2024-11-14 15:28:21,428] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:28:21,428] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.45 | bwd_microstep: 927.42 | bwd_inner_microstep: 924.88 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.25
[2024-11-14 15:28:21,428] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.44 | bwd: 927.43 | bwd_inner: 924.88 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:28:23,008] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.80 | optimizer_step: 9.51
[2024-11-14 15:28:23,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=1050, skipped=2, lr=[0.00025108072798541803], mom=[(0.9, 0.95)]
[2024-11-14 15:28:23,008] [INFO] [timer.py:259:stop] epoch=0/micro_step=1050/global_step=1050, RunningAvgSamplesPerSec=774.5927348585628, CurrSamplesPerSec=648.536375843336, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:28:23,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.41 | bwd_microstep: 1146.98 | bwd_inner_microstep: 1144.17 | bwd_allreduce_microstep: 2.77 | step_microstep: 26.78
[2024-11-14 15:28:23,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.40 | bwd: 1146.99 | bwd_inner: 1144.17 | bwd_allreduce: 2.79 | step: 26.79
[2024-11-14 15:28:24,285] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:28:24,285] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 927.51 | bwd_inner_microstep: 924.75 | bwd_allreduce_microstep: 2.73 | step_microstep: 25.95
[2024-11-14 15:28:24,285] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 927.52 | bwd_inner: 924.75 | bwd_allreduce: 2.74 | step: 25.95
[2024-11-14 15:28:25,561] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:28:25,561] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.17 | bwd_microstep: 927.26 | bwd_inner_microstep: 924.70 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:28:25,561] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.16 | bwd: 927.26 | bwd_inner: 924.70 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:28:26,542] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:28:26,542] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.28 | bwd_microstep: 711.70 | bwd_inner_microstep: 709.18 | bwd_allreduce_microstep: 2.49 | step_microstep: 25.30
[2024-11-14 15:28:26,542] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.28 | bwd: 711.70 | bwd_inner: 709.18 | bwd_allreduce: 2.50 | step: 25.30
[2024-11-14 15:28:27,524] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:28:27,524] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.48 | bwd_microstep: 712.14 | bwd_inner_microstep: 709.58 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:28:27,524] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.47 | bwd: 712.15 | bwd_inner: 709.58 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:28:28,799] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:28:28,800] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 927.20 | bwd_inner_microstep: 924.64 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:28:28,800] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.27 | bwd: 927.21 | bwd_inner: 924.64 | bwd_allreduce: 2.54 | step: 25.28
[2024-11-14 15:28:30,075] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:28:30,075] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 926.88 | bwd_inner_microstep: 924.31 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.33
[2024-11-14 15:28:30,075] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 926.89 | bwd_inner: 924.31 | bwd_allreduce: 2.56 | step: 25.33
[2024-11-14 15:28:31,351] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:28:31,351] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.50 | bwd_microstep: 927.87 | bwd_inner_microstep: 925.29 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.38
[2024-11-14 15:28:31,352] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.49 | bwd: 927.88 | bwd_inner: 925.29 | bwd_allreduce: 2.56 | step: 25.39
[2024-11-14 15:28:32,627] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:28:32,627] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.02 | bwd_inner_microstep: 924.48 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.29
[2024-11-14 15:28:32,627] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.17 | bwd: 927.03 | bwd_inner: 924.48 | bwd_allreduce: 2.53 | step: 25.29
[2024-11-14 15:28:35,402] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:28:35,403] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 744.19 | bwd_microstep: 2004.74 | bwd_inner_microstep: 2002.17 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.47
[2024-11-14 15:28:35,403] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 744.19 | bwd: 2004.75 | bwd_inner: 2002.17 | bwd_allreduce: 2.56 | step: 25.48
[2024-11-14 15:28:36,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:28:36,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=1060, skipped=2, lr=[0.00025138261970112345], mom=[(0.9, 0.95)]
[2024-11-14 15:28:36,678] [INFO] [timer.py:259:stop] epoch=0/micro_step=1060/global_step=1060, RunningAvgSamplesPerSec=774.3493255003832, CurrSamplesPerSec=803.4392964490202, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:28:36,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 927.12 | bwd_inner_microstep: 924.59 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.54
[2024-11-14 15:28:36,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 927.13 | bwd_inner: 924.59 | bwd_allreduce: 2.51 | step: 25.55
[2024-11-14 15:28:38,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:28:38,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.45 | bwd_microstep: 1147.33 | bwd_inner_microstep: 1144.35 | bwd_allreduce_microstep: 2.95 | step_microstep: 26.77
[2024-11-14 15:28:38,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.44 | bwd: 1147.33 | bwd_inner: 1144.35 | bwd_allreduce: 2.96 | step: 26.77
[2024-11-14 15:28:39,536] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:28:39,536] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.26 | bwd_microstep: 927.44 | bwd_inner_microstep: 924.54 | bwd_allreduce_microstep: 2.87 | step_microstep: 26.24
[2024-11-14 15:28:39,536] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.25 | bwd: 927.45 | bwd_inner: 924.54 | bwd_allreduce: 2.88 | step: 26.25
[2024-11-14 15:28:40,812] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:28:40,812] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.37 | bwd_microstep: 927.45 | bwd_inner_microstep: 924.89 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.31
[2024-11-14 15:28:40,812] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.37 | bwd: 927.45 | bwd_inner: 924.89 | bwd_allreduce: 2.54 | step: 25.31
[2024-11-14 15:28:42,393] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:28:42,393] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.75 | bwd_microstep: 1147.66 | bwd_inner_microstep: 1144.83 | bwd_allreduce_microstep: 2.81 | step_microstep: 26.47
[2024-11-14 15:28:42,393] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.74 | bwd: 1147.67 | bwd_inner: 1144.83 | bwd_allreduce: 2.82 | step: 26.47
[2024-11-14 15:28:43,670] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:28:43,670] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.14 | bwd_microstep: 927.78 | bwd_inner_microstep: 924.98 | bwd_allreduce_microstep: 2.77 | step_microstep: 26.28
[2024-11-14 15:28:43,670] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.13 | bwd: 927.79 | bwd_inner: 924.98 | bwd_allreduce: 2.78 | step: 26.28
[2024-11-14 15:28:45,251] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:28:45,251] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.59 | bwd_microstep: 1148.06 | bwd_inner_microstep: 1145.34 | bwd_allreduce_microstep: 2.70 | step_microstep: 26.15
[2024-11-14 15:28:45,251] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.58 | bwd: 1148.07 | bwd_inner: 1145.34 | bwd_allreduce: 2.71 | step: 26.15
[2024-11-14 15:28:46,831] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:28:46,831] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 406.05 | bwd_microstep: 1147.63 | bwd_inner_microstep: 1145.07 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.23
[2024-11-14 15:28:46,831] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 406.04 | bwd: 1147.64 | bwd_inner: 1145.07 | bwd_allreduce: 2.55 | step: 25.23
[2024-11-14 15:28:48,108] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:28:48,108] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.13 | bwd_microstep: 927.77 | bwd_inner_microstep: 924.97 | bwd_allreduce_microstep: 2.77 | step_microstep: 26.10
[2024-11-14 15:28:48,108] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 927.77 | bwd_inner: 924.97 | bwd_allreduce: 2.78 | step: 26.10
[2024-11-14 15:28:49,384] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:28:49,384] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.08 | bwd_microstep: 927.71 | bwd_inner_microstep: 925.10 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.53
[2024-11-14 15:28:49,384] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 927.71 | bwd_inner: 925.11 | bwd_allreduce: 2.58 | step: 25.53
[2024-11-14 15:28:50,661] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:28:50,661] [INFO] [logging.py:96:log_dist] [Rank 0] step=1070, skipped=2, lr=[0.0002516816713774146], mom=[(0.9, 0.95)]
[2024-11-14 15:28:50,661] [INFO] [timer.py:259:stop] epoch=0/micro_step=1070/global_step=1070, RunningAvgSamplesPerSec=773.9394171725528, CurrSamplesPerSec=802.8594239409097, MemAllocated=3.75GB, MaxMemAllocated=15.4GB
[2024-11-14 15:28:50,661] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.37 | bwd_microstep: 927.81 | bwd_inner_microstep: 925.28 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.52
[2024-11-14 15:28:50,661] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.35 | bwd: 927.82 | bwd_inner: 925.28 | bwd_allreduce: 2.52 | step: 25.52
[2024-11-14 15:28:51,938] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:28:51,938] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.49 | bwd_microstep: 928.01 | bwd_inner_microstep: 925.45 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.24
[2024-11-14 15:28:51,938] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.49 | bwd: 928.01 | bwd_inner: 925.45 | bwd_allreduce: 2.54 | step: 25.24
[2024-11-14 15:28:53,820] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.50
[2024-11-14 15:28:53,820] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 495.01 | bwd_microstep: 1359.94 | bwd_inner_microstep: 1357.06 | bwd_allreduce_microstep: 2.85 | step_microstep: 26.06
[2024-11-14 15:28:53,820] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 495.00 | bwd: 1359.95 | bwd_inner: 1357.06 | bwd_allreduce: 2.86 | step: 26.07
[2024-11-14 15:28:55,399] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:28:55,399] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.38 | bwd_microstep: 1147.05 | bwd_inner_microstep: 1144.44 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.32
[2024-11-14 15:28:55,399] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.37 | bwd: 1147.05 | bwd_inner: 1144.44 | bwd_allreduce: 2.59 | step: 25.32
[2024-11-14 15:28:57,278] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:28:57,278] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.67 | bwd_microstep: 1358.04 | bwd_inner_microstep: 1355.47 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.18
[2024-11-14 15:28:57,278] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.65 | bwd: 1358.04 | bwd_inner: 1355.47 | bwd_allreduce: 2.55 | step: 25.18
[2024-11-14 15:28:58,857] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:28:58,857] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.48 | bwd_microstep: 1147.62 | bwd_inner_microstep: 1145.07 | bwd_allreduce_microstep: 2.51 | step_microstep: 25.25
[2024-11-14 15:28:58,857] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.47 | bwd: 1147.62 | bwd_inner: 1145.07 | bwd_allreduce: 2.53 | step: 25.25
[2024-11-14 15:29:00,135] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:29:00,136] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.34 | bwd_microstep: 928.87 | bwd_inner_microstep: 926.04 | bwd_allreduce_microstep: 2.80 | step_microstep: 26.13
[2024-11-14 15:29:00,136] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.33 | bwd: 928.87 | bwd_inner: 926.04 | bwd_allreduce: 2.81 | step: 26.13
[2024-11-14 15:29:01,716] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:29:01,716] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.57 | bwd_microstep: 1147.40 | bwd_inner_microstep: 1144.55 | bwd_allreduce_microstep: 2.82 | step_microstep: 26.43
[2024-11-14 15:29:01,716] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.56 | bwd: 1147.41 | bwd_inner: 1144.55 | bwd_allreduce: 2.83 | step: 26.43
[2024-11-14 15:29:02,992] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:29:02,992] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.88 | bwd_microstep: 927.07 | bwd_inner_microstep: 924.33 | bwd_allreduce_microstep: 2.71 | step_microstep: 25.94
[2024-11-14 15:29:02,992] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.87 | bwd: 927.08 | bwd_inner: 924.33 | bwd_allreduce: 2.72 | step: 25.94
[2024-11-14 15:29:04,269] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:29:04,269] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.53 | bwd_microstep: 928.08 | bwd_inner_microstep: 925.52 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.35
[2024-11-14 15:29:04,275] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.52 | bwd: 928.09 | bwd_inner: 925.52 | bwd_allreduce: 2.55 | step: 25.35
[2024-11-14 15:29:05,257] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:29:05,257] [INFO] [logging.py:96:log_dist] [Rank 0] step=1080, skipped=2, lr=[0.0002519779359518808], mom=[(0.9, 0.95)]
[2024-11-14 15:29:05,257] [INFO] [timer.py:259:stop] epoch=0/micro_step=1080/global_step=1080, RunningAvgSamplesPerSec=773.2085040269791, CurrSamplesPerSec=1043.671509763312, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:29:05,257] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.37 | bwd_microstep: 712.53 | bwd_inner_microstep: 709.98 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.49
[2024-11-14 15:29:05,257] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.36 | bwd: 712.54 | bwd_inner: 709.98 | bwd_allreduce: 2.53 | step: 25.49
[2024-11-14 15:29:06,533] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:06,533] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.08 | bwd_microstep: 927.41 | bwd_inner_microstep: 924.85 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.30
[2024-11-14 15:29:06,533] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.07 | bwd: 927.42 | bwd_inner: 924.85 | bwd_allreduce: 2.55 | step: 25.30
[2024-11-14 15:29:07,810] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:29:07,810] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.50 | bwd_microstep: 928.19 | bwd_inner_microstep: 925.61 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.29
[2024-11-14 15:29:07,810] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.49 | bwd: 928.19 | bwd_inner: 925.61 | bwd_allreduce: 2.56 | step: 25.29
[2024-11-14 15:29:08,792] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:08,792] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.56 | bwd_microstep: 712.53 | bwd_inner_microstep: 709.97 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.26
[2024-11-14 15:29:08,792] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.55 | bwd: 712.53 | bwd_inner: 709.97 | bwd_allreduce: 2.54 | step: 25.27
[2024-11-14 15:29:10,068] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:10,069] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.33 | bwd_microstep: 927.30 | bwd_inner_microstep: 924.70 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.76
[2024-11-14 15:29:10,069] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.32 | bwd: 927.31 | bwd_inner: 924.70 | bwd_allreduce: 2.58 | step: 25.76
[2024-11-14 15:29:11,345] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:29:11,345] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.13 | bwd_microstep: 927.85 | bwd_inner_microstep: 925.29 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.23
[2024-11-14 15:29:11,345] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 927.85 | bwd_inner: 925.29 | bwd_allreduce: 2.54 | step: 25.23
[2024-11-14 15:29:12,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.49
[2024-11-14 15:29:12,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.43 | bwd_microstep: 1147.95 | bwd_inner_microstep: 1145.10 | bwd_allreduce_microstep: 2.82 | step_microstep: 31.69
[2024-11-14 15:29:12,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.42 | bwd: 1147.96 | bwd_inner: 1145.11 | bwd_allreduce: 2.83 | step: 31.70
[2024-11-14 15:29:14,208] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:29:14,208] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.20 | bwd_microstep: 927.49 | bwd_inner_microstep: 924.72 | bwd_allreduce_microstep: 2.74 | step_microstep: 26.50
[2024-11-14 15:29:14,208] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.50 | bwd_inner: 924.72 | bwd_allreduce: 2.75 | step: 26.50
[2024-11-14 15:29:15,189] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:29:15,189] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.16 | bwd_microstep: 712.07 | bwd_inner_microstep: 709.53 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:29:15,189] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.15 | bwd: 712.08 | bwd_inner: 709.53 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:29:16,465] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:29:16,466] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.14 | bwd_microstep: 927.75 | bwd_inner_microstep: 925.12 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.33
[2024-11-14 15:29:16,466] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.13 | bwd: 927.75 | bwd_inner: 925.12 | bwd_allreduce: 2.61 | step: 25.33
[2024-11-14 15:29:17,741] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:29:17,741] [INFO] [logging.py:96:log_dist] [Rank 0] step=1090, skipped=2, lr=[0.00025227146489565397], mom=[(0.9, 0.95)]
[2024-11-14 15:29:17,742] [INFO] [timer.py:259:stop] epoch=0/micro_step=1090/global_step=1090, RunningAvgSamplesPerSec=773.6215111157146, CurrSamplesPerSec=803.2667941408858, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:29:17,742] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.80 | bwd_microstep: 927.60 | bwd_inner_microstep: 924.98 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.63
[2024-11-14 15:29:17,742] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.79 | bwd: 927.61 | bwd_inner: 924.98 | bwd_allreduce: 2.61 | step: 25.63
[2024-11-14 15:29:18,724] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:29:18,724] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.65 | bwd_microstep: 712.76 | bwd_inner_microstep: 710.13 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.40
[2024-11-14 15:29:18,725] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.64 | bwd: 712.77 | bwd_inner: 710.13 | bwd_allreduce: 2.61 | step: 25.40
[2024-11-14 15:29:20,000] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:29:20,000] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.05 | bwd_microstep: 927.53 | bwd_inner_microstep: 924.97 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.33
[2024-11-14 15:29:20,001] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.04 | bwd: 927.54 | bwd_inner: 924.97 | bwd_allreduce: 2.54 | step: 25.33
[2024-11-14 15:29:21,277] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:21,277] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.39 | bwd_microstep: 927.83 | bwd_inner_microstep: 925.25 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.30
[2024-11-14 15:29:21,277] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.38 | bwd: 927.84 | bwd_inner: 925.25 | bwd_allreduce: 2.55 | step: 25.31
[2024-11-14 15:29:22,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:29:22,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.58 | bwd_microstep: 712.49 | bwd_inner_microstep: 709.90 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.33
[2024-11-14 15:29:22,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.58 | bwd: 712.50 | bwd_inner: 709.90 | bwd_allreduce: 2.57 | step: 25.33
[2024-11-14 15:29:23,535] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:23,535] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.23 | bwd_microstep: 927.67 | bwd_inner_microstep: 925.10 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.25
[2024-11-14 15:29:23,535] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.22 | bwd: 927.67 | bwd_inner: 925.10 | bwd_allreduce: 2.55 | step: 25.25
[2024-11-14 15:29:24,812] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.48
[2024-11-14 15:29:24,812] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.45 | bwd_microstep: 927.81 | bwd_inner_microstep: 925.23 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.29
[2024-11-14 15:29:24,812] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.44 | bwd: 927.81 | bwd_inner: 925.23 | bwd_allreduce: 2.56 | step: 25.29
[2024-11-14 15:29:26,088] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:29:26,089] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.27 | bwd_microstep: 927.77 | bwd_inner_microstep: 925.20 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.72
[2024-11-14 15:29:26,089] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.27 | bwd: 927.78 | bwd_inner: 925.20 | bwd_allreduce: 2.55 | step: 25.72
[2024-11-14 15:29:27,365] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:27,365] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.24 | bwd_microstep: 927.80 | bwd_inner_microstep: 925.23 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.29
[2024-11-14 15:29:27,365] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.22 | bwd: 927.81 | bwd_inner: 925.23 | bwd_allreduce: 2.55 | step: 25.29
[2024-11-14 15:29:28,641] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.50
[2024-11-14 15:29:28,641] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 927.86 | bwd_inner_microstep: 925.17 | bwd_allreduce_microstep: 2.66 | step_microstep: 25.44
[2024-11-14 15:29:28,641] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.09 | bwd: 927.87 | bwd_inner: 925.17 | bwd_allreduce: 2.67 | step: 25.44
[2024-11-14 15:29:29,918] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:29:29,918] [INFO] [logging.py:96:log_dist] [Rank 0] step=1100, skipped=2, lr=[0.00025256230826707757], mom=[(0.9, 0.95)]
[2024-11-14 15:29:29,919] [INFO] [timer.py:259:stop] epoch=0/micro_step=1100/global_step=1100, RunningAvgSamplesPerSec=774.191195000617, CurrSamplesPerSec=802.2898292990412, MemAllocated=3.75GB, MaxMemAllocated=15.4GB
[2024-11-14 15:29:29,919] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.55 | bwd_microstep: 928.39 | bwd_inner_microstep: 925.80 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.67
[2024-11-14 15:29:29,919] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.54 | bwd: 928.39 | bwd_inner: 925.80 | bwd_allreduce: 2.57 | step: 25.67
[2024-11-14 15:29:31,500] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:29:31,500] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.68 | bwd_microstep: 1148.14 | bwd_inner_microstep: 1145.25 | bwd_allreduce_microstep: 2.87 | step_microstep: 26.19
[2024-11-14 15:29:31,500] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.67 | bwd: 1148.15 | bwd_inner: 1145.25 | bwd_allreduce: 2.88 | step: 26.19
[2024-11-14 15:29:31.500560][epoch 1][local 0: 1100][global 1100] train_loss: 0.1689463, 742.3 samples / 14846 tokens per sec
[2024-11-14 15:29:32,482] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:29:32,482] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.49 | bwd_microstep: 712.34 | bwd_inner_microstep: 709.77 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.27
[2024-11-14 15:29:32,482] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.48 | bwd: 712.35 | bwd_inner: 709.77 | bwd_allreduce: 2.56 | step: 25.27
[2024-11-14 15:29:33,758] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:29:33,758] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.30 | bwd_microstep: 927.34 | bwd_inner_microstep: 924.74 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.34
[2024-11-14 15:29:33,758] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.30 | bwd: 927.35 | bwd_inner: 924.74 | bwd_allreduce: 2.58 | step: 25.34
[2024-11-14 15:29:34,740] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:34,740] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.52 | bwd_microstep: 712.34 | bwd_inner_microstep: 709.77 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.23
[2024-11-14 15:29:34,740] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.50 | bwd: 712.35 | bwd_inner: 709.77 | bwd_allreduce: 2.55 | step: 25.23
[2024-11-14 15:29:36,015] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:36,015] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.93 | bwd_microstep: 926.84 | bwd_inner_microstep: 924.26 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.27
[2024-11-14 15:29:36,015] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.92 | bwd: 926.85 | bwd_inner: 924.26 | bwd_allreduce: 2.56 | step: 25.27
[2024-11-14 15:29:37,596] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:29:37,596] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.86 | bwd_microstep: 1147.66 | bwd_inner_microstep: 1144.84 | bwd_allreduce_microstep: 2.80 | step_microstep: 26.22
[2024-11-14 15:29:37,596] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.86 | bwd: 1147.67 | bwd_inner: 1144.84 | bwd_allreduce: 2.81 | step: 26.23
[2024-11-14 15:29:39,475] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:39,476] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 494.79 | bwd_microstep: 1358.52 | bwd_inner_microstep: 1355.96 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.24
[2024-11-14 15:29:39,476] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 494.78 | bwd: 1358.53 | bwd_inner: 1355.96 | bwd_allreduce: 2.55 | step: 25.24
[2024-11-14 15:29:41,055] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:41,055] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.53 | bwd_microstep: 1147.62 | bwd_inner_microstep: 1145.05 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.24
[2024-11-14 15:29:41,055] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.52 | bwd: 1147.63 | bwd_inner: 1145.05 | bwd_allreduce: 2.55 | step: 25.24
[2024-11-14 15:29:42,332] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:29:42,332] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.18 | bwd_microstep: 927.39 | bwd_inner_microstep: 924.66 | bwd_allreduce_microstep: 2.70 | step_microstep: 26.27
[2024-11-14 15:29:42,332] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.18 | bwd: 927.40 | bwd_inner: 924.66 | bwd_allreduce: 2.71 | step: 26.27
[2024-11-14 15:29:43,607] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:29:43,607] [INFO] [logging.py:96:log_dist] [Rank 0] step=1110, skipped=2, lr=[0.000252850514762943], mom=[(0.9, 0.95)]
[2024-11-14 15:29:43,607] [INFO] [timer.py:259:stop] epoch=0/micro_step=1110/global_step=1110, RunningAvgSamplesPerSec=773.952954358341, CurrSamplesPerSec=803.6129253857548, MemAllocated=3.73GB, MaxMemAllocated=15.4GB
[2024-11-14 15:29:43,607] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.91 | bwd_microstep: 927.09 | bwd_inner_microstep: 924.53 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.49
[2024-11-14 15:29:43,607] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.90 | bwd: 927.10 | bwd_inner: 924.53 | bwd_allreduce: 2.55 | step: 25.50
[2024-11-14 15:29:44,883] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:29:44,883] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.14 | bwd_microstep: 927.13 | bwd_inner_microstep: 924.58 | bwd_allreduce_microstep: 2.52 | step_microstep: 25.28
[2024-11-14 15:29:44,883] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 927.13 | bwd_inner: 924.58 | bwd_allreduce: 2.53 | step: 25.28
[2024-11-14 15:29:47,063] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:29:47,063] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 578.30 | bwd_microstep: 1575.67 | bwd_inner_microstep: 1573.07 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.30
[2024-11-14 15:29:47,063] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 578.29 | bwd: 1575.68 | bwd_inner: 1573.07 | bwd_allreduce: 2.58 | step: 25.30
[2024-11-14 15:29:49,243] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:49,243] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 578.26 | bwd_microstep: 1575.32 | bwd_inner_microstep: 1572.75 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.29
[2024-11-14 15:29:49,243] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 578.25 | bwd: 1575.33 | bwd_inner: 1572.75 | bwd_allreduce: 2.56 | step: 25.29
[2024-11-14 15:29:50,519] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:29:50,519] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.90 | bwd_microstep: 927.27 | bwd_inner_microstep: 924.71 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.25
[2024-11-14 15:29:50,519] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.89 | bwd: 927.27 | bwd_inner: 924.71 | bwd_allreduce: 2.54 | step: 25.25
[2024-11-14 15:29:51,795] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:51,795] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.38 | bwd_microstep: 927.38 | bwd_inner_microstep: 924.81 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.29
[2024-11-14 15:29:51,795] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.37 | bwd: 927.39 | bwd_inner: 924.81 | bwd_allreduce: 2.56 | step: 25.29
[2024-11-14 15:29:53,375] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:29:53,375] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.59 | bwd_microstep: 1147.16 | bwd_inner_microstep: 1144.48 | bwd_allreduce_microstep: 2.64 | step_microstep: 26.50
[2024-11-14 15:29:53,375] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.58 | bwd: 1147.16 | bwd_inner: 1144.48 | bwd_allreduce: 2.66 | step: 26.50
[2024-11-14 15:29:54,357] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:29:54,357] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.33 | bwd_microstep: 712.21 | bwd_inner_microstep: 709.65 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.28
[2024-11-14 15:29:54,357] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.33 | bwd: 712.22 | bwd_inner: 709.65 | bwd_allreduce: 2.55 | step: 25.28
[2024-11-14 15:29:55,632] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:29:55,633] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.10 | bwd_microstep: 926.96 | bwd_inner_microstep: 924.30 | bwd_allreduce_microstep: 2.63 | step_microstep: 25.45
[2024-11-14 15:29:55,633] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.09 | bwd: 926.97 | bwd_inner: 924.30 | bwd_allreduce: 2.64 | step: 25.46
[2024-11-14 15:29:56,909] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:29:56,909] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.55 | bwd_microstep: 927.59 | bwd_inner_microstep: 925.01 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.31
[2024-11-14 15:29:56,909] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.54 | bwd: 927.60 | bwd_inner: 925.02 | bwd_allreduce: 2.56 | step: 25.31
[2024-11-14 15:29:58,185] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:29:58,185] [INFO] [logging.py:96:log_dist] [Rank 0] step=1120, skipped=2, lr=[0.00025313613176742385], mom=[(0.9, 0.95)]
[2024-11-14 15:29:58,185] [INFO] [timer.py:259:stop] epoch=0/micro_step=1120/global_step=1120, RunningAvgSamplesPerSec=773.2543524832179, CurrSamplesPerSec=803.0320515948134, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:29:58,185] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.51 | bwd_microstep: 927.32 | bwd_inner_microstep: 924.72 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.57
[2024-11-14 15:29:58,185] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.50 | bwd: 927.33 | bwd_inner: 924.72 | bwd_allreduce: 2.58 | step: 25.57
[2024-11-14 15:29:59,460] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:29:59,461] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 927.02 | bwd_inner_microstep: 924.42 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.34
[2024-11-14 15:29:59,461] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 927.03 | bwd_inner: 924.42 | bwd_allreduce: 2.59 | step: 25.34
[2024-11-14 15:30:00,738] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:30:00,738] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.42 | bwd_microstep: 928.54 | bwd_inner_microstep: 925.96 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.41
[2024-11-14 15:30:00,738] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.41 | bwd: 928.55 | bwd_inner: 925.96 | bwd_allreduce: 2.57 | step: 25.41
[2024-11-14 15:30:02,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:30:02,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.09 | bwd_microstep: 926.98 | bwd_inner_microstep: 924.42 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.33
[2024-11-14 15:30:02,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.08 | bwd: 926.99 | bwd_inner: 924.42 | bwd_allreduce: 2.54 | step: 25.33
[2024-11-14 15:30:03,289] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:30:03,290] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.30 | bwd_microstep: 927.35 | bwd_inner_microstep: 924.78 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.74
[2024-11-14 15:30:03,290] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.29 | bwd: 927.36 | bwd_inner: 924.78 | bwd_allreduce: 2.56 | step: 25.74
[2024-11-14 15:30:04,271] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:30:04,271] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.20 | bwd_microstep: 711.82 | bwd_inner_microstep: 709.23 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.41
[2024-11-14 15:30:04,271] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.18 | bwd: 711.83 | bwd_inner: 709.23 | bwd_allreduce: 2.57 | step: 25.41
[2024-11-14 15:30:05,253] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:30:05,253] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.52 | bwd_microstep: 711.93 | bwd_inner_microstep: 709.38 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.31
[2024-11-14 15:30:05,253] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.52 | bwd: 711.93 | bwd_inner: 709.38 | bwd_allreduce: 2.54 | step: 25.31
[2024-11-14 15:30:06,528] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:30:06,528] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.14 | bwd_microstep: 927.01 | bwd_inner_microstep: 924.44 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.25
[2024-11-14 15:30:06,528] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.13 | bwd: 927.02 | bwd_inner: 924.44 | bwd_allreduce: 2.56 | step: 25.26
[2024-11-14 15:30:07,511] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:30:07,511] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.71 | bwd_microstep: 712.60 | bwd_inner_microstep: 710.01 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.45
[2024-11-14 15:30:07,511] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.70 | bwd: 712.61 | bwd_inner: 710.01 | bwd_allreduce: 2.58 | step: 25.46
[2024-11-14 15:30:10,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:30:10,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 662.92 | bwd_microstep: 1808.33 | bwd_inner_microstep: 1805.73 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.28
[2024-11-14 15:30:10,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 662.91 | bwd: 1808.34 | bwd_inner: 1805.73 | bwd_allreduce: 2.58 | step: 25.28
[2024-11-14 15:30:10,990] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:30:10,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=1130, skipped=2, lr=[0.0002534192053988314], mom=[(0.9, 0.95)]
[2024-11-14 15:30:10,991] [INFO] [timer.py:259:stop] epoch=0/micro_step=1130/global_step=1130, RunningAvgSamplesPerSec=773.4862405227815, CurrSamplesPerSec=1044.2990664669267, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:30:10,991] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.29 | bwd_microstep: 711.97 | bwd_inner_microstep: 709.43 | bwd_allreduce_microstep: 2.50 | step_microstep: 25.54
[2024-11-14 15:30:10,991] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.28 | bwd: 711.97 | bwd_inner: 709.44 | bwd_allreduce: 2.51 | step: 25.54
[2024-11-14 15:30:12,266] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:30:12,267] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 927.28 | bwd_inner_microstep: 924.66 | bwd_allreduce_microstep: 2.60 | step_microstep: 25.47
[2024-11-14 15:30:12,267] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.15 | bwd: 927.29 | bwd_inner: 924.66 | bwd_allreduce: 2.61 | step: 25.47
[2024-11-14 15:30:13,543] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:30:13,543] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.13 | bwd_microstep: 927.69 | bwd_inner_microstep: 925.12 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.30
[2024-11-14 15:30:13,545] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.12 | bwd: 927.69 | bwd_inner: 925.12 | bwd_allreduce: 2.55 | step: 25.30
[2024-11-14 15:30:14,820] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:30:14,820] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.97 | bwd_microstep: 927.44 | bwd_inner_microstep: 924.89 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.22
[2024-11-14 15:30:14,820] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.96 | bwd: 927.45 | bwd_inner: 924.89 | bwd_allreduce: 2.54 | step: 25.23
[2024-11-14 15:30:16,097] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:30:16,097] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 927.90 | bwd_inner_microstep: 925.34 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.33
[2024-11-14 15:30:16,097] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.27 | bwd: 927.90 | bwd_inner: 925.34 | bwd_allreduce: 2.54 | step: 25.33
[2024-11-14 15:30:17,686] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.51
[2024-11-14 15:30:17,686] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.69 | bwd_microstep: 1148.07 | bwd_inner_microstep: 1145.19 | bwd_allreduce_microstep: 2.85 | step_microstep: 34.46
[2024-11-14 15:30:17,686] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.68 | bwd: 1148.07 | bwd_inner: 1145.19 | bwd_allreduce: 2.86 | step: 34.46
[2024-11-14 15:30:18,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:30:18,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.99 | bwd_microstep: 927.94 | bwd_inner_microstep: 925.02 | bwd_allreduce_microstep: 2.89 | step_microstep: 26.15
[2024-11-14 15:30:18,963] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.98 | bwd: 927.95 | bwd_inner: 925.02 | bwd_allreduce: 2.90 | step: 26.16
[2024-11-14 15:30:20,240] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.52
[2024-11-14 15:30:20,240] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.47 | bwd_microstep: 927.85 | bwd_inner_microstep: 925.27 | bwd_allreduce_microstep: 2.55 | step_microstep: 25.28
[2024-11-14 15:30:20,240] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.46 | bwd: 927.85 | bwd_inner: 925.27 | bwd_allreduce: 2.56 | step: 25.29
[2024-11-14 15:30:21,515] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:30:21,515] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.28 | bwd_microstep: 927.22 | bwd_inner_microstep: 924.65 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.25
[2024-11-14 15:30:21,516] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.27 | bwd: 927.23 | bwd_inner: 924.65 | bwd_allreduce: 2.55 | step: 25.25
[2024-11-14 15:30:22,792] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:30:22,792] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.38 | bwd_microstep: 927.49 | bwd_inner_microstep: 924.84 | bwd_allreduce_microstep: 2.62 | step_microstep: 25.50
[2024-11-14 15:30:22,792] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.37 | bwd: 927.49 | bwd_inner: 924.84 | bwd_allreduce: 2.63 | step: 25.50
[2024-11-14 15:30:24,068] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:30:24,068] [INFO] [logging.py:96:log_dist] [Rank 0] step=1140, skipped=2, lr=[0.000253699780554307], mom=[(0.9, 0.95)]
[2024-11-14 15:30:24,069] [INFO] [timer.py:259:stop] epoch=0/micro_step=1140/global_step=1140, RunningAvgSamplesPerSec=773.5751561373056, CurrSamplesPerSec=802.7723877115848, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:30:24,069] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.41 | bwd_microstep: 927.58 | bwd_inner_microstep: 924.97 | bwd_allreduce_microstep: 2.59 | step_microstep: 25.85
[2024-11-14 15:30:24,069] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.40 | bwd: 927.59 | bwd_inner: 924.97 | bwd_allreduce: 2.60 | step: 25.85
[2024-11-14 15:30:25,648] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:30:25,648] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.55 | bwd_microstep: 1147.29 | bwd_inner_microstep: 1144.69 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.39
[2024-11-14 15:30:25,648] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.55 | bwd: 1147.30 | bwd_inner: 1144.69 | bwd_allreduce: 2.58 | step: 25.40
[2024-11-14 15:30:27,227] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:30:27,227] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.68 | bwd_microstep: 1146.74 | bwd_inner_microstep: 1144.15 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.31
[2024-11-14 15:30:27,227] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.68 | bwd: 1146.74 | bwd_inner: 1144.15 | bwd_allreduce: 2.57 | step: 25.31
[2024-11-14 15:30:28,503] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:30:28,503] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.24 | bwd_microstep: 927.48 | bwd_inner_microstep: 924.47 | bwd_allreduce_microstep: 2.98 | step_microstep: 25.88
[2024-11-14 15:30:28,504] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.24 | bwd: 927.49 | bwd_inner: 924.47 | bwd_allreduce: 3.00 | step: 25.88
[2024-11-14 15:30:29,778] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:30:29,778] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.95 | bwd_microstep: 926.79 | bwd_inner_microstep: 924.24 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.28
[2024-11-14 15:30:29,778] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.94 | bwd: 926.80 | bwd_inner: 924.24 | bwd_allreduce: 2.54 | step: 25.29
[2024-11-14 15:30:30,760] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:30:30,760] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.39 | bwd_microstep: 712.01 | bwd_inner_microstep: 709.45 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.26
[2024-11-14 15:30:30,760] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.38 | bwd: 712.02 | bwd_inner: 709.45 | bwd_allreduce: 2.55 | step: 25.26
[2024-11-14 15:30:32,036] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:30:32,036] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.25 | bwd_microstep: 927.29 | bwd_inner_microstep: 924.69 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.43
[2024-11-14 15:30:32,036] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.24 | bwd: 927.29 | bwd_inner: 924.69 | bwd_allreduce: 2.58 | step: 25.43
[2024-11-14 15:30:33,615] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.52
[2024-11-14 15:30:33,615] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.11 | bwd_microstep: 1146.57 | bwd_inner_microstep: 1143.72 | bwd_allreduce_microstep: 2.83 | step_microstep: 26.39
[2024-11-14 15:30:33,615] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.10 | bwd: 1146.58 | bwd_inner: 1143.72 | bwd_allreduce: 2.84 | step: 26.39
[2024-11-14 15:30:35,194] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:30:35,194] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.86 | bwd_microstep: 1147.14 | bwd_inner_microstep: 1144.57 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.28
[2024-11-14 15:30:35,194] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.85 | bwd: 1147.15 | bwd_inner: 1144.57 | bwd_allreduce: 2.55 | step: 25.28
[2024-11-14 15:30:36,470] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:30:36,470] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.94 | bwd_microstep: 927.03 | bwd_inner_microstep: 924.21 | bwd_allreduce_microstep: 2.79 | step_microstep: 26.05
[2024-11-14 15:30:36,470] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.94 | bwd: 927.04 | bwd_inner: 924.21 | bwd_allreduce: 2.80 | step: 26.05
[2024-11-14 15:30:37,745] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.51
[2024-11-14 15:30:37,746] [INFO] [logging.py:96:log_dist] [Rank 0] step=1150, skipped=2, lr=[0.0002539779009525587], mom=[(0.9, 0.95)]
[2024-11-14 15:30:37,746] [INFO] [timer.py:259:stop] epoch=0/micro_step=1150/global_step=1150, RunningAvgSamplesPerSec=773.356500017647, CurrSamplesPerSec=803.4800286225566, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:30:37,746] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.10 | bwd_microstep: 926.98 | bwd_inner_microstep: 924.39 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.60
[2024-11-14 15:30:37,746] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 926.99 | bwd_inner: 924.39 | bwd_allreduce: 2.58 | step: 25.61
[2024-11-14 15:30:39,021] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:30:39,022] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.16 | bwd_microstep: 926.92 | bwd_inner_microstep: 924.31 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.45
[2024-11-14 15:30:39,022] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.14 | bwd: 926.93 | bwd_inner: 924.31 | bwd_allreduce: 2.59 | step: 25.45
[2024-11-14 15:30:40,298] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:30:40,298] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.21 | bwd_microstep: 927.59 | bwd_inner_microstep: 925.04 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.38
[2024-11-14 15:30:40,298] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.20 | bwd: 927.60 | bwd_inner: 925.04 | bwd_allreduce: 2.54 | step: 25.38
[2024-11-14 15:30:41,573] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:30:41,573] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.07 | bwd_microstep: 926.94 | bwd_inner_microstep: 924.35 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.38
[2024-11-14 15:30:41,573] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.06 | bwd: 926.95 | bwd_inner: 924.35 | bwd_allreduce: 2.58 | step: 25.38
[2024-11-14 15:30:42,849] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:30:42,849] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.30 | bwd_microstep: 927.19 | bwd_inner_microstep: 924.64 | bwd_allreduce_microstep: 2.53 | step_microstep: 25.34
[2024-11-14 15:30:42,849] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.29 | bwd: 927.20 | bwd_inner: 924.64 | bwd_allreduce: 2.54 | step: 25.35
[2024-11-14 15:30:44,125] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.50
[2024-11-14 15:30:44,125] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.23 | bwd_microstep: 927.18 | bwd_inner_microstep: 924.57 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.55
[2024-11-14 15:30:44,125] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.22 | bwd: 927.19 | bwd_inner: 924.57 | bwd_allreduce: 2.60 | step: 25.55
[2024-11-14 15:30:45,401] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.51
[2024-11-14 15:30:45,401] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.35 | bwd_microstep: 927.37 | bwd_inner_microstep: 924.78 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.50
[2024-11-14 15:30:45,401] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.34 | bwd: 927.38 | bwd_inner: 924.78 | bwd_allreduce: 2.57 | step: 25.50
[2024-11-14 15:30:46,382] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:30:46,383] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.33 | bwd_microstep: 711.89 | bwd_inner_microstep: 709.31 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.34
[2024-11-14 15:30:46,383] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.32 | bwd: 711.90 | bwd_inner: 709.31 | bwd_allreduce: 2.57 | step: 25.35
[2024-11-14 15:30:47,658] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.50
[2024-11-14 15:30:47,658] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.04 | bwd_microstep: 927.14 | bwd_inner_microstep: 924.57 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.29
[2024-11-14 15:30:47,658] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.03 | bwd: 927.14 | bwd_inner: 924.57 | bwd_allreduce: 2.55 | step: 25.29
[2024-11-14 15:30:48,933] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.79 | optimizer_step: 9.51
[2024-11-14 15:30:48,933] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.91 | bwd_microstep: 926.83 | bwd_inner_microstep: 924.22 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.57
[2024-11-14 15:30:48,935] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.90 | bwd: 926.84 | bwd_inner: 924.22 | bwd_allreduce: 2.59 | step: 25.57
[2024-11-14 15:30:50,211] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:30:50,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=1160, skipped=2, lr=[0.0002542536091747451], mom=[(0.9, 0.95)]
[2024-11-14 15:30:50,211] [INFO] [timer.py:259:stop] epoch=0/micro_step=1160/global_step=1160, RunningAvgSamplesPerSec=773.7539377636052, CurrSamplesPerSec=803.0503694927714, MemAllocated=3.74GB, MaxMemAllocated=15.4GB
[2024-11-14 15:30:50,211] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.43 | bwd_microstep: 927.26 | bwd_inner_microstep: 924.68 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.69
[2024-11-14 15:30:50,211] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.42 | bwd: 927.27 | bwd_inner: 924.67 | bwd_allreduce: 2.57 | step: 25.69
[2024-11-14 15:30:51,791] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.50
[2024-11-14 15:30:51,792] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 405.74 | bwd_microstep: 1147.49 | bwd_inner_microstep: 1144.64 | bwd_allreduce_microstep: 2.83 | step_microstep: 25.88
[2024-11-14 15:30:51,792] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 405.73 | bwd: 1147.50 | bwd_inner: 1144.64 | bwd_allreduce: 2.84 | step: 25.88
[2024-11-14 15:30:53,068] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:30:53,068] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.12 | bwd_microstep: 927.45 | bwd_inner_microstep: 924.63 | bwd_allreduce_microstep: 2.79 | step_microstep: 25.91
[2024-11-14 15:30:53,068] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.11 | bwd: 927.46 | bwd_inner: 924.63 | bwd_allreduce: 2.80 | step: 25.92
[2024-11-14 15:30:54,050] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:30:54,050] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 243.50 | bwd_microstep: 712.27 | bwd_inner_microstep: 709.67 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.41
[2024-11-14 15:30:54,050] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 243.49 | bwd: 712.28 | bwd_inner: 709.67 | bwd_allreduce: 2.59 | step: 25.41
[2024-11-14 15:30:55,325] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:30:55,325] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 321.84 | bwd_microstep: 926.94 | bwd_inner_microstep: 924.34 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.42
[2024-11-14 15:30:55,325] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 321.83 | bwd: 926.95 | bwd_inner: 924.34 | bwd_allreduce: 2.58 | step: 25.42
[2024-11-14 15:30:56,601] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:30:56,601] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.03 | bwd_microstep: 927.21 | bwd_inner_microstep: 924.62 | bwd_allreduce_microstep: 2.56 | step_microstep: 25.48
[2024-11-14 15:30:56,601] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.02 | bwd: 927.22 | bwd_inner: 924.62 | bwd_allreduce: 2.57 | step: 25.48
[2024-11-14 15:30:57,877] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.49
[2024-11-14 15:30:57,877] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.29 | bwd_microstep: 927.19 | bwd_inner_microstep: 924.63 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.34
[2024-11-14 15:30:57,877] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.28 | bwd: 927.20 | bwd_inner: 924.63 | bwd_allreduce: 2.55 | step: 25.35
[2024-11-14 15:30:59,153] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.77 | optimizer_step: 9.51
[2024-11-14 15:30:59,153] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.50 | bwd_microstep: 927.55 | bwd_inner_microstep: 924.94 | bwd_allreduce_microstep: 2.58 | step_microstep: 25.49
[2024-11-14 15:30:59,153] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.49 | bwd: 927.55 | bwd_inner: 924.94 | bwd_allreduce: 2.59 | step: 25.49
[2024-11-14 15:31:00,430] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.78 | optimizer_step: 9.49
[2024-11-14 15:31:00,430] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.35 | bwd_microstep: 927.95 | bwd_inner_microstep: 925.35 | bwd_allreduce_microstep: 2.57 | step_microstep: 25.57
[2024-11-14 15:31:00,430] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.34 | bwd: 927.96 | bwd_inner: 925.35 | bwd_allreduce: 2.59 | step: 25.57
[2024-11-14 15:31:01,705] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 0.00 | optimizer_gradients: 4.76 | optimizer_step: 9.49
[2024-11-14 15:31:01,705] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 322.11 | bwd_microstep: 926.91 | bwd_inner_microstep: 924.34 | bwd_allreduce_microstep: 2.54 | step_microstep: 25.27
[2024-11-14 15:31:01,705] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 322.10 | bwd: 926.91 | bwd_inner: 924.34 | bwd_allreduce: 2.55 | step: 25.27
[2024-11-14 15:31:02,868] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 12226
[2024-11-14 15:31:02,868] [ERROR] [launch.py:325:sigkill_handler] ['/home/yang/miniconda3/envs/gpt/bin/python', '-u', './examples/train_pretrain.py', '--local_rank=0', "--data_dir='./data/OGB'", "--output_dir='./exp/models/pcqm4m-v2/202409/pt_ns_h768_l24_b8192_mpe1024_tk4e9_gelu_3.3m_nmlm_mrlinear_mtp0.8_0_0.2_lr3e-4_adp0.1_pdp0_edp0_mdp0_lsi0_short_gated_wd0.1'", "--pretrain_cpt=''", "--dataset_name='PCQM4Mv2'", "--task_type='pretrain-mlm'", "--tokenizer_class='StackedGSTTokenizer'", "--tokenization_config='./examples/graph_lvl/pcqm4m-v2_tokenization_config.json'", "--stack_method='short'", '--batch_size=1024', '--pack_tokens=0', '--num_workers=12', '--max_position_embeddings=1024', '--tie_word_embeddings=0', '--lr=3e-4', '--weight_decay=0.1', '--eps=1e-8', '--max_grad_norm=5', '--total_tokens=4e9', '--warmup_tokens=1e8', "--model_config=''", '--num_hidden_layers=24', '--hidden_size=768', '--intermediate_size=0', '--num_attention_heads=0', "--hidden_act='gelu'", '--stacked_feat_agg_method=gated', '--samples_per_saving=1000000', "--deepspeed_config='./examples/ds_config2_pt.json'", '--attention_dropout=0.1', '--embed_dropout=0', '--path_dropout=0', '--mlp_dropout=0', '--layer_scale_init_value=0', '--use_ema=0'] exits with return code = -9
[DataLoader Worker 8] seed `random` & `np.random` with 1006251332097768101 & 1416854181!
[DataLoader Worker 0] seed `random` & `np.random` with 1006251332097768093 & 1416854173!
